<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>SQL QuickStart Guide</title></head><body><div lang="en-US" class="calibre1" id="calibre_link-4">

  <section type="titlepage" id="calibre_link-183" class="calibre2">

    <figure class="h" type="z3998:figure">

      <img alt="SQL - QuickStart Guide" class="portrait" src="images/000109.jpg" />

    </figure>

  </section>

</div>



<div lang="en-US" class="calibre1" id="calibre_link-0">

  <section type="dedication" id="calibre_link-184" class="calibre2">

    <div class="dedication-wrap">

      <p class="dedication"><i class="calibre3">I would like to give a special thanks to my family Julien, Max, Elke, and&nbsp;Norma.</i></p>

      <p class="dedication"><i class="calibre3">I couldn’t have written this book without their patience and&nbsp;support.</i></p>

    </div>

  </section>

</div>



<div lang="en-US" class="calibre1" id="calibre_link-38">

  <nav class="align-left" type="index" id="calibre_link-185">
  
  <div class="chapter-heading-wrap">
	
	<h2 class="toc">Contents</h2>
	</div>
    <p class="toc_entry"><a class="underline" href="#calibre_link-39">Introduction</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-40">My Story</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-41">Why I Wrote This Book</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-42">A Word of Encouragement for the Pure Beginner</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-43">The Scope and Focus of This Book</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-44">SQL and Your Career</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-45">Chapter by Chapter </a></p>

    <p class="toc_part"><a class="underline" href="#calibre_link-36">PART I &ndash; Creating Your SQL Learning Environment</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-46">| 1 | UNDERSTANDING DATABASE STRUCTURE</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-47">Fundamental Terminology</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-48">Fundamental Elements of Relational Databases</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-49">Types of Data</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-50">Relational Database Management Systems</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-51">The <span class="code">SELECT</span> Statement</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-52">Queries, Statements, Clauses, and Keywords</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-53">Introducing SQLite</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-54">| 2 | SQL TOOLS AND STRATEGIES</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-55">Introducing the sTunes Database</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-56">Introducing DB Browser for SQLite</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-57">Installing DB Browser for SQLite</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-58">How to Test Your SQL Knowledge</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-59">Strategies for Success</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-60">| 3 | EXPLORING A DATABASE IN SQLITE</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-61">Environment Orientation</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-62">Opening the sTunes Database</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-63">Investigating the Structure of the Database</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-64">Viewing the Individual Records</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-65">The Execute SQL Tab</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-66">Data Analysis Checkpoint</a></p>

    <p class="toc_part"><a class="underline" href="#calibre_link-11">PART II  &ndash; Writing SQL Statements</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-67">| 4 | GETTING STARTED WITH QUERIES</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-68">Adding Comments to Queries</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-69">The Structure of a Basic Query</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-70">Start Writing Your Query</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-71">Coding Syntax Versus Coding Convention</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-72">Adding an Alias to Your Columns </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-73">Using the <span class="code">ORDER</span> <span class="code">BY</span> Clause </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-74">Selecting the Top Ten Records Using <span class="code">LIMIT</span></a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-75">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-76">| 5 | TURNING DATA INTO INFORMATION</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-77">Comparison, Logical, and Arithmetic Operators</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-78">Filtering Records by Numbers with the <span class="code">WHERE</span> Clause</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-79">Filtering Records by Text</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-80">Using the <span class="code">LIKE</span> Operator to Search for Wildcards</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-81">Filtering Records by Date</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-82">The <span class="code">DATE()</span>Function</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-83">Using the <span class="code">AND</span> and <span class="code">OR</span> Operators with Two Separate Fields</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-84">The <span class="code">OR</span> Operator</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-85">Using Parentheses with <span class="code">AND</span> and <span class="code">OR</span> to Specify the Order of Operations</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-86">The <span class="code">CASE</span> Statement</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-87">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-88">| 6 | WORKING WITH MULTIPLE TABLES</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-89">What Are Joins?</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-90">How Joins Interact with Relational Database Structure</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-91">Using Joins with an Alias</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-92">Join Types and Their Differences</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-93">Inner Joins with More Than Two Tables</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-94">Using Left Outer Joins with <span class="code">NULL</span>, <span class="code">IS</span>, and <span class="code">NOT</span></a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-95">Turning a Right Join into a Left Join</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-96">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-97">| 7 | USING FUNCTIONS</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-98">Adding Calculations to Your Queries</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-99">Types of Functions in SQL</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-100">Manipulating Text Data with String Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-101">Concatenating Strings of Text</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-102">Truncating Text</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-103">Additional String Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-104">Date Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-105">Aggregate Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-106">Nesting Functions with the <span class="code">ROUND(</span><span class="code">)</span> Function</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-107">Using Aggregate Functions with the <span class="code">GROUP BY</span> Clause</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-108">Using the <span class="code">WHERE</span> and <span class="code">HAVING</span> Clauses with Grouped Queries</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-109">The <span class="code">WHERE</span> Clause Versus the <span class="code">HAVING</span> Clause</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-110">Using <span class="code">GROUP BY</span> with Multiple Fields</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-111">A Final Word on Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-112">Data Analysis Checkpoint</a></p>

    <p class="toc_part"><a class="underline" href="#calibre_link-27">PART III &ndash; More Advanced SQL Topics</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-113">| 8 | SUBQUERIES</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-114">Introduction to Subqueries Using Aggregate Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-115">Using a Subquery in the <span class="code">SELECT</span> Statement</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-116">Using a <span class="code">WHERE</span> Clause in a Subquery</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-117">Subqueries without Aggregate Functions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-118">Returning Multiple Values from a Subquery</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-119">Subqueries and the <span class="code">DISTINCT</span> Clause</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-120">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-121">| 9 | VIEWS</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-122">Turning Previous Queries into Views</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-123">Why We Use Views</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-124">How to Modify a View</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-125">Creating a View from Joins</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-126">Removing a View Using the DROP Statement</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-127">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-128">| 10 | DATA MANIPULATION LANGUAGE (DML)</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-129">Data Analysis Versus Database Management</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-130">Inserting Data into a Database</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-131">Updating Data and the <span class="code">SET</span> Keyword</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-132">Deleting Data</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-133">Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-134">Conclusion</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-135">It Is All About Asking Good Questions</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-136">Finding Your Niche</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-137">Choosing the Right Database Occupation</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-138">Is It All about the Money?</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-139">Is SQL Knowledge Universal?</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-140">Switching Careers</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-141">Selling Your New Skills to Your Company</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-142">Beyond SQL: Data Visualization Software </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-143">Interview Advice</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-144">SQL Certifications </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-145">Final Thoughts and Parting Words</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-146">Appendix I </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-147">Chapter 3 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-148">Chapter 4 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-149">Chapter 5 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-150">Chapter 6 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-151">Chapter 7 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-152">Chapter 8 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-153">Chapter 9 Data Analysis Checkpoint</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-154">Chapter 10 Data Analysis Checkpoint</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-155">Appendix II </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-156">Chapter 4 Keywords</a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-157">Chapter 5 Keywords </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-158">Chapter 6 Keywords </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-159">Chapter 7 Keywords </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-160">Chapter 8 Keywords </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-161">Chapter 9 Keywords </a></p>

    <p class="toc-sub-entry"><a class="underline" href="#calibre_link-162">Chapter 10 Keywords </a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-163">What Did You Think?</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-164">About the Author </a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-165">About ClydeBank Media </a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-166">Glossary</a></p>

    <p class="toc_entry"><a class="underline" href="#calibre_link-167">References</a></p>

  



</nav>

</div>



<div lang="en-US" class="calibre1" id="calibre_link-168">

  <section type="part" id="calibre_link-186" class="calibre2">

    <figure type="z3998:figure" class="calibre4">

      <img class="w" src="images/000057.png" />

    </figure>

  </section>

</div>



<div lang="en-US" class="calibre1" id="calibre_link-6">

  <section type="part" id="calibre_link-187" class="calibre2">

    <figure class="wrap" type="z3998:figure">

      <img class="w" src="images/000169.png" />

    </figure>

    <h2 class="stop-section-title">BEFORE YOU START READING,<br class="calibre5" />DOWNLOAD YOUR FREE DIGITAL ASSETS!</h2>

    <figure class="wrap" type="z3998:figure">

      <img class="w" src="images/000163.jpg" />

    </figure>

    <div class="digitalassetsreference-wrap">

      <h3 class="stop-section-title1">DOWNLOAD DIGITAL ASSETS NOW:</h3>

      <p class="stop-section-link"><a class="underline" href="https://www.clydebankmedia.com/sql-assets">www.clydebankmedia.com/sql-assets</a></p>

      <p class="stop-section-note">* Must be a first time Audible user in the United States, United Kingdom, France or Germany. Audible membership is $14.95/month after the first 30 days. Easily cancel&nbsp;anytime.</p>

    </div>

  </section>

</div>



<div id="calibre_link-171" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-188"><a id="calibre_link-39" class="calibre6"></a>Introduction</h2>

    <p class="p">With each passing day&mdash;really with each passing second&mdash;greater and greater quantities of data are collected. In the time it takes you to finish this sentence, over 500,000 Google search queries will be submitted.<a href="#calibre_link-172" id="calibre_link-15" class="calibre6"><span class="super">1</span></a> In a single minute, over 300 hours of video content will be uploaded to YouTube.<a href="#calibre_link-173" id="calibre_link-16" class="calibre6"><span class="super">2</span></a> Our capacity to store data continues to grow. Meanwhile, smartphones and social media have turned everyday individuals across the globe into a rapidly (exponentially) growing army of data generators, constantly creating new records that reveal our current interests, activities, thoughts, and feelings. Businesses and government agencies of all kinds are accepting the reality that maximum efficiency and maximum profitability cannot be achieved without harnessing the power of data.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000019.jpg" />

    </figure>

    <p class="caption">See references <a href="#calibre_link-174" id="calibre_link-17" class="calibre6"><span class="underline1">3</span></a> and <a href="#calibre_link-175" id="calibre_link-18" class="calibre6"><span class="underline1">4</span></a> in the back of the book</p>

    <p class="h2_body">While the volume of data being generated is astounding in its own right, what is truly mind-boggling is that we have only just begun to make use of it all. Only half of a percent of all data collected is ever analyzed.<a href="#calibre_link-176" id="calibre_link-19" class="calibre6"><span class="super">5</span></a> If individuals, businesses, governments, and other organizations were able to make better use of collected data, then the potential upside would be limitless. Profits and efficiency could be increased, marketers could gain more powerful insight into target audiences, and more fraud and crime could be prevented&mdash;and that is just the beginning. The shortfall in data analysis contributes to an incredible demand for skilled data-handling professionals. This is where<span class="italic"> you</span> come in.</p>

    <p class="h2_body">You are presumably reading this book because you want to learn SQL (structured query language). You have been perceptive enough to notice the ever-expanding role of data in the world, and you are putting yourself in a position to make the most of it&mdash;a very wise decision. Some of you may be studying SQL in a classroom environment, at either the high school or college level. Or perhaps you are a business or government professional looking to develop the skills necessary to carry you forward in your career. Whatever the case may be, this book’s straightforward approach to SQL will prove an invaluable resource. </p>

    <p class="h2_body"><span class="bold-italic">SQL </span>(properly pronounced “ess-cue-ell,” though “sequel” is commonly heard) is the translation tool that allows everyday individuals, even those without coding experience, to communicate with a database and turn big data into information they can use to make decisions that affect their business for the better. I have been working with SQL and other forms of big data management for eighteen years, but I can still remember what it was like to be a beginner. It took me a while to warm up to data management. When I first learned how to use Microsoft Access, data management was just another node in the IT field, without the hype that surrounds it in the present day. The quantity of data generated was relatively minuscule in light of today’s information overload. Today, every search query made on Google, every post shared on Facebook, and every five-star review in every product category on Amazon is ultimately stored on a server somewhere and is subject to being queried. SQL is the principal analytical tool used to decipher big data, hence the extraordinary demand for individuals trained in the language. The language of data is a language that every modern tech-oriented company speaks to some degree. This book will get you fluent in the language of data.</p>

    <h3 class="h1" id="calibre_link-189"><a id="calibre_link-40" class="calibre6"></a>My Story</h3>

    <p class="h2_body">My personal road to mastery of SQL began in the late nineties. At the time, opportunities to learn SQL in a formal, institutional setting were quite scarce, as the phenomenon of big data had not come to maturity. In lieu of any real scholastic alternative, I matriculated into the school of hard knocks&mdash;I learned SQL by trial and error, mostly error. Even after acquiring a bachelor’s degree in computer science and a master’s in management information systems, I did not feel that a formal, academic, and sometimes overly theoretical approach to learning was the best pathway to success in the field of data science&mdash;a belief I would confirm after working for over eighteen years in a variety of roles using SQL (as well as other programming languages) to manage data systems across several sectors, from startups to Fortune 500 companies, from law to healthcare to big box retail.</p>

    <p class="h2_body">If I have learned anything from both my academic and professional wanderings, it is this: there is a much more practical approach to becoming an invaluable resource in your existing or new career in the world of big data. It does not have to be as difficult for you as it was for me. In fact, it was my desire to distill all the lessons I have learned into a simple, practical, hands-on approach to SQL that led me to write this book.</p>

    <p class="h2_body">The enthusiasm I have for teaching is actually a product of family values. I was born in Trinidad, a country you have probably heard of but are perhaps unable to place on the map. It is a tiny dual-island country, known formally as “Trinidad and Tobago,” located at the northern end of the South American continent and the southern end of the Caribbean Sea. Though the Caribbean may be known for cruises, carnivals, soca, and reggae music, life was not all beaches and coconuts. </p>

    <p class="h2_body">My mother was both a literature teacher and a high school principal. When she wasn’t at school, she was at home giving piano lessons. She was always sharing ideas, always teaching, and never lacking for students. She considered it a social responsibility to pass her acquired skills and knowledge to others in the community, often working long hours and giving back to those around her in any way she could. The teaching passion extends deep and wide throughout my family tree; I had an aunt, uncle, and grandfather who were all professional educators. Though I have lived in the United States for nearly twenty years, I still return to Trinidad each year to visit family and to reflect on the incredible journey that is life.</p>

    <p class="h2_body">When I am not working in the field you can find me in the classroom, where I regularly host SQL and data visualization training courses for beginners and intermediate-level students. I love to code&mdash;don’t get me wrong&mdash;but it is in teaching, in seeing my students succeed, where I find the most joy. </p>

    <h3 class="h1" id="calibre_link-190"><a id="calibre_link-41" class="calibre6"></a>Why I Wrote This Book</h3>

    <p class="h2_body">My objective in writing this book was to create a definitive beginner’s SQL toolbox&mdash;the kind of resource I wish I’d had access to when I was just beginning in this field. As I learned from my formal education, a theoretical approach to technical and programming topics is not the most practical, or the most sympathetic to our busy lives and schedules. Other SQL texts spend a lot of time explaining both the history and the computer science theory behind databases and query language. This book aims to take a polite nod toward those topics, covering only what is essential for understanding how a relational database functions, and then blaze on ahead. The rest of the book is designed to equip you, the reader, with a hands-on reusable reference guide to harness big data and turn it into actionable information. The truth of the matter is that learning SQL requires a commitment to regular study and practice. The best teachers do not simply spout information at their students and hope for the best. The best teachers are those who set expectations responsibly and ensure that students adopt a resilient, “can-do” frame of mind. I do not want this book to center around my expertise. Instead, I want it to focus on you and your path to learning. For me it is both a pleasure and a privilege to spend my working hours venturing about in oceans of data. The next challenge lies in helping you comfortably enter these oceans without fear of drowning.</p>

    <p class="h2_body">Creating a “QuickStart” resource that can be used by a pure beginner on SQL is an ambitious endeavor. I have worked with hundreds of SQL students, enough to gather a sense of what works and what does not. My passion for teaching SQL has spanned several years and many different professional positions. When you acquire a real proficiency in this skill, you will soon find yourself beset by colleagues looking to you for help. Whether it is an executive who wants targeted data about the latest marketing campaign or a fellow coder who needs your help crafting a query, being handy with SQL has a way of drawing people to you&mdash;<span class="italic">if you learn it, they will come.</span></p>

    <p class="h2_body">My SQL coaching business, SQL Training Wheels, and my data visualization business, <a href="http://Datadecided.com" class="calibre6"><span class="underline1">Datadecided.com</span></a>, are truly a culmination and institutionalization of my enthusiasm for teaching the craft. SQL Training Wheels began in a coffee shop in Tribeca, New York, with me and a laptop full of SQL learning materials I had prepared. I had no idea whether anyone was going to show up. I must have underestimated the demand for SQL training, because not only did people show up, <span class="italic">many</span> people showed up. And they kept coming. Before I knew it, I had a business.</p>

    <p class="h2_body">I have discovered over the years, in my capacity as an SQL mentor and coach, that I truly enjoy teaching. Growing up among active academics, I witnessed firsthand the power of imparted knowledge, how it could replenish confidence and promote positive personal transformations. Though New York City is worlds apart from my home in Trinidad, I still recognize and relish that moment when I see a light turn on in a student’s mind&mdash;their eyes brighten, their anxiety is abated, something clicks! I never get tired of these “lightbulb” moments.</p>

    <p class="h2_body">As I continue to improve and expand this training endeavor, working with a rich variety of students with different aptitudes and skill sets, I find myself contemplating the idea of one day expanding my business seaward, back home to the Caribbean. I think it would be a blast teaching a few courses in Trinidad, maybe in Grenada as well. How gratifying it would be to take back the knowledge and experience of my time in the United States while also developing a Caribbean franchise! There is no rule saying you cannot dream big and give back at the same time. </p>

    <h3 class="h1" id="calibre_link-191"><a id="calibre_link-42" class="calibre6"></a>A Word of Encouragement for the Pure Beginner</h3>

    <p class="h2_body">To be successful in your study of SQL, you must be patient&mdash;with the material and especially with yourself. I believe in every student I teach, but my success as a teacher is ultimately measured by that of my students. For the pure beginner, SQL and database management will seem intimidating. Accept it, transcend it; greet the challenge with a tenacious spirit, and you are going to be successful! Here are a few important things to keep in mind for those of you who are brand new to SQL:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Don’t be afraid of making mistakes. There is no shortage of <span class="bold-italic">sandbox</span> space in this industry. In other words, there are plenty of ways to practice SQL without the potential of “ruining” an existing database, which is a concern for some beginners. A sample database is made available for you to use in conjunction with this book. I want you to take full advantage of it and be open to learning via trial and error.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Treat this book as a workbook. Highlight, underline, write in the margins. SQL is a topic that is learned by doing, not just reading. I have carefully designed the exercises in this book to reflect real-world scenarios and to slowly build upon each other to fortify what was learned in the previous chapter. If you find a new concept difficult, there is value in going back and working through the fundamentals again.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Enjoy your study! Do not lose sight of the fact that you are sitting on the cutting edge of information technology, honing a high-demand skill that is poised to radically change the world. It is okay to be a little excited!</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-192"><a id="calibre_link-43" class="calibre6"></a>The Scope and Focus of This Book</h3>

    <p class="h2_body">For readers who already possess a basic or even an advanced understanding of SQL, this QuickStart Guide will function as both a refresher and a handy reference text that you can consult when crafting your queries. Also, if you are among the many aspiring SQL coders to have recently enrolled in an SQL course or training program, then this QuickStart Guide will serve as a fantastic primer text and should provide a nice advantage for you in the classroom.</p>

    <p class="h2_body">Please note that this book primarily covers the basic SQL toolkit you need to understand and extract useful and actionable information from existing database sources. The standard query methods taught in this text can be done safely without risk of changing the database in any way. However, in one of the later chapters we do briefly cover adding, modifying, and removing entries from a database (known as data manipulation language, or DML). Learning the concepts in the DML chapter is not necessary for extracting information from a database, but it is helpful to know how this process is done, and this chapter may be of some interest to those considering a career in database administration.</p>

    <h3 class="h1" id="calibre_link-193"><a id="calibre_link-44" class="calibre6"></a>SQL and Your Career</h3>

    <p class="h2_body">SQL is one of the most consistently in-demand coding languages that you can study. It is the gold standard for database administration work, but it is also highly sought after in a host of other technical occupations, including software engineering and development, quality assurance testing, and business analysis, to name a few. In fact, why don’t we take a moment and review some of these job descriptions.</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">Database administrator</span> <span class="bold">(DBA)</span>: The database administrator is ultimately responsible for ensuring that the company is using the right tools to store and access their data. DBAs take a leadership role in purchasing or modifying the hardware and software solutions that comprise the company database. Database administrators are also responsible for controlling access to the database. They must set and enforce access permission thresholds, password controls, and so forth.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">Database developer</span>: The primary role of the database developer is to continually expand and refine the SQL code used to navigate the database. In many organizations the SQL coders are asked to create preassembled blocks of code that can be easily employed by non-skilled individuals. SQL developers are also often placed in charge of ongoing testing of the database to ensure quality performance and optimized functioning.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">Data scientist</span>: Data scientists focus on improving and generating new ways of using data to add value to the business. A data scientist working for Amazon might design a system aimed at using data from your product searches to determine which products you see advertised when you log in to your account.</p>

      </li>

    </ul>

    <p class="h2_body-sa">As our capacity to record and store massive amounts of data continues to expand, so does the differentiation and specialization in the data industry. It is no longer uncommon to find universities offering degrees in database administration, data center operations, and data management. In this rapidly emerging field, SQL is the common tongue, and learning it is your ticket to the big data party.</p>

    <p class="h2_body">While the data industry understandably covets SQL-trained individuals, the real-world demand for SQL actually extends even further. In any given industry (not just in big data) you may find a multitude of job positions that utilize SQL. Some of these jobs may not require SQL as a primary skill, but if you are able to bring SQL knowledge to the table while also meeting the rest of the job’s requirements, then you will hold a serious advantage over the competition when it comes to getting hired or getting a raise.</p>

    <p class="h2_body">If you can develop and demonstrate proficiency in SQL, then you can expect to command a healthy salary in the marketplace. In 2018, the average salary for an SQL-trained worker in the United States was upwards of $80,000.<a href="#calibre_link-177" id="calibre_link-20" class="calibre6"><span class="super">6</span></a> In addition to academic study, you will likely need to acquire some hands-on learning before a company will hire you full time. Many companies offer paid internships that will provide you with the opportunity to put your SQL skills to the test in real-world business environments.</p>

    <p class="h2_body">Some of you may be pursuing SQL in an effort to mobilize your career path within the company for which you currently work. Perhaps your acquiring of SQL literacy will clearly create value for your company, and you intend to make a case (or have made a case already) to the powers that be that you should be allotted whatever time and resources are needed to develop this skill. And if you end up becoming a more sought-after commodity in the meantime, well, that is always nice too, right?</p>

    <p class="h2_body">The demand for SQL spans a multitude of industries and job types. If a company or industry benefits from storing and analyzing data, then the company and industry are likely to benefit from SQL. Take a moment and try to think of all the businesses out there that could potentially benefit from data analysis. This is not a difficult exercise. It is actually much more challenging to think of businesses that would not benefit; hence the insatiable demand in the marketplace for professionals adept at transcribing big data into business advantages. Full speed ahead!</p>

    <h3 class="h1" id="calibre_link-194"><a id="calibre_link-45" class="calibre6"></a>Chapter by Chapter </h3>

    <p class="h2_body">There are innumerable ways to learn a new skill. For this particular skill, I’ve found there is no better way than jumping right in and practicing. This book is designed to get you writing queries as soon as possible. The book is divided into three major parts consisting of three to four chapters each: </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Part 1: Creating Your SQL Learning Environment” &ndash; Part 1 includes an introduction to database terminology and structure, as well as a hands-on section designed to set up the specific database software we will be using in this book. Even if you feel confident that you understand the basics of SQL, we still strongly recommend that you follow along, as this section will explain the specific SQL tools, methods, and strategies we will be using throughout the text.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 1: Understanding Database Structure” &ndash; This is the only real “sit down and read” chapter in this book. This chapter introduces the concept of a relational database, the types of data you will encounter, and a brief overview of some of the terminology used. The rest of the text will be definitively hands-on.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 2: SQL Tools and Strategies” &ndash; In this chapter, we explain how to get the most out of this book, which is intended to be used in conjunction with free downloadable SQL software (SQLite) and a provided sample SQL database so that you can test out what you have learned immediately after you learn it. This chapter also explains how to make the most of the included self-assessments, guided exercises, and other resources provided in the book.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 3: Exploring a Database in SQLite” &ndash; In this chapter, we will open the sample database in an SQL browser and explore its contents. You will familiarize yourself with using an SQL browser to navigate the overall structure of a database, view data on individual database tables, and access the “Execute SQL” tab. </p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Part 2: Writing SQL Statements” &ndash; In Part 2, we give you the tools to write simple queries. We start with the basic <span class="code">SELECT</span> statement and then introduce additional SQL keywords that enable us to return more specific results. </p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 4: Getting Started with Queries” &ndash; This chapter introduces the basic <span class="code">SELECT</span> statement, demonstrates how to return data from a specific table using the <span class="code">FROM</span> statement, sort that data alphabetically using <span class="code">ORDER</span> <span class="code">BY</span>, and then limit the results using <span class="code">LIMIT</span>.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 5: Turning Data into Information” &ndash; This chapter introduces the <span class="code">WHERE</span> clause and the comparative, logical, and arithmetic operators that it takes as arguments. Chapter 5 also introduces <span class="code">LIKE</span> and the use of wildcards as well as the <span class="code">DATE()</span> function, <span class="code">AND/OR</span> operators, and the <span class="code">CASE</span> statement.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 6: Working with Multiple Tables” &ndash; This chapter introduces join statements that allow you to return and compare data from multiple tables using <span class="code">INNER</span> <span class="code">JOI</span><span class="code-tracking">N</span>, <span class="code">LEFT</span> <span class="code">JOI</span><span class="code-tracking">N</span>, and <span class="code">RIGHT JOIN</span>.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 7: Using Functions” &ndash; This chapter introduces a powerful collection of calculation tools known as functions, including aggregate, string, and date functions.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Part 3: More Advanced SQL Topics” &ndash; Part 3 introduces more advanced but very helpful techniques used to enhance the efficiency of writing queries. This part also includes an introduction to data manipulation language (DML), which, unlike all other SQL statements so far, will permanently alter the data in a database.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 8: Subqueries” &ndash; This chapter introduces the concept of nesting one query inside of another query, resulting in what is called a subquery. The chapter demonstrates how to use subqueries with a variety of SQL keywords we have already learned, as well as introducing the <span class="code">DISTINCT</span> keyword.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 9: Views” &ndash; This chapter introduces virtual tables known as views: queries that are saved and can be executed repeatedly as needed or used as subqueries in other SQL statements.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">“Chapter 10: Data Manipulation Language” &ndash; This chapter covers data manipulation language (DML) and introduces the <span class="code">INSER</span><span class="code-tracking">T</span>, <span class="code">UPDAT</span><span class="code-tracking">E</span>, and <span class="code">DELETE</span> keywords.</p>

      </li>

    </ul>

  </div>

</div>



<div class="calibre1" id="calibre_link-36">

  <section type="part" id="calibre_link-195" class="calibre2">

    <figure class="vertical-image-wrap" type="z3998:figure">

      <img alt="PART I - CREATING YOUR SQL LEARNING ENVIRONMENT" class="portrait" src="images/000063.jpg" />

    </figure>

  </section>

</div>



<div id="calibre_link-178" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-196"><a id="calibre_link-46" class="calibre6"></a>| 1 | </h2>

    <p class="chapter-title" id="calibre_link-197"><a id="calibre_link-198" class="calibre6"></a>Understanding Database Structure</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Understanding the language databases use</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">How a relational database functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data types</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Relational database management systems (RDBMSs)</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">SQLite</p>

        </li>

      </ul>

    </div>

    <p class="p">When learning any new technical skill, you need to know the basic vocabulary to start your journey. We aim to find the right balance: arming you with the fundamental terms and concepts you will need for the remainder of this book, while avoiding unnecessary jargon or advanced concepts. In this chapter, we will introduce the concept of a relational database and showcase the types of data you will encounter in a typical database. We will also introduce the fundamental SQL query: the <span class="code">SELECT</span> statement.</p>

    <h3 class="h1" id="calibre_link-199"><a id="calibre_link-47" class="calibre6"></a>Fundamental Terminology</h3>

    <p class="h2_body">A “datum” is defined as “a piece of information.”<a href="#calibre_link-179" id="calibre_link-21" class="calibre6"><span class="super">7</span></a> <span class="bold-italic">Data</span> is simply the plural form of datum. Data appears everywhere and is contained in everything, but for practical purposes the term “data” generally refers to recorded or recordable information. One of the simplest tools used to record and visualize data is the<span class="bold-italic"> table</span>. A table is merely a two-dimensional grid consisting of rows and columns.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">When used in a database, a table may also be referred to as a “base relvar,” though in this book we will adhere to the term “table.” Please see the Terminology Summary graphic (Figure 5).</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000054.jpg" />

    </figure>

    <p class="h2_body">As you can see in Figure 2, the table contains different types of data. Data can be names, numbers, dates, characters (like “+” or “-”), or it may be presented in a multitude of other formats. Data, in its purest sense, is just information. Therefore, when handling data it behooves us to constrain it appropriately. Look at the table in Figure 2; it appears to store basic information about a group of medical patients. Data about the patients is defined using various formats. There are numbers, names, and dates, and in the <span class="code">BloodType</span> field, a string of two characters is used (a letter and a “+” or “-” character). The formats used to render data are not random. All databases contain something known as <span class="bold-italic">metadata</span>, which is data that describes the structure and formatting of the data itself, commonly referred to as “data about the data.” For example, the <span class="code">DateOfBirth</span> field may contain metadata that constricts information in the field into mm/dd/yyyy format. The metadata in the <span class="code">Height</span> field might limit data to two digits in length and require that it be expressed in terms of inches.</p>

    <p class="h2_body">The term <span class="bold-italic">database</span> can be simply defined as a collection of data arranged for ease and speed of search and retrieval by a computer. The database is often symbolized graphically as a multitiered cylindrical icon (Figure 3) meant to symbolize the stacking of hard disks one on top of another to create a high-capacity data storage center. </p>

    <p class="h2_body">Data inside the database is typically stored in a collection of tables. Each table contains a specific set of data, which may relate to and reference other data from other tables within the database. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000154.png" />

      </figure>

      <p class="example">The patient data table in Figure 2 is just a table, not a database. It could, however, be incorporated into a database alongside other tables, such as those storing information about lab tests, prescription drugs, appointment histories, hospital personnel, doctor information, specialties, and appointment availability.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000060.jpg" />

    </figure>

    <p class="h2_body">The purpose of the database is to facilitate the interaction, organization, and analysis of related data across a multitude of sources. When data is placed in tables that have the capacity to relate to one another within a database, a new level of versatility becomes possible.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000102.jpg" />

    </figure>

    <p class="h2_body">The <span class="bold-italic">rows</span> in a given table are considered <span class="bold-italic">records</span>. They may also be referred to as <span class="italic">tuples</span>. The <span class="bold-italic">columns</span> in a table may generally be referred to as <span class="bold-italic">fields</span>. They may also be called <span class="bold-italic">attributes</span>. Fields/attributes are the categories used to define the data within the record (row).</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Throughout this book we will be using the term “records” to describe the rows in a table and “fields” to describe the columns. Please refer to the Terminology Summary in Figure 5. </p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000107.jpg" />

    </figure>

    <p class="h2_body">Every record is broken down into several fields that represent single elements of data describing a specific thing. For example, our table featured in Figure 6 stores information about patients, presumably at a particular hospital or medical practice or in a particular insurance pool. Whatever the nature of the organization, if they keep a database, then that database will likely be composed of several tables. Understanding how tables refer to and relate to one another is key to understanding essential database architecture.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000114.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-200"><a id="calibre_link-48" class="calibre6"></a>Fundamental Elements of Relational Databases</h3>

    <p class="h2_body">The <span class="bold-italic">relational database</span> is a database design that was formally conceived of in 1969 by a computer scientist at IBM named Edgar F. Codd. Codd published an article the following year called “A Relational Model of Data for Large Shared Data Banks.”<a href="#calibre_link-180" id="calibre_link-22" class="calibre6"><span class="super">8</span></a> Nine years later, several big players in tech, including IBM and Relational Software Inc. (later to become Oracle), began using relational databases for commercial purposes. Four decades later, the relational model continues to prevail as the most common form of database design.</p>

    <p class="h2_body">To gain a rudimentary understanding of how relational databases function, it is important to understand the role of key fields. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000126.jpg" />

    </figure>

    <p class="h2_body">A relational database will contain a multitude of tables similar to the <span class="italic">patient_info</span> table shown in Figure 7. These tables relate to one another on the basis of key fields. In the <span class="italic">patient_info</span> table you will notice the primary key field and the foreign key field. As a matter of best practice, every table in a relational database should have a primary key. The <span class="bold-italic">primary key</span> acts as the unique identifier for a record in the table. Each record’s primary key must be unique, record by record, and must not be null (empty). Notice the <span class="code">PatientId</span> field in the<span class="italic"> patient_info</span> table. Since this field is used as the table’s primary key, each and every record in the table must have unique data stored in this field. In other words, no two records may contain the same <span class="code">PatientId</span> data.	</p>

    <p class="h2_body">Although there must be unique data in the primary key field (<span class="code">PatientId </span>in this case), the other fields contain data that may be replicated in more than one record. For example, consider the <span class="code">PrimaryCareDoctorId</span> field; if Dr. Waynewright, ID# 106547 (see the first row in Figure 7), treats multiple patients in the database, then his name and ID may show up in multiple records in the table. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">In a relational database, tables are often referred to as “relations,” because they contain a set of records (rows) related to various fields (columns). Throughout this book, however, we will be using the term “table.” Please refer to the Terminology Summary in Figure 5.</p>

    </div>

    <p class="h2_body">A <span class="bold-italic">foreign key </span>field is a field within a table that is acting as a primary key in another table in the database. Let’s suppose that in addition to our <span class="italic">patient_info</span> table there is another table in the database called <span class="italic">primary_care_doctors</span>, which uses the <span class="code">PrimaryCareDoctorId</span> field as its primary key. In the <span class="italic">primary_care_doctors </span>table, Dr. Waynewright, with the ID# 106547, will appear in only one record. It is the overlap of various key fields among tables that facilitates the all-important relatability within the aptly named relational database. These relationships are commonly visualized using a database <span class="bold-italic">schema</span>, also known as an <span class="bold-italic">entity relationship diagram (ERD)</span>, which serves as a kind of blueprint for the database.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000152.jpg" />

    </figure>

    <p class="h2_body">For the moment, don’t worry about the 1’s and the ∞ symbols. We will explain them in a moment. For now, take a few minutes to study the schema and consider its relationships. There are only four tables in this schema, and the tables are connected to one another by way of one or more common fields. The <span class="code">PatientId</span> field is the primary key for the <span class="italic">patient_info</span> table, but it is a foreign key field for the <span class="italic">lab_orders</span> table. Similarly, the <span class="code">HospitalId</span> field is the primary key for the <span class="italic">hospitals</span> table, but it is a foreign key field for the <span class="italic">primary_care_doctors</span> table. Pretty simple, right? Let’s take a look at another schema for a different kind of operation.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000145.jpg" />

    </figure>

    <p class="h2_body">The schema in Figure 9 describes a database that handles the ordering and shipping of products to customers. Now, about those 1 and ∞ symbols found at the ends of the connecting lines in our sample schemas: these notations describe the nature of the interactivity between tables. When there is a 1 on one end of the connecting line and a ∞ symbol on the other end, it represents a “one-to-many” relationship between the tables’ shared fields.</p>

    <p class="h2_body">Let’s take a closer look at the <span class="italic">products</span> table (Figure 10). Clearly, the data here is about various products and their attributes.</p>

    <p class="h2_body">The <span class="code">ProductId</span> field is the primary key for this table, as symbolized by the key icon. Each record in the table will contain a unique product identification number. In fact, that is the whole purpose of this table&mdash;to catalog the attributes of the database’s various products.</p>

    <p class="h2_body">Now, let’s look at the relationship between <span class="italic">products</span> and <span class="italic">suppliers</span>. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000035.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000041.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000048.jpg" />

    </figure>

    <p class="h2_body">There is a one-to-many relationship between <span class="italic">suppliers</span> and <span class="italic">products</span> based on the data in the <span class="code">SupplierId</span> field. In <span class="italic">suppliers</span> each record will possess a unique identification number for each supplier, but in <span class="italic">products</span> there may be several records with the same supplier identification number. </p>

    <p class="h2_body">The key icon next to the <span class="code">SupplierId</span> field in <span class="italic">suppliers</span> alerts us to the fact that <span class="code">SupplierId</span> is the primary key for that table. We can certainly have many different products (each with its own unique product ID number) coming from the same supplier and cataloged in the <span class="italic">products</span> table. Contrast this with <span class="italic">suppliers</span>, where we must have one and only one unique supplier ID number for each record.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000053.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Identical <span class="code">supplierId</span> data may appear in multiple records in the <span class="italic1">products</span> table but not in the <span class="italic1">suppliers</span> table.</p>

    </div>

    <p class="h2_body">Next, let’s look at the relationship between the <span class="italic">products</span>, <span class="italic">order_details</span>, and <span class="italic">orders</span> tables (Figure 14). </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000059.jpg" />

    </figure>

    <p class="h2_body">The <span class="italic">order_details</span> table appears to have two primary keys, as signified by the key icons. It is helpful to think of this scenario as a composite primary key, or <span class="bold-italic">composite key</span>, whereby two or more fields are used to define the primary key. Though there are technically two keys in play, it is still best thought of as a single item&mdash;<span class="italic">the</span> primary key. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000123.jpg" />

    </figure>

    <p class="h2_body">The combination of data that populates the fields used to form a composite key acts as the unique identifier for any given record within the table. In other words, if the <span class="code">OrderId</span> of a record in the <span class="italic">order_details</span> table is “101” and the <span class="code">ProductId</span> for the same record is “P006,” then we can assume that no other record in the table will have the same combination of data in those two fields. There may be one or several other records with an <span class="code">OrderId</span> of “101,” and there may one or several other records with a <span class="code">ProductId</span> of “P006,” but only one record may have both “101” as its <span class="code">OrderId</span> <span class="italic">and</span> “P006” as its <span class="code">ProductId</span>. This combination of data across fields acts as the composite key, which, like any primary key, provides a unique identifier for each and every record in the table.</p>

    <p class="h2_body">You may have noticed that the standard primary key in any given table usually represents the “one” in a one-to-many relationship. For example, in <span class="italic">orders</span>, we can see that the primary key, the <span class="code">OrderId</span> field, will provide a unique identifier for each record in the table. The “many” side of the relationship is found in <span class="italic">order_details</span>. Why do you think that is?</p>

    <p class="h2_body">Let’s think this through logically. We can infer that the purpose of <span class="italic">order_details</span> is to provide information about various products that are ordered. We can infer that any given product may be ordered multiple times by multiple customers under many different circumstances, with different prices, etc. Hence, <span class="code">ProductId</span> cannot be used on its own as a primary key for<span class="italic"> order_details</span>. We may also infer that any given order may include multiple products, and if we look at the other fields used in <span class="italic">order_details</span>&mdash;<span class="code">UnitPrice</span>, <span class="code">Quantity</span>, and <span class="code">Discount</span>&mdash;then we can see clearly that these fields speak to the properties of an individual product, not an order at large. Therefore, <span class="code">OrderId</span> cannot be used on its own as a primary key for <span class="italic">order_details</span>. The solution is to combine <span class="code">ProductId</span> and <span class="code">OrderId</span> into a composite key, thereby ensuring that the data contained in the <span class="code">UnitPrice</span>, <span class="code">Quantity</span>, and <span class="code">Discount</span> columns corresponds to a unique and specific order <span class="italic">and</span> a unique and specific product within that order.</p>

    <h3 class="h1" id="calibre_link-201"><a id="calibre_link-49" class="calibre6"></a>Types of Data</h3>

    <p class="h2_body">Earlier in this chapter we introduced the concept of metadata, which is data that describes limitations or formatting specifications for other data within the database. When developing a database using SQL, a specific <span class="bold-italic">data type</span> must be designated for each and every column used. Data types will vary slightly depending on the version of SQL you are using. In general, though, you will have numeric data types, character or text-based data types, dates and times, and Boolean values. Let’s talk a little bit about each of these. </p>

    <p class="h2"><span class="bold1">Numeric Data Types</span></p>

    <p class="h3_body">Numeric data includes integers, which are whole numbers that do not use decimals. Usually, when an integer data type is used, it comes with some form of limitation on its length. Recall that in Figure 7, the table contained data about various patients. For the Weight column we might consider assigning an integer data type with a limit of three digits. Why? Because a) we are okay rounding up or down to the nearest pound or kilogram and do not need to use decimal places, so integers will do. And b) it is inconceivable that we would need more than three digits to describe someone’s weight in pounds. When integer data will not do, and we need a more precise numeric format, we can use decimal data, which will allow us to use decimals as needed to fine-tune our numeric values. Like integer data, decimal data can also be length-restricted.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000101.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Data types that permit longer spans of digits, characters, etc., require more bytes of storage space. SQL also allows monetary numeric data types.</p>

    </div>

    <p class="h2">Character or Text-Based Data Types</p>

    <p class="h3_body">Character or text-based data types may be configured to hold both a fixed-length string of characters and a variable-length string. For example, if one of your database columns included standard six-character Canadian postal codes (which include both numbers and letters), then you would use a character or text-based data type configured for a fixed-length string of six characters. If you were creating a column to hold a customer’s first or last name, then you would want to configure a variable-length string using reasonable maximum and minimum length limits.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000049.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The examples we have used thus far have featured relatively short text-based data, such as names and address information. Many databases contain text-based fields that permit much lengthier strings of text and characters. Some database structures can allow for the text of multipage memorandums or even books to be cataloged. </p>

    </div>

    <p class="h2">Dates and Times</p>

    <p class="h3_body">Dates and times are obviously important data in many circumstances. SQL allows users to choose from a variety of different date-and-time layouts: YYYY-MM-DD, YYYY-MM-DD HH:MI:SS, YY-MM-DD. You may also format a column to hold just the year, either in a four- or two-digit format; that is, “2019” or just “19.” Figure 18 exemplifies date and time data in use.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000083.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Date/time formats in SQL have built-in numeric values that allow the database to interpret requests for chronologically specific outputs. For example, if you want to know how many customers bought a certain product between the dates of October 1, 2020, and December 31, 2020, then SQL can help you generate and sort this output. </p>

    </div>

    <p class="h2">Boolean Values</p>

    <p class="h3_body">A <span class="bold-italic">Boolean</span> value is data expressed as either True or False. If you are in charge of a sensitive operation for a government or private entity, then you may use a database to help you keep track of your staff members’ security clearance levels. If you need to locate a list of staff members who have security clearances A, B, and D, but not necessarily C, then using Boolean data analysis can make life easier. Figure 19 shows Boolean data in use. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Different versions of SQL will have different lists of recognizable data types. Some versions of SQL, such as SQL Server and MySQL (discussed later in this chapter), do not provide the user with the option to label a data type as “Boolean.” Instead, they provide a “Bit” data type, which can easily be appropriated into a quintessential Boolean format.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000037.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-202"><a id="calibre_link-50" class="calibre6"></a>Relational Database Management Systems</h3>

    <p class="h2_body">SQL operates in a wide variety of software packages known as <span class="bold-italic">relational database management systems (RDBMSs)</span>. These systems facilitate the application of SQL when one is issuing commands and posing questions to a database. Popular RDBMS software includes Oracle Database, Microsoft SQL Server, MySQL, IBM Db2, and SQLite.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000070.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">It is not uncommon for the RDBMS software itself to be referred to as a database. This is a slight misnomer. More precisely stated, the RDBMS provides an interface (usually known as an SQL browser) for the user to interact with the data stored on the database. </p>

    </div>

    <p class="h2_body">Some RDBMSs are primarily graphic by design. Others are more text-based. RDBMSs also vary in their approach to SQL. We referenced one such anomaly previously in this chapter with regard to the handling of Boolean data. RDBMSs do vary in the way they present database information. </p>

    <p class="h2_body">The fact that we are telling the RDBMS what information to present to us defines SQL as a “declarative” programming language. This stands in contrast to other programming languages you may be familiar with, such as C++, Java, etc. Those languages are more procedural, in that they handle creating and running a program from start to finish (allocating memory, including existing reference files, etc.). With SQL, all of the memory allocation and other procedural duties are handled by the RDBMS. </p>

    <h3 class="h1" id="calibre_link-203"><a id="calibre_link-51" class="calibre6"></a>The <span class="h3heading_code">SELECT</span> Statement</h3>

    <p class="h2_body">As you know, SQL stands for structured query language, and for several decades it has set the standard for how we communicate with relational databases. The most common SQL command is <span class="code">SELECT</span>, a command we will be working with quite closely in chapter 4 and throughout the rest of this book. An SQL query is usually comprised of the <span class="code">SELECT</span> keyword in combination with other SQL keywords and references to the data involved in the query. As is the case in other programming languages, the correct sequence and choice of SQL keywords is vital to creating a query that can be correctly interpreted by the SQL browser. This mandated structure is also known as the <span class="bold-italic">syntax</span> of a query.</p>

    <p class="h2_body">In the following example, we can see how syntax of a query varies slightly from one RDBMS implementation to another. These are two very basic queries that essentially do the same thing (they return the first ten records from the <span class="italic">Products</span> table) but as you can see, they are phrased slightly differently. </p>

    <p class="h2_body-sa">In SQL Server we would type the following: </p>

    <pre class="code-wrap">SELECT TOP 10 * 
FROM 
   products;</pre>

    <p class="h2_body-sa">But in MySQL, we would type </p>

    <pre class="code-wrap">SELECT * 
    FROM 
    	products 
    LIMIT 10;</pre>

    <p class="h2_body-sa">If we were to structure a query in MySQL similar to the SQL Server example, the SQL browser would generate a <span class="bold-italic">syntax error</span> which would prevent the query from running. In this case, the only difference between these two SQL implementations is the way we tell the SQL browser to limit our results to the top ten. The rest of the query is the same. The variations between RDBMSs are generally very minor, usually less than a 10 percent change from one to another. The simple, declarative nature of SQL is fairly consistent across most RDBMSs. Therefore, if you commit yourself to learning the underlying logic of SQL within the confines of any given RDBMS, then you will find your knowledge to be quite portable; that is, you will be able to quickly tailor your knowledge of SQL fundamentals to another RDBMS. </p>

    <h3 class="h1" id="calibre_link-204"><a id="calibre_link-52" class="calibre6"></a>Queries, Statements, Clauses, and Keywords</h3>

    <p class="h2_body">If you have had any previous experience with SQL, you may have heard these four words used interchangeably: query, statement, clause, and keyword. <span class="code">SELECT</span> is a special keyword in SQL, but it is also referred to as a <span class="code">SELECT</span> statement, the <span class="code">SELECT</span> clause, or a <span class="code">SELECT</span> query. So what is the difference?  Let’s start with the broadest term and finish with the most specific.</p>

    <p class="h2_body">In its most basic form, a <span class="bold-italic">query</span> is a request that returns information from the database in the form of records. A query can be composed of several SQL statements (which we will encounter in chapter 8 in the form of subqueries). An SQL <span class="bold-italic">statement</span> is any valid piece of code that is executed by the RDBMS. The code examples we just compared are both valid SQL statements (since the RDBMS allows us to execute them) and queries (since they return a record set). A <span class="bold-italic">clause</span> is a subsection of a query, containing at least one <span class="bold-italic">keyword</span> and the relevant information to be used in conjunction with that keyword (in this case references to fields and tables).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000089.jpg" />

    </figure>

    <p class="h2_body">As you can see in Figure 21, an SQL statement can be comprised of many clauses, each containing at least one keyword, as well as references to fields and tables.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">As with the previous example, Figure 21 is both a complete SQL statement and a complete query. A query can contain multiple clauses, each starting with a keyword.</p>

    </div>

    <h3 class="h1" id="calibre_link-205"><a id="calibre_link-53" class="calibre6"></a>Introducing SQLite</h3>

    <p class="h2_body">Now that we have a basic grasp of database architecture and how we interact with it, let’s switch gears a bit and move toward a more hands-on learning approach using real-world problem-solving scenarios. As we mentioned, there are several different RDBMSs to choose from. It would be ineffective in this context to try to go function by function, documenting the nuances of each individual RDBMS. Instead, we have selected SQLite as the official RDBMS of this book. SQLite is a very accessible and practical choice for new learners. It is an open-source software product and thus free to use for any purpose. About 99 percent of what you learn using SQLite is applicable to most other RDBMSs. SQLite is also one of the most widely used RDBMS systems in the world&mdash;used in computers, mobile devices, even automobiles.<a href="#calibre_link-181" id="calibre_link-23" class="calibre6"><span class="super">9</span></a> More information and some additional documentation can be found at <a href="https://www.sqlite.org/index.html" class="calibre6"><span class="underline1">https://www.sqlite.org/index.html</span></a>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000106.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The “Lite” in SQLite does not refer to the capabilities of this software, but rather to the fact that it is <span class="italic1">lightweight</span> when it comes to setup complexity, administrative overhead, and resource usage.</p>

    </div>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">A table is a two-dimensional grid of rows and columns that contains data.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data can exist as a variety of different data types, such as strings of text, numbers, or special characters.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Metadata describes the nature and format of the data, including any minimum/maximum character length or required numbers, letters, or special characters.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Relational databases can contain many tables. Each table in a relational database should have a primary key that serves as a unique identifier for that table.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">A foreign key is any column in a table that exists as primary key in another table. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The relationship between tables and their primary and foreign keys is called the database schema and can be shown visually by an entity relationship diagram (ERD), which functions as a blueprint for the database.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">There are a variety of different relational database management systems (RDBMSs) such as Oracle Database, Microsoft SQL Server, MvSQL, IBM Db2, and SQLite. Though they differ in many ways, all share the structured query language as a backbone.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The SELECT keyword is the most common SQL command used in SQL queries.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">SQL statements can contain multiple clauses using different SQL keywords.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">This text will use SQLite, but the skills you learn here can easily translate to other RDBMS platforms.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-1" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-206"><a id="calibre_link-54" class="calibre6"></a>| 2 | </h2>

    <p class="chapter-title" id="calibre_link-207"><a id="calibre_link-208" class="calibre6"></a>SQL Tools and Strategies</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Setting up our SQL environment</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The sTunes database </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">DB Browser for SQLite</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Self-assessments</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">SQL learning strategies</p>

        </li>

      </ul>

    </div>

    <p class="p">So far, we have talked a bit about what a relational database is, how data is structured inside of a database, and how we can use a relational database management system (RDBMS) to ask questions of the database (by writing queries) and obtain meaningful results. Now that we have gone over the fundamental concepts and terminology, we need to set up a working SQL environment so that we can start practicing queries. This chapter will familiarize you with the resources intended to be used in conjunction with this book, as well as the many exercises and self-assessment questions that will help you test your SQL knowledge. </p>

    <h3 class="h1" id="calibre_link-209"><a id="calibre_link-55" class="calibre6"></a>Introducing the sTunes Database</h3>

    <p class="h2_body">Imagine you were just hired as an SQL data analyst by an online retail music company, to perform analysis on their music sales data. You are given access to the company database and told it contains product information (in this case, songs and albums), personal customer information, employee records, and sales data. Management wants to know if the data in the sTunes database contains any useful information about sales, customer demographics, and any ways the company can improve or expand their services. You are given the task of analyzing their database and presenting to management any insights you discover about the data. You perform all your analysis with SQL. To begin this task, you will need to download a copy of this database onto your computer. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000136.png" />

      </figure>

      <p class="note">Follow Along and Download the sTunes Company Database</p>

      <p class="note">The sample database used throughout the rest of this book is called the sTunes database. Please navigate to <a href="http://www.clydebankmedia.com/sql-assets" class="calibre6"><span class="underline1">www.clydebankmedia.com/sql-assets</span></a> to access the sTunes database, as well as the free digital assets. After it downloads, do not open it; just save it to a location on your computer and take note of where you save it.  </p>

      <p class="note">Access the sTunes database and all Digital Asset files for this title at: <a href="http://www.clydebankmedia.com/sql-assets" class="calibre6"><span class="underline1">www.clydebankmedia.com/sql-assets</span></a></p>

    </div>

    <h3 class="h1" id="calibre_link-210"><a id="calibre_link-56" class="calibre6"></a>Introducing DB Browser for SQLite</h3>

    <p class="h2_body">As we mentioned at the end of chapter 1, we will be working with an RDBMS called SQLite, pronounced “SQL Lite.” Although SQLite is the particular implementation or protocol for our sample database, we still need to download an actual application (also known as an SQL browser) that we can use to “browse” our database just like a web browser is used to interpret pages on the web. SQLite comes with DB Browser, which is a high-quality, visual, open-source tool used to create, design, and edit database files compatible with SQLite. It is for users and developers wanting to create databases, search, and edit data.</p>

    <h3 class="h1" id="calibre_link-211"><a id="calibre_link-57" class="calibre6"></a>Installing DB Browser for SQLite</h3>

    <p class="h2_body">To install DB Browser, follow the download link included in the digital assets located at <a href="http://www.clydebankmedia.com/sql-assets" class="calibre6"><span class="underline1">www.clydebankmedia.com/sql-assets</span></a>. Once there, you will find a variety of download links for different operating systems. Be sure to choose the operating system that is relevant to you (32- or 64-bit Windows, Mac OS, Linux, etc.). After downloading the correct file, navigate to where you downloaded it and install the software. </p>

    <h3 class="h1" id="calibre_link-212"><a id="calibre_link-58" class="calibre6"></a>How to Test Your SQL Knowledge</h3>

    <p class="h2_body">As with any technical skill, practice is the key to mastery. Besides providing examples from a sample database, this book features two types of exercises in the following chapters to assess your newly acquired knowledge of SQL. Exercises labeled “ON YOUR OWN” allow you to quickly practice your skills immediately after a new concept is introduced. As the name implies, these questions do not have written solutions but are not intended to be overly difficult. Another form of self-assessment are the “Data Analysis Checkpoints.” These exercises are more challenging and may require knowledge of concepts explained in previous chapters. You can find detailed solutions to every Data Analysis Checkpoint in Appendix I.</p>

    <h3 class="h1" id="calibre_link-213"><a id="calibre_link-59" class="calibre6"></a>Strategies for Success</h3>

    <p class="h2_body">Before we launch our software and open up the sTunes Database, I’d like to offer a few words of advice, to beginner and expert alike. These words come from my experience as a teacher, and following this advice will greatly improve your chances of success: </p>

    <p class="h2">Type Out Every Code Example by Hand</p>

    <p class="h3_body">If you have access to a digital version of this text, do not just copy and paste coding examples into the SQL browser! This advice applies especially to the beginning student who has not experienced SQL before. I am very against the idea that you can learn a programming language by merely copying existing code examples or exercises into the RDBMS environment and observing what they do. Copying and pasting bypasses the syntax, spelling, and muscle memory you activate by rewriting the query yourself. Pasting code from other sources can introduce formatting errors in your code that are difficult to diagnose. For example, pasting code that includes word-processor-formatted quotation marks will often cause a syntax error because DB Browser does not interpret these symbols as single quotation marks. The mistakes we make are just as important as the successes. If the SQL statement you are trying to execute results in a bizarre syntax error, sometimes the best thing to do is delete everything and write the query again from scratch. </p>

    <p class="h2">Convert SQL Queries to Natural Language Questions</p>

    <p class="h3_body">When answering a question or writing a query, try to think of the result as an answer to a real-world question. Instead of thinking “How many entries are in the customers table?” think “How many customers do we have?” This book is intended to help start or enhance your career using SQL as a tool in your ever-expanding toolbox. The questions you will get from your managers and coworkers will be real-world questions, so it’s important to learn the technique of turning a real-world question into an SQL statement and then back into a real-world answer. </p>

    <p class="h2">Treat This Book Like a Reference Guide</p>

    <p class="h3_body">We realize that some of our readers will already have some familiarity with SQL and may want to jump ahead to a particular section. We have designed this book to include the SQL keywords (discussed in each chapter) within the chapter headings so that our readers can easily navigate through the text or quickly go back to review a concept they have already learned. In addition to quick navigation aids, we have included a second appendix with a list of SQL keywords by chapter and some stand-alone examples to get you writing queries as soon as possible. We hope you will keep this book by your desk and refer to it as often as you need to.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">Although topic jumping is encouraged, we recommend reading the next chapter (3) first, as it will introduce the software needed to run all of the example queries in the remainder of the book.  </p>

    </div>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">This book is designed to introduce the minimum required background information and then jump right in to writing SQL queries.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">To achieve this goal, and to get the most out of this book, it must be used concurrently with database software up and running as well as a sample database.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">As a data analyst, you will often be given an existing database to analyze. The sTunes database file provided here serves as a good example of what an existing database will look like when you first open it.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">DB Browser for SQLite is a free-to-use, public domain database software program that is lightweight and is a good starting point for learning how to examine database files. This program can be run in a Windows or macOS environment.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Two types of self-assessments are provided in this text to help test your knowledge. The answers to the Data Analysis Checkpoints can be found in Appendix I.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">To make the most of your learning experience, type out the SQL queries in this book by hand (instead of copying them) and consider any SQL question in terms of its real-world meaning.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-7" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-214"><a id="calibre_link-60" class="calibre6"></a>| 3 | </h2>

    <p class="chapter-title" id="calibre_link-215"><a id="calibre_link-216" class="calibre6"></a>Exploring a Database in SQLite</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Launching the SQL software</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Opening a database file </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The Database Structure tab</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The Browse Data tab</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The Execute SQL tab</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Viewing query results</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">In this chapter, we will familiarize ourselves with the interface of our chosen SQL browser for SQLite: DB Browser.</p>

    <h3 class="h1" id="calibre_link-217"><a id="calibre_link-61" class="calibre6"></a>Environment Orientation</h3>

    <p class="h2_body">We have a bit more preparation to do and then we are ready to start analyzing the sTunes database. Now that we have installed DB Browser for SQLite software and downloaded the sTunes sample database, it is time to fire it up and get going!</p>

    <ol class="calibre10">

      <li class="numbered">Start the DB Browser for SQLite application.
      <ul class="lower-alpha">
        <li class="bullets"><span class="bold">Mac users</span>: Go to Finder and double-click DB Browser for SQLite in your Applications folder.</li>
        <li class="bullets1"><span class="bold">Windows users</span>: Go to your Start Menu and click on the DB Browser for SQLite application from your list of installed programs. </li>
        </ul>
        </li>

      <li class="numbered1">You will see the following default screen (Figure 23):    </li>

    </ol>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000124.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-218"><a id="calibre_link-62" class="calibre6"></a>Opening the sTunes Database</h3>

    <ol start="3" class="calibre10">

      <li class="numbered1">With DB Browser open, click on “Open Database.”    </li>

    </ol>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000143.jpg" />

    </figure>

    <ol start="4" class="calibre10">

      <li class="numbered1">This opens the “Choose a Database File” dialog box. Navigate to the folder where you downloaded the sTunes sample database file and click on “Open.”</li>

    </ol>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000159.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-219"><a id="calibre_link-63" class="calibre6"></a>Investigating the Structure of the Database</h3>

    <p class="h2_body">When the file is opened, the Database Structure tab shows the tables contained in the sample database.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000176.jpg" />

    </figure>

    <p class="h2_body">Now that we can investigate the database structure, we can learn a lot more about our fictitious company, sTunes. Once the IT department gives us the proper permissions, our company will most likely give us some time to familiarize ourselves with the database we were tasked to analyze. Before we start writing any SQL statements, it’s a good idea to see what type of data we have available to us.</p>

    <p class="h2_body">First, we can see that there are thirteen tables in the sTunes database. By expanding the arrow to the left of the table name, we are shown the fields contained in each table. In the <span class="italic">albums</span> table, as can be seen in Figure 27, the fields are <span class="code">AlbumId</span>, <span class="code">Title</span>, and <span class="code">ArtistId</span>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000010.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">At the beginning of chapter 1, we talked about the fundamental terminology of this book. The fields we are seeing are the columns in each table. The data stretched across the rows of the table (not pictured here) are the records.</p>

    </div>

    <p class="h2_body">The <span class="code">AlbumId</span> field is an<span class="bold-italic"> integer</span> data type, which means it holds numeric data (numbers).</p>

    <p class="h2_body">The <span class="code">Title</span> field is a character data type (known as <span class="code">NVARCHAR</span>), which means it holds characters or non-numeric data.</p>

    <p class="h2_body">The <span class="code">ArtistId</span> field is also an integer data type.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We spoke about metadata and different data types in chapter 1, where we went over database structure. The <span class="code">Type</span> field in our database browser panel (see Figure 27) is a good example of metadata. The data type for each field is chosen based on the most logical type for its function.</p>

    </div>

    <h3 class="h1" id="calibre_link-220"><a id="calibre_link-64" class="calibre6"></a>Viewing the Individual Records</h3>

    <p class="h2_body">The Browse Data tab can be used to see the records contained in each table. Use the drop-down to switch between tables and browse the data contained in each one.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000026.jpg" />

    </figure>

    <p class="h2_body">In Figure 28, the Browse Data tab displays the data stored in the <span class="italic">albums</span> table. It shows the columns we observed in the Database Structure tab. It also shows the actual data contained in these columns. </p>

    <p class="h2_body">In row 1, the following data is contained in each column of the <span class="italic">albums</span> table:</p>

    <pre class="code-wrap">AlbumId = 1 
Title = “For Those About to Rock We Salute You”
ArtistId = 1</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">As per our chapter 1 terminology discussion, the columns you are seeing are referred to as fields. Every row represents an individual record. </p>

    </div>

    <p class="h2_body">By examining this table, we can also learn a bit about the other tables in this database. In chapter 1, we introduced the concept of a foreign key field. In this table we can see that the primary key is <span class="code">AlbumId</span> (there is a unique number for each record). We also have an <span class="code">ArtistId</span> which accepts an integer instead of an actual artist name. This gives us a hint that there is probably another table that holds the actual artist name as a character data type and that <span class="code">ArtistId</span> is most likely a foreign key field.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">A foreign key is a field that exists as a primary key in another table. If we look at the<span class="italic1"> artists</span> table, we can confirm that <span class="code">ArtistId</span> is the primary key in that table, so it exists as a foreign key in this one. </p>

    </div>

    <h3 class="h1" id="calibre_link-221"><a id="calibre_link-65" class="calibre6"></a>The Execute SQL Tab</h3>

    <p class="h2_body">The Execute SQL tab is where you write your SQL statements. There are three main component window panes in the execute SQL tab: the <span class="bold-italic">Query Pane</span>, the <span class="bold-italic">Results Pane</span>, and the <span class="bold-italic">Messages Pane</span>. Let’s explore these three panes by writing the following SQL code into the Query Pane, as seen in Figure 29:</p>

    <pre class="code-wrap">SELECT
	*
FROM 
	albums;</pre>

    <p class="h2_body">This SQL statement selects all fields (the * symbol designates “all fields”) from the <span class="italic">albums</span> table and, once you press the play button above the Query Pane, displays the fields, and data in those fields, in the Results Pane below.</p>

    <p class="h2_body">As seen in Figure 29, the Play button to the left executes all SQL statements written in the window. The Play button to the right executes only the SQL statement that your cursor is on (it executes only one statement at a time). </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000043.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Since we are starting off with basic queries, we are only going to be running one SQL statement at a time. More advanced queries can use multiple statements executed at the same time. The ability to execute statements individually is valuable in multi-statement queries. If you have only one complete SQL statement in the Execute Pane, then these Play buttons essentially do the same thing. </p>

    </div>

    <p class="h2_body">The Results Pane lists the output generated by our query. If we have more results than can be viewed on the screen at one time (Figure 30), the browser provides us with a scroll bar to navigate down through all the results. </p>

    <p class="h2_body">There is another way to determine if what we see on the screen (in this case only five results), represents the entire query or if there is more data available. Under the Results Pane is the Messages Pane, which displays informative messages about our query. </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">The number of rows returned from our SQL statement</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How much time our query or SQL statement took to run</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Error messages, if our SQL statement contained errors</p>

      </li>

    </ul>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000076.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000095.jpg" />

    </figure>

    <p class="h2_body">The first thing we see is that our query returned 347 rows of data. If we did not notice the scroll bar, then this message would serve as our notification to scroll down. The second thing we observe is that our query was returned in 9 milliseconds (abbreviated as 9ms). You may wonder why it is valuable to see how much time it takes to process a query. In this case, it doesn’t really tell us anything. However, in larger databases with more advanced queries, it can take much longer to return data. The length of time it takes also depends on how a database is optimized and structured. We will talk more about database structure in chapter 6 when working with multiple tables. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The Messages Pane is also the location where any error messages will be displayed. If your query does not execute correctly, check the Messages Pane.</p>

    </div>

    <h3 class="h1" id="calibre_link-222"><a id="calibre_link-66" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">You have reached the first Data Analysis Checkpoint in this book! These checkpoints will be at the end of every remaining chapter. This is a good time to practice what you have learned so far.</p>

    </div>

    <p class="h2_body">Using the Database Structure tab and the Browse Data tab, try to answer the following questions:</p>

    <ol class="calibre10">

      <li class="numbered">How many tables are in our database?</li>

      <li class="numbered">How many fields does the table named <span class="italic">tracks</span> have?</li>

      <li class="numbered">What are some of the data types in this table?</li>

      <li class="numbered">What does the actual data look like in the table?</li>

    </ol>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">The answers to these Data Analysis Checkpoints are at the end of the book in Appendix I.</p>

    </div>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">DB Browser for SQLite, the chosen software for this text, opens like any other computer software program.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Selecting the Open Database button will allow you to select a database file from your computer to open.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Investigate the structure of the database file with the Database Structure tab.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Use the Browse Data tab to view individual records in the table you select with the provided drop-down menu.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Use the Execute SQL tab to write and then execute your first SQL statement.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The Results Pane contains the data returned by your query.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The Messages Pane contains information about your query including how many rows were returned, how long the query took to run, and any applicable error messages.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div class="calibre1" id="calibre_link-11">

  <section type="part" id="calibre_link-223" class="calibre2">

    <figure class="vertical-image-wrap" type="z3998:figure">

      <img alt="PART II - WRITING SQL STATEMENTS" class="portrait" src="images/000079.jpg" />

    </figure>

  </section>

</div>



<div id="calibre_link-5" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-224"><a id="calibre_link-67" class="calibre6"></a>| 4 | </h2>

    <p class="chapter-title" id="calibre_link-225"><a id="calibre_link-226" class="calibre6"></a>Getting Started with Queries</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Query notation techniques</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">SQL query basics</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Using an alias</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Sorting results alphabetically</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Limiting query results</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">SQL is a powerful and robust language that offers the user a wide variety of commands. Although there are more commands than we could ever show in this book, there are a few simple and easy-to-use commands that we can start experimenting with immediately. This chapter will cover the basics of writing a good query and formatting the results. By the end of this chapter you will be able to select individual fields from a specific database and display those fields in alphabetical order. Let’s get started! </p>

    <h3 class="h1" id="calibre_link-227"><a id="calibre_link-68" class="calibre6"></a>Adding Comments to Queries</h3>

    <p class="h2_body">Before we begin composing our first SQL query, we will take a look at creating comments. Comments are plain English sentences used to help add insight and authoring information about SQL statements that you create. It is considered an industry best practice to use comments in your SQL queries; they help both the SQL author and those that come after the author to quickly gain understanding and context regarding the intention and function of the given SQL statement.</p>

    <p class="h2_body">There are two ways to create a comment. Preceding anything written in the Query Pane with two hyphens (--) creates a comment on that line. Our example shows a comment created on line 1 (Figure 32).</p>

    <p class="h2_body">A comment block is a multi-line comment. It is created using the front slash and star symbols to open the block /*, followed by a star and a front slash */, which closes the block. Anything that falls between the opening and closing symbols becomes part of the comment (Figure 33).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000113.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000132.jpg" />

    </figure>

    <p class="h2_body">Our example shows some standard information that is very useful to include in a comment block. The author, date, and description provide significant value to anyone who encounters the SQL query or script.  </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000030.png" />

      </figure>

      <p class="note"><span class="demi">Comments are often overlooked completely in SQL texts.</span> We omit comments in future chapters for the sake of brevity only. When working with real-world databases, preexisting comments have saved me a lot of time that I would have otherwise spent writing additional queries to figure out how the database functioned. Comments become especially important when your queries will be read or used by others. </p>

    </div>

    <h3 class="h1" id="calibre_link-228"><a id="calibre_link-69" class="calibre6"></a>The Structure of a Basic Query</h3>

    <p class="h2_body">Writing a query is like asking a question in any natural language. The phrasing matters, the details matter, and the order of the words matters. The more detailed our question is, the more precise our answer will be. </p>

    <p class="h2_body">In the creation of an SQL query, we need to consider the following five questions:</p>

    <ol class="calibre10">

      <li class="numbered">What database are we speaking to?</li>

      <li class="numbered1">What table within that database are we requesting data from?</li>

      <li class="numbered1">What fields within that table are we interested in?</li>

      <li class="numbered1">Do we want to exclude any data, filter or omit any range or time period? </li>

      <li class="numbered2">In one concise sentence, what does our query do?</li>

    </ol>

    <p class="h2_body">The purpose of the foregoing questions is to help us build a bridge between the natural language we use every day and the language of SQL. If you are employed as a data analyst, you will be asked normal questions from your boss or coworkers about the business. You will have to convert these plain-language questions into SQL statements in order to answer them. After you have received the results of your query, you will then have to convert those results back into natural language that is accessible to all. Such is the nature of the job. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If you are having trouble with a query, refer to the five questions above. Contemplating these questions will help you write your query. </p>

    </div>

    <h3 class="h1" id="calibre_link-229"><a id="calibre_link-70" class="calibre6"></a>Start Writing Your Query</h3>

    <p class="h2_body">To begin writing your first query, you can use the existing Execute SQL tab labeled “SQL 1” or start a new Query Pane tab, in the same way that you would open a new web browser tab. Click on the “Open Tab” icon.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000150.jpg" />

    </figure>

    <p class="h2_body">With our new Query Pane opened, the first thing we will write is a comment block:</p>

    <pre class="code-wrap">/*
CREATED BY: &lt;your name&gt;
CREATED ON: &lt;date&gt;
DESCRIPTION: &lt;A concise description of your query, 
i.e., question #5&gt;
*/</pre>

    <p class="h2_body">After finishing our comment block, we can begin to write our first SQL statement. But to do that, we need a good question to answer. In chapter 2, we introduced the concept of an operational scenario for this book: imagining yourself as a data analyst for the fictional company sTunes. As you have seen from exploring the sTunes database in chapter 3, sTunes sells online music and has a digital library of artists, tracks, and albums and a list of customers who have purchased these songs. Let’s say sTunes customer service wants to send a new promotional advertisement to all existing customers. Customer service wants to know if their customer contact list is up to date, so they ask us if we can get a complete list of first names, last names, and customer email addresses (if available) from the database. How would we go about answering this question? Let’s start by answering the questions listed earlier in the chapter.</p>

    <p class="h3_body-sa"><span class="bold">1.	What database are we speaking to?</span></p>

    <p class="h3_body">In this case, we are dealing with only one database. The sTunes database should already be opened in DB Browser. If you have closed the browser since working through chapter 3, you may need to open it and the sTunes database file again.</p>

    <p class="h3_body-sa"><span class="bold">2.	What table within that database are we requesting data </span><span class="codebold">FROM</span><span class="bold">?</span></p>

    <p class="h3_body">We are looking for customer information. Browsing our Database Structure tab, we can see that we have a table named customers. That table looks promising.</p>

    <p class="h3_body-sa"><span class="bold">3.	What fields within that table are we </span><span class="codebold">SELECT</span><span class="bold">ing to display?</span></p>

    <p class="h3_body">This question can be answered by our Browse Data tab. If we click on that tab and select the customers table in our drop-down menu, we see that it has fields for first name, last name, and email.</p>

    <p class="h3_body-sa"><span class="bold">4.	Do we want to exclude any data, filter or omit any range or time period?</span> </p>

    <p class="h3_body">In this case, sTunes customer service wants a list of all customers, so we’d better not omit anything.</p>

    <p class="h3_body-sa"><span class="bold">5.	In one concise sentence, what does our query do?</span></p>

    <p class="h3_body">This query selects the first name, last name, and email address from the customers table.</p>

    <p class="h2_body-sa">After adding your comment block, start by typing <span class="code">FROM</span> <span class="code">customers</span>. This tells your query what table to look in for its data. Then type the keyword <span class="code">SELECT</span> above the <span class="code">FROM</span> clause, followed by the names of the fields within the <span class="italic">customers</span> table that you wish to view. Each field name is separated by a comma. The comma tells SQL to expect another field. The resulting code should look like this:</p>

    <pre class="code-wrap">/*
CREATED BY: Walter Shields 
CREATED ON: 3/13/2018
DESCRIPTION: This query selects the first name, 
last name, and email from the customers table.
*/</pre>

    <pre class="code-wrap">SELECT 
	FirstName,
	LastName,
	Email
FROM 
	customers;</pre>

    <p class="h2_body">After composing this SQL query, run the statement by clicking on the Execute SQL play button in the menu bar. The results of the query are displayed in the Results Pane below (Figure 35). The Messages Pane also shows that the query returned 59 rows (aka records) in 3 milliseconds.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000166.jpg" />

    </figure>

    <p class="h2">ON YOUR OWN: </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Add another field from the <span class="italic">customers</span> table to this query. Try adding the <span class="code">Company</span> or <span class="code">Phone</span> field to our sTunes mailing list. Don’t forget to add an extra comma!</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-230"><a id="calibre_link-71" class="calibre6"></a>Coding Syntax Versus Coding Convention</h3>

    <p class="h2_body">As we mentioned in chapter 1, all queries must conform to a certain syntax in order to be understood by the SQL browser. When writing queries, there is much more to take into consideration than just making sure the SQL browser can understand you. It is also important that other database users can understand and follow your queries. The practice of writing queries in a standardized, readable, and consistent way is known as <span class="bold-italic">coding convention</span>. Coding conventions vary in different database environments. This section will explain the coding conventions used in this book.</p>

    <p class="h2_body">In earlier examples of queries, we used a * symbol after our <span class="code">SELECT </span>keyword (in lieu of specifying individual fields). This special symbol tells the SQL browser to retrieve and display all fields in a table. Although this symbol is useful in some circumstances, in most cases it is a best practice to determine which fields you specifically want to select and call out those fields by name.</p>

    <p class="h2_body">The semicolon at the end of the statement is optional in this case, since we are only writing one single SQL statement. The semicolon denotes the end of an SQL statement. Since most of the SQL queries we will be writing in this book are single statements, we will be omitting the semicolon from this point forward.</p>

    <p class="h2_body">In the <span class="code">SELECT</span> clause, we have chosen three fields to display. We must separate every field with a comma (except for after the last field). Omitting a comma between fields or adding a comma after the last field are both common syntax mistakes that will result in a syntax error appearing in your query Results Pane.</p>

    <p class="h2_body">Notice that the code is broken up on multiple lines. We could write the entire query all on one line and the SQL browser would still recognize the code and return results. But it is a best practice to separate queries into clauses with the content of each clause indented on a new line. Later in this text, our queries will become much longer and will contain many more clauses. Organizing our queries with indents and spacing increases readability and helps others to follow along.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">A clause is a subsection of an SQL statement that starts with a special SQL keyword (<span class="code">SELECT</span>, <span class="code">FROM</span>, etc.) and may include additional parameters and operators.</p>

    </div>

    <h3 class="h1" id="calibre_link-231"><a id="calibre_link-72" class="calibre6"></a>Adding an Alias to Your Columns </h3>

    <p class="h2_body">Often the technical language of the database will differ from the common language of a business. Sometimes you will be working with old databases or those that have not had their field names updated in a while. If you apply an <span class="bold-italic">alias</span> to a field name (in order to describe the data in a way your coworkers are more likely to understand), any report you deliver will make much more sense to both you and anyone else reading along. Using aliases is also helpful if you want to clean up the column names and make your query output more readable or aesthetically pleasing.</p>

    <p class="h2_body">In the following example, we will demonstrate several different ways to create an alias for selected field names from our <span class="italic">customers</span> table. An alias is always listed directly after the name of a field from our database. Aliases are commonly associated with the <span class="code">AS</span> keyword, however, the use of the <span class="code">AS</span> keyword between the field name and the alias name is optional in most RDBMS implementations.</p>

    <pre class="code-wrap">/* 
CREATED BY: Walter Shields 
CREATED ON: 3/13/2018
DESCRIPTION: This query selects the first name, last name, email, and phone number fields from the customers table and demonstrates four different ways to create an alias. 
*/</pre>

    <pre class="code-wrap">SELECT 
	FirstName AS 'First Name',
	LastName AS [Last Name],
	Email AS EMAIL
	Phone CELL
FROM 
	customers</pre>

    <p class="h2_body">As seen in the preceding query, we used the <span class="code">AS</span> keyword for the first three fields, then omitted this keyword for the <span class="code">Phone</span> field, which we renamed to <span class="code">CELL</span>. If the alias you create contains multiple words (such as First Name and Last Name), it needs to be surrounded with some sort of demarcation, in this case either single quotes '' or square brackets <span class="code">[]</span> as shown. Since the aliases <span class="code">EMAIL</span> and <span class="code">CELL</span> are single words, they don’t need any quotations or brackets.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">SQL allows a great deal of variation in alias syntax. Other RDBMSs may not recognize every aliasing method listed here. If you get a syntax error when running your query, check to see how you designated your alias. </p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000021.jpg" />

    </figure>

    <p class="h2_body">As you can see in Figure 36, the output on the left leaves the field names unchanged. The output on the right shows how our aliases modified the column names. Adding an alias will not change the data in the database. Aliases only alter how fields are displayed in the Results Pane. </p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Add another field to this query and give it an alias. </p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Practice changing the alias syntax and omitting the <span class="code">AS</span> keyword entirely. Does this have any effect on your output?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Avoid using any existing SQL keywords as your alias names. Using existing keywords could cause confusion, generate syntax errors, or cause the RDBMS to interpret your alias as a command instead. </p>

    </div>

    <h3 class="h1" id="calibre_link-232"><a id="calibre_link-73" class="calibre6"></a>Using the <span class="h3heading_code">ORDER</span> <span class="h3heading_code">BY</span> Clause </h3>

    <p class="h2_body">In our fictional scenario, we are providing a list of customers to sTunes customer service. It might be useful to order our results by the last name of our customers. To sort our results by customer last name, we need to use a new clause after our <span class="code">FROM</span> clause. The <span class="code">ORDER</span> <span class="code">BY</span> clause allows us to sort our query results by any field(s) we choose. The default sort order is ascending, A to Z. The special keyword <span class="code">ASC</span>, which specifies ascending order, is optional. To sort in descending order (Z to A), we would add the keyword <span class="code">DESC</span> after the field being sorted. <span class="code">ORDER</span> <span class="code">BY LastName DESC</span> would sort the aliased column <span class="code">FirstName</span> in descending order. </p>

    <pre class="code-wrap">/*
CREATED BY: Walter Shields 
CREATED ON: 3/13/2018
DESCRIPTION: This query selects the first name, last name, and email from the customers table, ordered by Last Name. 
*/</pre>

    <pre class="code-wrap">SELECT 
	FirstName AS [First Name],
	LastName AS [Last Name],
	Email AS [EMAIL]
FROM 
	customers
ORDER BY 
	LastName ASC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000050.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Without <span class="code">ORDER</span> <span class="code">BY</span>, every query will return data in the order that it was initially saved in the table.</p>

    </div>

    <p class="h2_body">We can use the <span class="code">ORDER</span> <span class="code">BY</span> clause to sort by multiple columns as well. In this example, we will sort by first name (ascending), and then by last name (descending). This will require us to list two fields in our <span class="code">ORDER</span> <span class="code">BY</span> clause. Just like with the <span class="code">SELECT</span> clause, when listing multiple fields, we must separate them by commas.</p>

    <pre class="code-wrap">/*
CREATED BY: Walter Shields 
CREATED ON: 3/13/2018
DESCRIPTION: This query selects the first name, last name, and email from the customers table, ordered by first name (ascending), then last name (descending). 
*/</pre>

    <pre class="code-wrap">SELECT 
	FirstName AS [First Name],
	LastName AS [Last Name],
	Email AS [EMAIL]
FROM 
	customers
ORDER BY 
	FirstName ASC,
	LastName DESC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000067.jpg" />

    </figure>

    <p class="h2_body">When we run this query and look at the customer first names starting with <span class="italic">D</span>, we can see that first names are in ascending order and last names are in descending order. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If you use the <span class="code">ORDER</span> <span class="code">BY</span> statement on a column where some of the corresponding rows have empty values, you will see those values show up as <span class="code">NULL</span> at the very top if you are using ascending order.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Rearrange the fields in the <span class="code">SELECT</span> clause so that <span class="code">LastName</span> is the first column instead of the second. Order the output by <span class="code">LastName</span>. Does this make the list more readable?</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-233"><a id="calibre_link-74" class="calibre6"></a>Selecting the Top Ten Records Using <span class="h3heading_code">LIMIT</span></h3>

    <p class="h2_body">In our queries so far, we have returned every record available from the <span class="italic">customers</span> table. Although we have limited our records to three fields, and sorted those fields, we can see in our Messages Pane that we are returning 59 rows every time. If we are not interested in seeing all 59 records, we can limit our results to a specified number of rows. This is often helpful when sorting queries by a number (which we will demonstrate later), like highest price or largest sale. Adding the keywords <span class="code">LIMIT</span> <span class="code">10</span> after the <span class="code">ORDER</span> <span class="code">BY</span> clause returns only the first ten records from the query in the sort order you specify. This number can be changed to any number you wish to limit your results by (provided there are at least that many records in the table).</p>

    <pre class="code-wrap">/*
CREATED BY: Walter Shields 
CREATED ON: 3/13/2018
DESCRIPTION: This query selects the first 10 records from the customers table, ordered by first name (ascending), then last name (descending).
*/</pre>

    <pre class="code-wrap">SELECT 
	FirstName AS [First Name],
	LastName AS [Last Name],
	Email AS [EMAIL]
FROM 
	customers
ORDER BY 
	FirstName ASC,
	LastName DESC
LIMIT 10</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000084.jpg" />

    </figure>

    <p class="h2_body">As we can see in Figure 39, our Messages Pane now says “10 rows returned in 1ms.” The query performs the <span class="code">ORDER</span> <span class="code">BY</span> operation first and then applies the limit. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">There is no requirement to use <span class="code">LIMIT</span> with <span class="code">ORDER</span> <span class="code">BY</span>. In many cases, it makes sense to order your results by certain criteria before you limit them. If you do not use the <span class="code">ORDER</span> <span class="code">BY</span> clause, the results of the <span class="code">LIMIT</span> statement will be returned to you in the order they were originally added to the table. </p>

    </div>

    <h3 class="h1" id="calibre_link-234"><a id="calibre_link-75" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">How many customers’ last names begin with <span class="italic">B</span>?</li>

      <li class="numbered">When sorted in descending order, which company appears at the top in the <span class="italic">customers</span> table?</li>

      <li class="numbered">How many customers do not have a postal code listed?</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="bull">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Adding comments to queries is considered a best practice. A basic comment block can include your name, the date the query was created, and a brief description of what the query does. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">When composing a query, it is helpful to phrase what you want in a natural language first, then decide what keywords and clauses you need.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">A basic query usually begins with a <span class="code">SELECT</span> clause that specifies what fields to display from the table specified in the <span class="code">FROM</span> clause.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">An alias used after the <span class="code">AS</span> keyword can rename or reformat the field names in your query results. This change is only cosmetic and does not affect the data in the database.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Using <span class="code">ORDER</span> <span class="code">BY</span> allows you to sort alphabetically by field(s), either in ascending (ASC) or descending (DESC) order.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">You can limit the number of results returned by using <span class="code">LIMIT</span> after your <span class="code">ORDER</span> <span class="code">BY</span> clause. You must include the number of results you wish to show.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-26" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-235"><a id="calibre_link-76" class="calibre6"></a>| 5 | </h2>

    <p class="chapter-title" id="calibre_link-236"><a id="calibre_link-237" class="calibre6"></a>Turning Data into Information</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Operators in SQL</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The <span class="code">WHERE</span> clause</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Searching for text using wildcard values </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The <span class="code">DATE()</span> function</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Using <span class="code">OR</span> and <span class="code">AND</span> together</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The <span class="code">CASE</span> statement</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">At this point in our study, using a basic <span class="code">SELECT</span> statement query, we can return any set of fields from a database table and see that data ordered by the field of our choice. Displaying and ordering fields is a valuable first step in our learning journey, but we need more precise tools so that we can ask more specific questions. In the previous chapter’s Data Analysis Checkpoint, we asked you how many customers’ last names began with <span class="italic">B</span>. If you did the exercise, you noticed that the query didn’t return very many names. It was easy, in this case, to sort the data alphabetically by last name and then just manually count the names ending in <span class="italic">B</span>. But what if our database was much larger and contained a million customers? Would you really want to manually count all the <span class="italic">B</span> names? Fortunately, SQL provides some tools that not only allow us to narrow down our <span class="bold-italic">result set</span> (that is, the results of our query) to very specific data, but also to order and filter our data by user-specified conditions. Let’s see what these new statements can do!</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">From this point on in the text, we will not be showing screen captures of the DB Browser output (unless we are specifically referring to a feature of the browser). Instead, we will be showing the output of our queries in tabular form (Figure 40).</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000119.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-238"><a id="calibre_link-77" class="calibre6"></a>Comparison, Logical, and Arithmetic Operators</h3>

    <p class="h2_body"><span class="bold-italic">Operators</span> are special keywords in SQL that we use in conjunction with SQL clauses to compare the values of fields, select subsets of fields, or perform arithmetic operations. Unlike the keywords we have explored already, such as <span class="code">SELECT</span>, operators cannot exist as their own SQL clause but must be used with other clauses such as the <span class="code">SELECT</span> clause and the <span class="code">WHERE</span> clause (which we will explore in this chapter). Figure 41 shows the three types of operators we will use in this chapter.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000138.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">These different types of operators can be combined to make more complex queries. Combining different types of operators allows us to search for ranges of data or create unique conditions. There are many more options than we can list in this chapter, but we will go over some of the more common ones.</p>

    </div>

    <p class="h2_body">In the following example, we can see arithmetic operators being used in conjunction with the <span class="code">SELECT</span> clause to augment the value of a field called <span class="code">Total</span> from the sTunes <span class="italic">invoices</span> table. Arithmetic operations are useful when we need to add taxes, surcharges, or other modifications to numeric data.</p>

    <pre class="code-wrap">SELECT 
	Total AS [Original Amount],
	Total + 10 AS [Addition Operator],
	Total - 10 AS [Subtraction Operator],
	Total / 10 AS [Division Operator],
	Total * 10 AS [Multiplication Operator],
	Total % 10 AS [Modulo Operator]
FROM 
	invoices
ORDER BY
	Total DESC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000156.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Using the example query above, show the <span class="code">Total</span> field from <span class="italic">invoices </span>with a 15 percent tax added.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-239"><a id="calibre_link-78" class="calibre6"></a>Filtering Records by Numbers with the <span class="h3heading_code">WHERE</span> Clause</h3>

    <p class="h2_body">Other than <span class="code">SELECT,</span> the most common place we will encounter operators is in the <span class="code">WHERE</span> clause. The <span class="code">WHERE</span> clause allows us to add specific conditions to our queries. Using <span class="code">WHERE</span>, we can limit the results of our queries so that only data that satisfies our conditions appears in our result set. Some common types of data we can filter for include numbers, text, and dates. In order to filter records to return specific data, we use the <span class="code">WHERE</span> clause in conjunction with operators.</p>

    <p class="h2_body">In the following example, let’s imagine the sales department from our fictional sTunes company asked us a question like “How many customers purchased two songs at $0.99 each?” How would we go about answering that question? In the chapter 3 Data Analysis Checkpoint, we looked at the <span class="italic">tracks</span> table. We observed that our company sells individual songs for both $0.99 and $1.99, as we can see in Figure 43.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000172.jpg" />

    </figure>

    <p class="h2_body">If we look in the <span class="italic">invoices</span> table, as shown in Figure 44, we can see the total price of customer orders in the <span class="code">Total</span> field.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000007.jpg" />

    </figure>

    <p class="h2_body">If we wanted to see how many customers purchased just two $0.99 songs, we would look in the <span class="italic">invoices</span> table for total amounts of $1.98, which would represent two songs.</p>

    <p class="h2_body">Using the tools we learned in the last chapter, we could write a query that selects all invoices and then orders them by total, but that would require us to manually count. Instead, we can insert a <span class="code">WHERE</span> clause between the <span class="code">FROM</span> and <span class="code">ORDER</span> <span class="code">BY</span> clauses to search for only those totals that equal $1.98. In conjunction with the total, adding a few other fields, such as invoice date and address, will help identify each invoice. Adding in all these clauses yields the following:</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	Total = 1.98
ORDER BY
	InvoiceDate</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000022.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The <span class="code">WHERE</span> clause always comes<span class="italic1"> after</span> the <span class="code">FROM</span> but <span class="italic1">before</span> the <span class="code">ORDER</span> <span class="code">BY</span>. In the example above, the <span class="code">WHERE</span> clause is added to return all invoices that are equal to 1.98. The = sign is referred to as a comparison operator.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <p class="h3_body">Using comparison operators, try out the following queries:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Write a query that returns all invoices that are greater than 1.98.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Write a query that returns all invoices that are greater than or equal to 1.98.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Write a query that returns all invoices that are not 1.98.</p>

      </li>

    </ul>

    <p class="h2_body">Logical operators are also very useful. They can help you write more complex and specific queries that would be harder to accomplish with comparison operators. Let’s say you were asked to find out how many invoices existed inside a certain range, such as between $1.98 and $5.00.</p>

    <p class="h2_body">A good way to accomplish this is with the <span class="code">BETWEEN</span> operator. The <span class="code">BETWEEN</span> operator returns a range of values. The <span class="code">AND</span> operator is used in conjunction with the <span class="code">BETWEEN</span> operator to span the range of values we want to see in our result set. Our example below returns the range of invoices that fall between 1.98 and 5.00.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	Total BETWEEN 1.98 AND 5.00
ORDER BY
	InvoiceDate</pre>

    <p class="h2_body">As we can see with the first ten results of this query (Figure 46), the invoice totals we returned in our dataset are all between $1.98 and $5.00. The <span class="code">BETWEEN</span> operator is inclusive of the parameters you give it. In other words, in the prior example, it would include any values that equaled 1.98 and 5.00. Using comparison operators, you could write <span class="code">Total &gt;= 1.98 AND Total &lt;= 5.00 </span>in your <span class="code">WHERE</span> statement to achieve the same effect, but <span class="code">BETWEEN</span> would be simpler.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Although we are using the <span class="code">AND</span> operator with <span class="code">BETWEEN</span> in the preceding example, the <span class="code">AND</span> operator has a much more extensive role as a logical operator and will be covered later in this chapter.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000038.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Order the previous query by the <span class="code">Total</span> field. What is the highest invoice amount in this dataset?</p>

      </li>

    </ul>

    <p class="h2_body">Yet another useful operator is the <span class="code">IN</span> operator, which is used to find a list of precise values. In our previous example, the <span class="code">BETWEEN</span> operator returned every value in our <span class="italic">invoices</span> table that fell between 1.98 and 5.00. The <span class="code">IN</span> operator allows us to find specific values within a dataset. The values are separated by a comma and wrapped in parentheses. This query returns only the invoice amounts that are exactly $1.98 or $3.96 (Figure 47).</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	Total IN (1.98, 3.96)
ORDER BY
	InvoiceDate</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000055.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">With the = operator, we can find only one value. With the <span class="code">IN </span>operator, we can add as many values, separated by commas, as we need. We can also use the <span class="code">IN</span> operator with text, as we will see in the following section.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How many records does the query above return?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Write a query that lists all invoices that are $13.86, $18.86, and $21.86.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-240"><a id="calibre_link-79" class="calibre6"></a>Filtering Records by Text</h3>

    <p class="h2_body">We can also use operators to return specific text, in a way similar to what we have done with numbers. Let’s look at an example with comparison operators. We will answer the question: How many invoices were billed to Tucson?</p>

    <p class="h2_body">To answer this question, we will structure our <span class="code">SELECT</span> statement like we did for invoice totals, except this time we will focus on the billing city in our <span class="code">WHERE</span> clause. The following query returns all invoices that have been billed in the city of Tucson:</p>

    <pre class="code-wrap">  SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	BillingCity = 'Tucson' 
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000071.jpg" />

    </figure>

    <p class="h2_body">In this result set, we see that we have only seven invoices from Tucson.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">When using text as criteria in the <span class="code">WHERE</span> clause, the text value(s) we specify must be surrounded by single quotes (<span class="code">BillingCity = 'Tucson'</span>).</p>

    </div>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We are using = in the preceding example because we are looking for one value. If we wanted to search for multiple cities, we could use the <span class="code">IN</span> operator similar to how we used it to retrieve numerical values.</p>

    </div>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	BillingCity IN ('Tucson', 'Paris', 'London') 
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000090.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-241"><a id="calibre_link-80" class="calibre6"></a>Using the <span class="h3heading_code">LIKE</span> Operator to Search for Wildcards</h3>

    <p class="h2_body">In previous examples, we have used the = operator to search for exactly the text we are looking for. SQL also allows us to search for parts of a text value using the <span class="code">LIKE</span> operator. This is particularly useful when we are not certain how a text value is spelled in a database. Also, there may be cases where a text value is not spelled correctly in our database. If we were to look for all invoices that were billed in cities that start with <span class="italic">T,</span> the criteria in our <span class="code">WHERE</span> clause would need to be changed to accommodate this type of search.</p>

    <p class="h2_body">What makes the <span class="code">LIKE</span> operator so useful is its use of wildcard characters, which are represented by “%,” also called the percent symbol. What follows the = sign is the only value you can expect to see in your result set. With the <span class="code">LIKE</span> and wildcard, you can find variations on your input.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Wildcard characters will always be enclosed in single quotation marks. Without quotation marks, % is an arithmetic operator known as modulo, as shown earlier in this chapter in the table of operators. Text searches are not case-sensitive. A lowercase <span class="italic1">t</span> and an uppercase <span class="italic1">T </span>will return the same results.</p>

    </div>

    <p class="h2_body">A wildcard symbol represents any number of any type of characters. As used in the example below, the query will search for any invoices that were billed in cities that start with <span class="italic">T</span>. Our results show that both Toronto and Tucson are now included.
SELECT 
		InvoiceDate,
		BillingAddress,
		BillingCity,
		Total
FROM 
		invoices
WHERE 
		BillingCity LIKE 'T%' 
ORDER BY
		Total</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000125.jpg" />

    </figure>

    <p class="h2_body">Adding another percent symbol before the <span class="italic">T</span> would change the search to any invoice whose billing city has a <span class="italic">T</span> anywhere in it.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	BillingCity LIKE '%T%' 
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000144.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">This of course does not exclude cities that begin or end with lowercase <span class="italic1">t</span>. The % can represent any letter(s) at all, including <span class="italic1">t</span>.</p>

    </div>

    <p class="h2_body">The <span class="code">LIKE</span> operator can also be used to exclude results that match specified criteria. By placing the <span class="code">NOT</span> keyword in front of <span class="code">LIKE</span>, you can exclude records from your query result.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	BillingCity NOT LIKE '%T%' 
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000160.jpg" />

    </figure>

    <p class="h2_body">We can see from these examples that there are many helpful ways to use the wildcard operator. Here are a few of the most common:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000177.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">A good way to think about the wildcard is to treat the % symbol as “whatever else.” For example, when you specify '<span class="code">%T%</span>' you are saying “I don’t care what comes before or after, as long as there is a <span class="italic1">T</span> somewhere in that string of text that isn’t in the first or last position.”</p>

    </div>

    <h3 class="h1" id="calibre_link-242"><a id="calibre_link-81" class="calibre6"></a>Filtering Records by Date</h3>

    <p class="h2_body">Taking what we learned about both numbers and text, we can also search for invoices on a specific date. Look at the following example:</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	InvoiceDate = '2009-01-03 00:00:00'
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000011.jpg" />

    </figure>

    <p class="h2_body-sa">Note the way we wrote the date. When querying for dates, it is important to first take a look at how the date is stored in the table you are querying. As we learned in chapter 1, to do this we visit the Browse Data tab and select the <span class="italic">invoices</span> table and observe the format in which the <span class="code">InvoiceDate</span> column stores dates. In our sample database, dates are stored as yyyy-mm-dd 00:00:00. Next, let’s go to the Database Structure tab and look at the <span class="code">InvoiceDate</span> field of the <span class="italic">invoices</span> table. We can see in the Type column that this field stores dates in a data type called <span class="code">DATETIME</span>.</p>

    <p class="h2_body">When used in the <span class="code">WHERE</span> clause, dates are surrounded by single quotes just as text is. When querying with dates, use the same operators used when querying with numbers: <span class="code">=</span>, <span class="code">&gt;</span>, <span class="code">&lt;</span>, <span class="code">BETWEEN</span>, etc.</p>

    <p class="h2">ON YOUR OWN: </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Get all invoices that were issued between January 1, 2009, and December 31, 2009.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Find the top 10 highest value invoices that occurred after July 5, 2009.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-243"><a id="calibre_link-82" class="calibre6"></a>The <span class="h3heading_code">DATE()</span>Function</h3>

    <p class="h2_body">When working with dates in SQL, we have access to a number of functions that help us obtain more refined results by specifying parts of a date we are interested in. We saw in our previous example that the <span class="code">InvoiceDate</span> column of the <span class="italic">invoices</span> table is defined as a <span class="code">DATETIME</span> data type. Therefore, when we were specifying a date value in our <span class="code">WHERE</span> clause, we needed to include the time portion of it (2009-01-03 00:00:00). The <span class="code">DATE()</span> function allows us to exclude the time when specifying our date criteria.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	DATE(InvoiceDate) = '2009-01-03'
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000027.jpg" />

    </figure>

    <p class="h2_body">The result of this query is identical to that of the query before it. However, using the <span class="code">DATE()</span> function saves us a bit of time in typing our query when the time information is either blank or not relevant. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">There are many functions available in SQL. The <span class="code">DATE()</span> function is particularly useful when using the <span class="code">WHERE</span> clause to sort records by date. In chapter 7, we will explore using other functions in our queries in a more comprehensive way. </p>

    </div>

    <h3 class="h1" id="calibre_link-244"><a id="calibre_link-83" class="calibre6"></a>Using the <span class="h3heading_code">AND</span> and <span class="h3heading_code">OR</span> Operators with Two Separate Fields</h3>

    <p class="h2_body">So far in this chapter, we have only used operators to select a subset of one field. For example, we have used the <span class="code">AND</span> operator with the <span class="code">BETWEEN </span>operator to filter results from the <span class="code">Total</span> field between two different numerical values. We can also use the <span class="code">AND</span> and <span class="code">OR</span> operators to specify criteria from multiple fields. The query below uses the <span class="code">AND</span> together with the <span class="code">DATE</span> function to find all invoices after 2010-01-02 with a total of less than $3.00. The result of this query must satisfy both conditions: (<span class="code">DATE(InvoiceDate) &gt; '2010-01-02' AND Total &lt; 3</span>).</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	DATE(InvoiceDate) &gt; '2010-01-02' AND Total &lt; 3
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000044.jpg" />

    </figure>

    <p class="h2_body">We can see from our results that only invoices after the second of January 2010, whose total is under $3.00, are returned.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">You can add additional <span class="code">AND</span> operators to search for additional criteria. As with the <span class="code">IN</span> operator, you are not limited to only two values. </p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Find all invoices whose billing city starts with <span class="italic">P</span> and whose total is greater than $2.00.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-245"><a id="calibre_link-84" class="calibre6"></a>The <span class="h3heading_code">OR</span> Operator</h3>

    <p class="h2_body">The <span class="code">OR</span> operator allows you to find the records that match <span class="italic">any</span> of the criteria you ask for. The following query searches for all invoices whose billing city starts with <span class="italic">P</span> or starts with <span class="italic">D</span>.</p>

    <p class="h2_body"><span class="code">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	BillingCity LIKE </span><span class="code">'</span><span class="code">p%</span><span class="code">'</span><span class="code"> OR BillingCity LIKE </span><span class="code">'</span><span class="code">d%</span><span class="code">'
ORDER BY
	Total</span></p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000061.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-246"><a id="calibre_link-85" class="calibre6"></a>Using Parentheses with <span class="h3heading_code">AND</span> and <span class="h3heading_code">OR</span> to Specify the Order of Operations</h3>

    <p class="h2_body">When writing longer <span class="code">WHERE</span> clauses that include multiple logical operators, SQL follows an order of operations similar to what is used for basic arithmetic. You may have heard of the acronym PEMDAS (parentheses, exponents, multiplication/division, addition/subtraction) if you live in the United States or BEMDAS (brackets, exponents, etc.) if you live in a country more influenced by the United Kingdom. If you have not heard of either, don’t worry. We have a simple way of handling the order of operations, but for now, let’s look at how a statement functions with both an <span class="code">AND</span> operator and an <span class="code">OR</span> operator. Let’s say we wanted to look at all the invoices over $1.98 from any cities whose names start with <span class="italic">P</span> or <span class="italic">D</span>. We could write the following:</p>

    <pre class="code-wrap"> SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	Total &gt; 1.98 AND BillingCity LIKE 'p%' OR 
	BillingCity LIKE 'd%'
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000077.jpg" />

    </figure>

    <p class="h2_body">There is a slight problem with this query as written. When the query is executed, the SQL browser combines the two conditions immediately on either side of the <span class="code">AND</span> operator first, returning results for invoices whose total is greater than $1.98 <span class="italic">and</span> whose billing cities begin with <span class="italic">P</span>, then it processes the condition to the right of the <span class="code">OR</span> operator completely separately, as if the <span class="code">AND</span> did not exist. In other words, it first looks for the results where <span class="code">Total &gt; 1.98 AND BillingCity LIKE 'p%'</span>, then it looks for all results where <span class="code">BillingCity LIKE 'd%'</span>, then it returns the results for both in ascending order by Total. </p>

    <p class="h2_body">If you have typed the above query into your SQL browser, you will notice that there are results for less than $1.98, but only for cities starting with <span class="italic">D</span>. That is because, in the SQL order of operations, the <span class="code">AND</span> operator is processed first and the <span class="code">OR</span> is processed second. This result isn’t exactly what we originally wanted, but there is an easy way to ensure that the SQL browser processes our query the way we intended, without our having to resort to a logic table.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">SQL processes the <span class="code">AND</span> operator like multiplication and the <span class="code">OR</span> operator like addition, unless you include parentheses. Without parentheses, the <span class="code">AND</span> will be processed in the same way that 3*2+1 would equal 7, but 3*(2+1) would equal 9.</p>

    </div>

    <p class="h2_body">When parentheses are added as shown in the example below, the SQL browser first looks for all the records that satisfy the criteria between the parentheses: (<span class="code">BillingCity LIKE 'p%' OR BillingCity LIKE 'd%'</span>). Then, from within only these records, it looks for records where the total is greater than $1.98 (<span class="code">Total &gt; 1.98</span>).</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total
FROM 
	invoices
WHERE 
	Total &gt; 1.98 AND (BillingCity LIKE 'p%' OR 
	BillingCity LIKE 'd%')
ORDER BY
	Total</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000096.jpg" />

    </figure>

    <p class="h2_body">Writing the query this way ensures that all invoice totals greater than $1.98 are returned from either <span class="italic">P</span> cities or <span class="italic">D</span> cities, which was what we initially wanted.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000030.png" />

      </figure>

      <p class="note">Although it is good to know how SQL processes logical operators, it is better to just use parentheses whenever you are using multiple operators so that it is clear to you, and anyone else who reads your code, what you actually intended. If you would like more practice, try the following exercises both with and without parentheses to see how it affects the result.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Run the query again and observe if there are any values in the <span class="code">Total</span> column that are less than $1.98.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Find all invoices that have total values higher than $3.00 whose billing city starts with <span class="italic">P</span> or <span class="italic">D</span>.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-247"><a id="calibre_link-86" class="calibre6"></a>The <span class="h3heading_code">CASE</span> Statement</h3>

    <p class="h2_body">The <span class="code">CASE</span> statement allows you to create a new, temporary field in your database that serves as a label for your data based on unique user-specified conditions. To better understand the utility of the <span class="code">CASE</span> statement, consider the following scenario from our fictional company, sTunes.</p>

    <p class="h2">Operational Scenario</p>

    <p class="h3_body">The sTunes sales team has a new sales goal. They want as many sTunes customers as possible to spend between seven and fifteen dollars when purchasing music from the sTunes online store. Thus, they have created the following categories: <span class="italic">Baseline Purchase, Low Purchase, Target Purchase,</span> and <span class="italic">Top Performer.</span></p>

    <p class="h3_body">Since the cost of a song varies between $0.99 and $1.99, any invoice total in this range is considered a <span class="italic">Baseline Purchase</span>. Invoice totals between $2.00 and $6.99 are labeled <span class="italic">Low Purchase</span>. Since the target sales goal is between $7.00 and $15.00, any sales in this category are labeled <span class="italic">Target Purchase</span>. Any sale above $15.00 is seen as a <span class="italic">Top Performer</span>.</p>

    <p class="h3_body">Based on these categories, the sTunes sales department wants to see if any information can be gleaned from the database concerning the sales in all of the listed categories.</p>

    <p class="h3_body">We can use a <span class="code">CASE</span> statement to create a new field in our <span class="italic">invoices</span> table called <span class="code">PurchaseType</span>. This will appear alongside the other preexisting fields in our query as if it was just another field in the database.</p>

    <p class="h2">Adding the <span class="h3heading_code1">CASE</span> Statement to a Query</p>

    <p class="h3_body">To add the <span class="code">CASE</span> statement to our query, we must start with a <span class="code">SELECT</span> statement with the preexisting fields we are interested in from the <span class="italic">invoices</span> table. First, we create a simple <span class="code">SELECT</span> statement similar to the type we have used since chapter 4.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total	 
FROM 
	invoices
ORDER BY
	BillingCity</pre>

    <p class="h3_body">For this first example, we are going to order our results by billing city so we can see our sales goals by geographic region.</p>

    <p class="h3_body">To add our <span class="code">CASE</span> statement to this query, we place it at the bottom of the <span class="code">SELECT</span> portion of our query after all the existing fields. We start by adding the keyword <span class="code">CASE</span>, followed by the keyword <span class="code">END</span>. Between these two keywords we start testing for conditions. Each test begins with the keyword <span class="code">WHEN</span>, followed by a logical test, which is similar to what you would add in a <span class="code">WHERE</span> clause. Our first case to test is <span class="italic">Baseline Purchases</span>, which is any invoice under $2.00, in other words <span class="code">"TOTAL &lt; 2.00"</span>. After the logical condition, we then specify what we want to happen if that condition is met. This is done with the <span class="code">THEN</span> keyword. The label we desire for cases under $2.00 is <span class="code">'Baseline Purchase'</span> which is what is specified for our operational scenario.</p>

    <p class="h3_body">This same sequence can be repeated for as many conditions as we want to test. So we repeat this process for the rest of the sales categories mentioned in our operational scenario. The <span class="code">ELSE</span> keyword always follows the last explicit condition listed. Any records that have yet to be categorized will take their assignment from the category named in the <span class="code">ELSE</span> clause.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">The <span class="code">ELSE</span> keyword doesn’t need to be included, but it is good practice to include it. There may be outliers in your data that fall outside of your conditions. The <span class="code">ELSE</span> clause will capture these outliers and you can figure out what to do with them. If you do not include an <span class="code">ELSE</span> clause, any results in your dataset that fall outside of your conditions will be returned as <span class="code">NULL</span>.</p>

    </div>

    <p class="h3_body">The last thing we do is create an alias that will become the name of the new field in our database. This alias will go after our <span class="code">END</span> statement. We will call our new field <span class="code">PurchaseType</span>.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We create aliases using the <span class="code">AS</span> keyword. So our <span class="code">CASE </span>statement terminates with <span class="code">END</span> <span class="code">AS</span> and then the alias name we chose for the new field in our table.</p>

    </div>

    <p class="h3_body">Putting this all together gives us the following (Figure 60):</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total,
	CASE 
	WHEN TOTAL &lt; 2.00 THEN 'Baseline Purchase' 
	WHEN TOTAL BETWEEN 2.00 AND 6.99 THEN 'Low 
	Purchase' 
	WHEN TOTAL BETWEEN 7.00 AND 15.00 THEN 'Target 
	Purchase' 
	ELSE 'Top Performers'
	END AS PurchaseType
FROM 
	invoices
ORDER BY
	BillingCity</pre>

    <p class="h3_body">If we scroll over a bit in our results, we can see that the SQL browser added a new category called <span class="code">PurchaseType</span> and added all our sales goal categories to the data. </p>

    <p class="h3_body">We can see in the result set that all the categories we tested for are represented according to their respective price brackets (<span class="code">PurchaseType</span>).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000133.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Using the <span class="code">ORDER</span> <span class="code">BY</span> clause, we can also order our results by the new field we created, which would show each category of purchase type alphabetically, starting with “Baseline Purchase” and ending with “Top Performers.” We conveniently named these categories to be consistent with increasing purchase price for clarity, but they can be named anything you want them to be.</p>

    </div>

    <p class="h3_body">Now that we have created new categories for our data, there are a lot of useful ways we can manipulate the rest of the <span class="code">SELECT</span> statement to learn more about the demographics of our customers based on our new sales categories.</p>

    <p class="h3_body">Our case statement is written, so we can answer some pertinent questions, including the following:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item1">What cities do our top-performing sales come from?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item1">Are our top-performing sales mainly from the United States or from other parts of the world?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item1">From what cities are the most baseline purchases made?</p>

      </li>

    </ul>

    <p class="h3_body">Let’s take a closer look at the first question. We can modify our existing query with a <span class="code">WHERE</span> clause in order to look only at top performers and order them by city.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total,
	CASE 
	WHEN TOTAL &lt; 2.00 THEN 'Baseline Purchase' 
	WHEN TOTAL BETWEEN 2.00 AND 6.99 THEN 'Low 
	Purchase' 
	WHEN TOTAL BETWEEN 7.00 AND 15.00 THEN 'Target 
	Purchase' 
	ELSE 'Top Performers'
	END AS PurchaseType
FROM 
	invoices
WHERE PurchaseType = 'Top Performers'
ORDER BY
	BillingCity</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000151.jpg" />

    </figure>

    <p class="h3_body">Looking at the result of this query, we can determine that our top performers come mainly from outside of the US.</p>

    <p class="h3_body">The combinations of fields we can search for or narrow down to is virtually limitless. For example, we could also organize the data by invoice date to see if there are any seasonal purchase trends. Using <span class="code">CASE</span> statements, along with the <span class="code">WHERE</span> clause and the operators we learned about in this chapter, can really help us turn our data into information that would be of direct interest to our sales team.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">In our examples in this chapter, we have always used the <span class="code">CASE</span> statement in the <span class="code">SELECT</span> portion of our query after we have listed the fields we want to display. In your upcoming real-life SQL adventures, you may also encounter a query with a <span class="code">CASE</span> statement contained in a <span class="code">WHERE</span> clause, however uncommon. All that is important for now is to remember that a <span class="code">CASE</span> statement must be defined in <span class="code">SELECT</span> but can be referenced elsewhere. </p>

    </div>

    <h3 class="h1" id="calibre_link-248"><a id="calibre_link-87" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">Create a query for the <span class="italic">invoices</span> table that includes a <span class="code">CASE</span> statement that labels all sales from billing country USA as “Domestic Sales” and all other sales as “Foreign Sales.” Label your new field as <span class="code">SalesType</span> after your <span class="code">END</span> <span class="code">AS</span> statement.</li>

      <li class="numbered">Order this data by the new field <span class="code">SalesType</span>.</li>

      <li class="numbered">How many invoices from Domestic Sales were over $15?</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Operators are special SQL keywords that are used with SQL clauses to filter data by specific conditions.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Using the <span class="code">WHERE</span> clause with a combination of different operators can enable the user to search records for specific text, dates, and numbers.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">DATE()</span> function allows us to exclude the timecode when specifying our date criteria.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The order of operations when using logical operators (such as <span class="code">AND/OR</span>) is controlled by parentheses <span class="code">()</span>.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">CASE</span> statement allows you to label records with a special field name based on user-specified logical conditions.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-34" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-249"><a id="calibre_link-88" class="calibre6"></a>| 6 | </h2>

    <p class="chapter-title" id="calibre_link-250"><a id="calibre_link-251" class="calibre6"></a>Working with Multiple Tables</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Introducing joins</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Joins and relational database structure</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Joins and aliases</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Inner join, left outer join, and right outer join</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Joining more than two tables</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">In all the queries we have written so far, we have only looked at retrieving data from one table (at a time). Although we have learned some powerful querying methods, nothing in our growing SQL tool kit really harnesses the power of a relational database. Our sTunes database has thirteen tables. Each table contains some, but not all, of the information about our fictional company. In order to answer more complex questions from our sTunes company management, we will need to access data from multiple tables simultaneously. This chapter will help you become comfortable obtaining data from two or more tables with a single query by using powerful tools called joins.</p>

    <h3 class="h1" id="calibre_link-252"><a id="calibre_link-89" class="calibre6"></a>What Are Joins?</h3>

    <p class="h2_body">A join is a command that combines the fields from two or more tables of a relational database. Let’s take a look at a very simple example using the <span class="italic">invoices</span> table in our sTunes database. We have worked with the <span class="italic">invoices</span> table extensively in previous chapters, so by now we should be very familiar with the fields in this particular table. As we can see from the Browse Data tab of the SQL browser (Figure 62), the <span class="italic">invoices</span> table has nine fields. Each invoice has an identification number known as <span class="code">InvoiceId</span>. Each customer (that has generated an invoice) has an identification number known as <span class="code">CustomerId</span>. The <span class="italic">invoices</span> table also has fields for the invoice date and invoice total. The rest of the fields in this table are dedicated to the invoice billing address.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000167.jpg" />

    </figure>

    <p class="h2_body">Let’s say our sTunes marketing department wants to get to know the customer base better. They ask us for a full list of customer names (first and last) next to all the invoices generated by that customer. How could we write such a query using only the <span class="italic">invoices</span> table? We would not be able to answer this question in one query using the skills we have learned so far. Our <span class="italic">invoices</span> table does not contain the names of our customers. Instead, the <span class="italic">invoices</span> table contains a field called <span class="code">CustomerId</span>. To discover how to display a list of invoices that includes the customers who generated those invoices, we need to look at the <span class="italic">invoices</span> and <span class="italic">customers</span> tables side by side. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000002.jpg" />

    </figure>

    <p class="h2_body">If we look at the <span class="italic">customers</span> table in Figure 63, we can see that this table contains the information we want: the first and last names of all our sTunes customers. This table also has a <span class="code">CustomerId</span> field. If we look closely at the icons in the <span class="italic">customers</span> table, we can see that this version of the <span class="code">CustomerId </span>field has a small key icon next to it. We learned in chapter 1 that this key icon is the symbol for a primary key, the unique identifying field for that particular table. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">Every table should have at least one field that serves as a primary key. A primary key in one table often exists as a foreign key in a different table.</p>

    </div>

    <p class="h2_body">Since <span class="code">CustomerId</span> is the primary key of the <span class="italic">customers</span> table, and there is a similar field of the same name in the <span class="italic">invoices</span> table, these two <span class="code">CustomerId </span>fields provide us with the link we need to access both of these tables simultaneously. We now have all the information required to join these two tables together and produce a list of invoices with customer names.</p>

    <p class="h2_body">A <span class="code">JOIN</span> clause merging both of these tables together would look like this:</p>

    <pre class="code-wrap">SELECT  
	* 
FROM  
	invoices  
INNER JOIN 
	customers   
ON 
	invoices.CustomerId = customers.CustomerId</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">In this example, we are using a join called an <span class="code">INNER</span> <span class="code">JOIN</span>. Several different types of joins will be introduced in this chapter. Each join functions in a slightly different way. We will address those differences later. At this point, all we really need to know is that joins allow us to access fields from different tables.</p>

    </div>

    <p class="h2_body">When we look at this query, there is a lot we already know. The query begins with <span class="code">SELECT</span>, as all our queries have so far. We use the * symbol in this example, which we learned about in chapter 4, to return all the fields in a table. We are selecting all fields from the <span class="italic">invoices</span> table and joining them to all the fields in the <span class="italic">customers</span> table. We use the <span class="code">ON</span> keyword to provide the query with the link between these two tables, which is the <span class="code">CustomerId</span> field. Since there are two versions of the <span class="code">CustomerId</span> field (one in each table), we must use special notation (in the form of <span class="code">tablename.FieldName</span>) to tell the SQL browser which specific version to use. We set the <span class="code">CustomerId</span> field from the <span class="italic">invoices</span> table (written as <span class="code">invoices.CustomerId</span>) equal to the <span class="code">CustomerId</span> field from the <span class="italic">customers</span> table (written as <span class="code">customers.CustomerId</span>). When we run the query, the resulting output is shown in Figure 64.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">By using the * symbol, we have combined the nine fields of the <span class="italic1">invoices</span> table with the thirteen fields of the <span class="italic1">customers</span> table for a total of twenty-two fields. We have truncated some of these fields for print, but we can view all twenty-two fields in DB Browser by using the horizontal scroll bar in the Results Pane of our Execute SQL tab.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000017.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-253"><a id="calibre_link-90" class="calibre6"></a>How Joins Interact with Relational Database Structure</h3>

    <p class="h2_body">There are a few things we can observe now that we have combined the <span class="italic">invoices</span> table with the <span class="italic">customers</span> table. If we look at the <span class="code">InvoiceId</span> field from the invoices section of the result set (Figure 64), we can see that the first seven records are linked to the same <span class="code">CustomerId</span>. This link tells us that customer number 1 is responsible for generating all seven of those invoices. If we follow along to the customers table portion of the result set, we can see that this customer’s name is Luís Gonçalves. One customer is linked to many invoices. In the language of a relational database (introduced in chapter 1), we can say that the <span class="italic">customers</span> table has a one-to-many relationship with the <span class="italic">invoices</span> table. It makes sense that a single customer, with a single <span class="code">CustomerId,</span> could generate many invoices (by ordering multiple songs) but he would retain the same <span class="code">CustomerId</span> number in the<span class="italic"> invoices</span> table. Another way of describing this relationship is to organize the database schema using an entity relationship diagram (ERD). </p>

    <p class="h2_body">Looking at Figure 65, we can see a graphical representation of the relationship between the <span class="italic">customers</span> table and the <span class="italic">invoices</span> table. If we look at the rest of our database, we can see many other instances of primary and foreign keys establishing a relationship between different tables. Part of creating and using joins is understanding these relationships. In order to join tables together, we must be able to identify primary keys and foreign keys and understand which fields we want to select.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000003.jpg" />

    </figure>

    <p class="h2_body">Joins would not be necessary if the <span class="italic">invoices</span> table had a field that included all the customer names. Going one step further, instead of a database with thirteen tables, we could have just one giant table that contained every field. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000116.png" />

      </figure>

      <p class="h2_body-solo"><span class="bold">Q: Why are databases designed with multiple tables? </span></p>

    </div>

    <p class="h2_body">Answer: In a relational database, the process of distributing fields across related tables is known as <span class="bold-italic">normalization</span>. Normalization keeps the sizes of databases smaller, as it reduces the need to have duplicate fields in the same table. The need to normalize databases increases as database size increases. Saving even a few seconds of query processing time is worth it. Considering the staggering size of some databases, every second counts. Imagine if your Google search took five minutes rather than a few seconds.</p>

    <p class="h2_body">Now that we have identified the common link between the two related fields in both the <span class="italic">invoices</span> table and the <span class="italic">customers</span> table, we can take a closer look at how we write queries with joins.</p>

    <h3 class="h1" id="calibre_link-254"><a id="calibre_link-91" class="calibre6"></a>Using Joins with an Alias</h3>

    <p class="h2_body">We have seen from our first example that joins have a special syntax when referring to field names. Since two tables in any given database may have fields with identical names, when creating joins it is necessary to specify the table name when listing a specific field so that the SQL browser knows exactly which version of that field we are referencing. This syntax requires that the table name be listed first, followed by a period, followed by the field name. Joins are often used with aliases to reduce the amount of typing required, as well as to increase readability. The following two joins are identical in function.</p>

    <pre class="code-wrap">SELECT  
	* 
FROM  
	invoices 
INNER JOIN 
	customers
ON 
	invoices.CustomerId = customers.CustomerId      </pre>

    <pre class="code-wrap">SELECT 
	*
FROM 
	invoices AS i
INNER JOIN
	customers AS c 
ON
	i.CustomerId = c.CustomerId</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Aliases for joins are designed to be concise and readable by convention. These aliases are usually single letters, with the letter used being the first letter of the relevant table (<span class="code">tablename.FieldName</span> would become <span class="code">t.FieldName</span>). We will be using single-letter aliases for table names for the remainder of this chapter.</p>

    </div>

    <p class="h2_body">To further demonstrate the need for aliases when working with joins, let’s go back to our original fictional scenario for this chapter. sTunes management wanted a list showing customer names and the invoices that each customer generated. When we wrote our first join in this chapter, we used the * symbol to select all the fields from each table. This query resulted in a massive twenty-two-field result set. But we were only interested in the customer names and invoice information. In addition to that, when we use the * symbol, we have no control over the order in which our fields are displayed. For example, let’s say sTunes management specified that they wanted their customer list displayed with the last name first. To produce output with a customized order, we have to select individual field names in our <span class="code">SELECT</span> statement instead of using the * symbol. Let’s create a join similar to the ones above, but this time, let’s specify in our query that we want to see the <span class="code">LastName</span> and <span class="code">FirstName</span> fields from the <span class="italic">customers</span> table and the <span class="code">InvoiceId</span>, <span class="code">CustomerId</span>, <span class="code">InvoiceDate</span>, and <span class="code">Total</span> from the <span class="italic">invoices</span> table. Because we are dealing with two tables that contain some fields with identical field names, when we list our individual fields in our <span class="code">SELECT</span> statement we must use the same <span class="code">tablename.FieldName</span> notation we have used in the <span class="code">ON</span> clause of our joins&mdash;with one alteration: instead of listing the full table name, we will use an alias consisting of the first letter of the table, followed by a period, and then the field name. Finally, we want to order the results by the customer’s last name. The resulting query would look like this:</p>

    <pre class="code-wrap">SELECT   
	c.LastName, 
	c.FirstName, 
	i.InvoiceId, 
	i.CustomerId, 
	i.InvoiceDate, 
	i.Total 
FROM
	invoices AS i  
INNER JOIN  
	customers AS c 
ON  
	i.CustomerId = c.CustomerId  
ORDER BY 
	c.LastName</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000120.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Although it appears that we reference aliases (in the <span class="code">SELECT</span> statement) <span class="italic1">before</span> we define them (in the <span class="code">FROM</span> and <span class="code">INNER JOIN</span> statements), we must remember that the SQL browser does not process our queries in the exact way we humans would read them.</p>

    </div>

    <p class="h2_body">Looking at the first ten results of this query, we can see that listing specific fields in a specific order is much more manageable than returning all the fields with the * symbol. We can also imagine how much more complex this join would be if we had to type out the table name every time we referenced a field name. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">In most cases it is a best practice to specify individual field names in your select statement and avoid using the * symbol. Throughout this chapter, however, we will only be using the * symbol for demonstrative purposes to explain <span class="code">JOIN</span> structure. </p>

    </div>

    <h3 class="h1" id="calibre_link-255"><a id="calibre_link-92" class="calibre6"></a>Join Types and Their Differences</h3>

    <p class="h2_body">As we mentioned in the beginning of this chapter, there are several different types of joins. So far, we have used joins to give us access to the fields of multiple tables. We have identified the primary key of the <span class="italic">customers </span>table, identified a similar foreign key in the <span class="italic">invoices</span> table, and used the <span class="code">ON</span> keyword to link the two tables together, hoping that all the data matches up. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000116.png" />

      </figure>

      <p class="h2_body-solo"><span class="bold">Q: What happens if the data from the tables we join does not match up completely?</span> </p>

    </div>

    <p class="h2_body">For example, what if a customer&mdash;let’s call him Customer 6&mdash;deleted his sTunes account and was subsequently removed from the <span class="italic">customers</span> table? Because our sTunes company is required to keep financial records, there is still evidence from the <span class="italic">invoices</span> table that Customer 6 made a purchase at some point. It is not unusual to find discrepancies in databases, and we must decide whether we want our queries to include data that does not match up or to exclude it completely. To handle discrepancies between tables, different types of joins are used. To understand this concept, it is helpful to look at join types in the abstract using a slightly simplified version of our <span class="italic">invoices</span> and <span class="italic">customers</span> tables.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The following tables are a bit different from the ones in our sTunes database. We have kept the basic structure of both tables identical to sTunes <span class="italic1">invoices</span> and <span class="italic1">customers</span> tables but have reduced the tables to just five records each, eliminated some of the fields, simplified the record names, and added a few records in each table that differ from the records in the other table.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000033.jpg" />

    </figure>

    <p class="h2_body">As we look at our simplified <span class="italic">invoices</span> and <span class="italic">customers</span> tables, we can identify a few discrepancies. First, our <span class="italic">invoices</span> table shows that someone with a customer ID of 6 made a purchase on 5/1/2017, but this customer does not appear in our <span class="italic">customers</span> table. Also, it appears that Customer 1 and Customer 5 never made a purchase at all, since those customer ID numbers do not show up in the <span class="italic">invoices</span> table. Customer 2 shows up twice, so we can infer that that customer made two purchases. Since the records for Customer 1 and Customer 5 exist in the <span class="italic">customers</span> table but not the<span class="italic"> invoices</span> table, and Customer 6 only exists in the <span class="italic">invoices</span> table, each table contains at least one unique record that does not exist in the other table. Now we can attempt to join these two tables together and observe how the output is handled depending on which type of join we use. Let’s start with our familiar inner join. </p>

    <p class="h2">The Inner Join</p>

    <p class="h3_body">An inner join only returns matching records. Any unmatched data from either table is ignored. Joins are often described with Venn diagrams, as seen in Figure 68. An inner join represents only the overlapping section of the Venn diagram. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000056.jpg" />

    </figure>

    <pre class="code-wrap">SELECT * 
FROM invoices AS i 
INNER JOIN customers AS c 
ON i.CustomerId = c.CustomerId</pre>

    <p class="h3_body">In this example, our inner join will ignore Invoice 5 from our <span class="italic">invoices</span> table because this invoice refers to a customer (Customer 6) that does not appear on our <span class="italic">customers</span> table. Likewise, Customers 1 and 5 (from the <span class="italic">customers</span> table) did not generate any invoices, so that record is ignored as well. As the Venn diagram shows, only the overlapping data is included. Figure 69 is a visual representation of how an inner join is created from two tables with disparate data:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000091.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">As we learned earlier in the chapter, the <span class="code">CustomerId</span> field has a one-to-many relationship with the <span class="italic1">invoices</span> table. Although this data may appear mismatched, our result set will return four records. This outcome occurs because Customer 2 created two separate invoices. </p>

    </div>

    <p class="h3_body">The SQL code for this inner join is similar to that of our first example. First, we list the fields we want to display in our <span class="code">SELECT</span> statement, being careful to include the appropriate aliases. </p>

    <pre class="code-wrap">SELECT 
	i.InvoiceId,
	c.CustomerId,
	c.Name,
	c.Address,
	i.InvoiceDate,
	i.BillingAddress,
	i.Total
FROM
	invoices AS i
INNER JOIN
	customers AS c
ON	
	i.CustomerId = c.CustomerId</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Since inner joins only return matching data, the order that the tables are listed in does not matter. Order <span class="italic1">will</span> matter for other join types.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000161.jpg" />

    </figure>

    <p class="h3_body">In the output of this query, we can see that only four records were returned. Invoice 5, Customer 1, and Customer 5 are omitted. Customer 2 is responsible for two records. </p>

    <p class="h3_body">The inner join is the most common type of join. The main use of an inner join is to bring corresponding data together from different tables in a relational database. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The keyword “inner” is optional on an inner join. All joins are interpreted as inner joins unless otherwise specified. In other words, joins are inner by default.</p>

    </div>

    <p class="h2">The Left Outer Join</p>

    <p class="h2_body-sa">A left outer join combines all the records from the left table with any matching records from the right table. The Venn diagram equivalent for this type of join is shown in Figure 71.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000178.jpg" />

    </figure>

    <pre class="code-wrap">SELECT * 
FROM invoices AS i 
LEFT OUTER JOIN customers AS c 
ON i.CustomerId = c.CustomerId</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The concept of a “left table” and a “right table” depends entirely on the order these tables are listed in a <span class="code">JOIN</span> statement. Switching the listing order will produce a different result set. This distinction will become important when we convert left joins to right joins later in the chapter.</p>

    </div>

    <p class="h3_body">With this type of join, everything in our <span class="italic">invoices</span> table will be displayed. Since Customer 1 did not order any songs, that particular record is omitted. However, as we can see in Figure 72, we are combining all five records from the <span class="italic">invoices</span> table with only four records from the <span class="italic">customers</span> table. (Remember, there is no record for Customers 1 or 5 in the <span class="italic">invoices </span>table, and Customer 2 produced two invoices.) Unlike the inner join, which matched an equal number of records from each table, a left outer join may return more records from the “left” table. We will have to see the output of this query to understand how the SQL browser handles this.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000012.jpg" />

    </figure>

    <p class="h3_body">The SQL query for a left outer join is very similar to what we used for the inner join. We simply use <span class="code">LEFT</span> <span class="code">OUTER</span> <span class="code">JOIN</span> instead. </p>

    <pre class="code-wrap">SELECT 
	i.InvoiceId,
	c.CustomerId,
	c.Name,
	c.Address,
	i.InvoiceDate,
	i.BillingAddress,
	i.Total
FROM
	invoices AS i
LEFT OUTER JOIN
	customers AS c
ON 
	i.CustomerId = c.CustomerId</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000028.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">With a left outer join, the “outer” keyword is optional.</p>

    </div>

    <p class="h3_body">When we look at the output of our left join, we see that the SQL browser has added null data to our result set. Remember that we have no information in the <span class="italic">customers</span> table about Customer 6. Adding null data is how the SQL browser handles the fact that we were trying to match five records from <span class="italic">invoices</span> to only four records from <span class="italic">customers</span>. Left joins are useful because they allow us to see discrepancies in our data. We can produce lists of customers that have not generated invoices or search for data that has been removed in the right table but still exists in the left table. </p>

    <p class="h2">The Right Outer Join</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">Right outer joins are not supported in SQLite, but since right joins are still popular in other RDBMS implementations, we are going to include them anyway. As we mentioned in our discussion of left joins, we will present a workaround for using right joins in SQLite later on.</p>

    </div>

    <p class="h3_body">The right outer join returns the entire right table as well as matching information from the left table. The right join is a mirror image of the left join and functions in a very similar way.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000045.jpg" />

    </figure>

    <pre class="code-wrap">SELECT * 
FROM invoices AS i 
RIGHT OUTER JOIN customers AS c 
ON i.CustomerId = c.CustomerId</pre>

    <p class="h3_body">Similar to what occurred with the left join, the right join takes all fields from the right (<span class="italic">customers</span>) table and matches that data with any corresponding data from the <span class="italic">invoices</span> table. Since Customer 6 does not exist in the <span class="italic">customers</span> table, this record is ignored.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000062.jpg" />

    </figure>

    <p class="h3_body">The SQL statement required to create a right join is, not surprisingly, similar to the two other joins we have shown so far.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Just like with the left outer join, the “outer” keyword is optional; simply writing <span class="code">RIGHT</span> <span class="code">JOIN</span> produces the same result.</p>

    </div>

    <pre class="code-wrap">SELECT 
	i.InvoiceId,
	c.CustomerId,
	c.Name,
	c.Address,
	i.InvoiceDate,
	i.BillingAddress,
	i.Total
FROM
	invoices AS i
RIGHT OUTER JOIN
	customers AS c
ON
	i.CustomerId = c.CustomerId</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000078.jpg" />

    </figure>

    <p class="h3_body">This particular join returned the most records out of the three joins we have demonstrated so far. Customers 1 and 5 did not have corresponding data in the <span class="italic">invoices</span> table, so null values were assigned to those records. Two records from the <span class="italic">invoices</span> table corresponded to Customer 2, so the join resulted in the data from Customer 2 being listed twice. </p>

    <p class="h3_body">Right joins are used less frequently than left joins. Since SQLite does not recognize the right join, it is a best practice is to reverse the order of tables in your query, which yields the same result set. This will be illustrated later in the chapter.</p>

    <h3 class="h1" id="calibre_link-256"><a id="calibre_link-93" class="calibre6"></a>Inner Joins with More Than Two Tables</h3>

    <p class="h2_body">Joins can combine more than two tables. Adding additional tables using joins is straightforward; it will follow the same pattern as the inner joins we have already demonstrated. Take a look at the database schema in Figure 77. We can see that in addition to the relationship between the <span class="italic">invoices</span> and <span class="italic">customers</span> tables, there is also a relationship between the <span class="code">SupportRepId</span> field (from the <span class="italic">customers</span> table) and the <span class="code">EmployeeId</span> field (from the <span class="italic">employees</span> table). </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000097.jpg" />

    </figure>

    <p class="h2_body">Note that, up to this point, the names of the two fields we have related to each other using the <span class="code">ON</span> keyword have been identical. In this case, we are relating two fields with different names, although the entity relationship diagram shows us that they are corresponding fields. Why does this occur? This disparity teaches us an important lesson about relational database structure. Two corresponding fields don’t have to have the same name. There is actually a good reason for these two fields to have different names. In the sTunes company, each customer is assigned a <span class="code">SupportRepId</span>, or a personal company representative. The number assigned to every customer support representative happens to be the same number used for employee number in the <span class="italic">employees</span> table. The creator of this database could have named both fields <span class="code">EmployeeId</span>, but that strategy could lead to confusion. While it makes sense for customers to have a support representative, and it makes sense that the <span class="code">SupportRepId</span> number is identical to the <span class="code">EmployeeId</span> number, having an <span class="code">EmployeeId</span> field in the <span class="italic">customers</span> table could cause confusion. The two names, denoting identical data, imply different roles for the data within each table. By naming the field <span class="code">SupportRepId</span> in <span class="italic">customers</span>, it’s immediately clear what this field’s purpose is in relation to the <span class="italic">customers</span> table. Instead of coming up with a different number system for <span class="code">EmployeeId</span>, we can link the two through the power of the relational database structure, and this linkage is notated in the database schema (Figure 77).</p>

    <p class="h2_body">Now that we understand how we can relate the <span class="italic">invoices</span>, <span class="italic">customers</span>, and <span class="italic">employees</span> tables, we need to come up with the “why.” Let’s say the sTunes customer service department wants to reward the employees that are responsible for the ten highest individual sales. Customer service wants to create a plaque for each employee with a list of the customers they have helped. Now that we have an operational scenario, we can look at the ERD to determine what fields we need in our query. Sometimes, when writing complex queries accessing multiple tables, it helps to think through what fields we need and what tables those fields come from (Figure 78).</p>

    <p class="h2_body">Now that we have an idea of what fields we want to display, we can begin composing the query. We will start with invoices in our <span class="code">FROM</span> clause. We will then write two <span class="code">INNER</span> <span class="code">JOIN</span> clauses sequentially: one that joins invoices to customers and another that joins both invoices and customers to employees. We will order the entire query by invoice total (in descending order to see the highest totals first).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000115.jpg" />

    </figure>

    <pre class="code-wrap">SELECT 
	e.FirstName,  
	e.LastName, 
	e.EmployeeId, 
	c.FirstName, 
	c.LastName, 
	c.SupportRepId, 
	i.CustomerId,  
	i.Total 
FROM  
	invoices AS i 
INNER JOIN 
	customers AS c 
ON 
	i.CustomerId = c.CustomerId 
INNER JOIN  
	employees AS e 
ON 
	c.SupportRepId = e.EmployeeId 
ORDER BY 
	i.Total DESC
LIMIT 10</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000134.jpg" />

    </figure>

    <p class="h2_body">Now we have a list of sTunes employees responsible for the highest invoice totals. There are a few things we can observe about this result set. As we predicted, even though the fields we use to relate the <span class="italic">customers</span> table to the <span class="italic">employees</span> table have two different names, the data clearly corresponds. The number values in <span class="code">SupportRepId</span> are the same as the values in the <span class="code">EmployeeId</span> field. </p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Consult the entity relationship diagram and choose another table to add to this query using another inner join. Choose which fields from this new table you wish to display and add them to the select statement.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-257"><a id="calibre_link-94" class="calibre6"></a>Using Left Outer Joins with <span class="h3heading_code">NULL</span>, <span class="h3heading_code">IS</span>, and <span class="h3heading_code">NOT</span></h3>

    <p class="h2_body">As we saw earlier in the chapter, a left outer join shows us everything from our left table and all matching information from our right table. This ability is useful for analyzing our database and checking for incomplete information. Let’s say our sTunes company is conducting an internal audit on the way the company classifies albums versus single songs. sTunes management asks us to generate a list of all artists who do <span class="italic">not</span> have an album listed. Looking at our preceding entity relationship diagram, we can surmise that the information we are focusing on is going to be stored in the <span class="italic">artists</span> and <span class="italic">albums</span> tables. Let’s look at the relationship between those tables.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000168.jpg" />

    </figure>

    <p class="h2_body">As we can see in Figure 80, our <span class="italic">artists</span> table consists of an <span class="code">ArtistId</span> field, which is our primary key, and a field for the artist name. We can see from the ERD that the <span class="italic">artists</span> table has a one-to-many relationship with the <span class="italic">albums</span> table. This relationship makes sense, since an artist can generate many albums. Our <span class="italic">albums</span> table has its own primary key, <span class="code">AlbumId</span>, as well as the <span class="code">ArtistId</span> field acting as a foreign key. </p>

    <p class="h2_body">A <span class="code">LEFT</span> <span class="code">OUTER</span> <span class="code">JOIN</span> with the <span class="italic">artists</span> table being our left table would return all the data from the <span class="italic">artists</span> table with matching records (where available) in the <span class="italic">albums</span> table. Our left join will fill in any fields that do not have album titles with null values. Now that we have a clear plan, we can begin to compose our query.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">We have used the first letter of a table as its alias for most joins in this chapter. Since we have two tables with the same first letter, we will use two letters for each in this query.</p>

    </div>

    <pre class="code-wrap">SELECT 
	ar.ArtistId AS [ArtistId From Artists Table],
	al.ArtistId AS [ArtistId From Albums Table],
	ar.Name AS [Artist Name],
	al.Title AS [Album Title]
FROM 
	artists AS ar
LEFT OUTER JOIN
	albums AS al
ON
	ar.ArtistId = al.ArtistId</pre>

    <p class="h2_body">At first, when we scan through the 418 records returned by this query, nothing seems out of place. The <span class="code">ArtistId</span> field from the <span class="italic">artists</span> table seems to match the <span class="code">ArtistId</span> field from the <span class="italic">albums</span> table. Most artist names are associated with album titles. However, if we scroll down farther in our result set (Figure 81), we begin to see null values appear.</p>

    <p class="h2_body">To fully answer our initial inquiry and retrieve all artists who do not have an album, we would need to add a <span class="code">WHERE</span> clause that specified only the records that are null in the <span class="italic">albums</span> table. There are specific SQL keywords we use to work with null values.</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="code">IS NULL</span> in a <span class="code">WHERE</span> clause would return only values that were null</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="code">NOT NULL</span> would return only values that were not null</p>

      </li>

    </ul>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000004.jpg" />

    </figure>

    <p class="h2_body">Adding a clause that specifies that we are only looking for cases <span class="code">WHERE</span> <span class="code">al.ArtistId</span> <span class="code">IS</span> <span class="code">NULL</span> would return a list of artists without album names.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">We must use <span class="code">IS</span> and <span class="code">NOT</span> when dealing with nulls rather than the equals sign “=” operator. Nulls represent a lack of data. The = operator compares the value of two items. Nulls have no value and thus cannot be compared using the = operator. Attempting to use = will produce an error.</p>

    </div>

    <pre class="code-wrap">SELECT 
	ar.ArtistId AS [ArtistId From Artists Table],
	al.ArtistId AS [ArtistId From Albums Table],
	ar.Name AS [Artist Name],
	al.Title AS [Album]
FROM 
	artists AS ar
LEFT OUTER JOIN
	albums AS al
ON
	ar.ArtistId = al.ArtistId
WHERE 
	al.ArtistId IS NULL</pre>

    <p class="h2_body">In our result set (Figure 82), we have 71 records where there are no corresponding albums next to the artist name.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000018.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-258"><a id="calibre_link-95" class="calibre6"></a>Turning a Right Join into a Left Join</h3>

    <p class="h2_body">As we learned earlier in the chapter, right joins are not supported in SQLite. We also learned that right joins are mirror images of left joins. Consider the Venn diagram below.</p>

    <p class="h2_body">A right join takes all records on the right side and joins them with all corresponding records from the left. If you simply switch the left and right tables, then you can use a left outer join to the very same effect. The following query has been written as a right outer join. This query takes any corresponding album or title info from the <span class="italic">albums</span> table and merges it with<span class="italic"> all</span> records from the <span class="italic">tracks</span> table.</p>

    <pre class="code-wrap">SELECT * FROM albums AS al RIGHT OUTER JOIN tracks AS t ON t.AlbumId = al.AlbumId </pre>

    <p class="h2_body">is the same as </p>

    <pre class="code-wrap">SELECT * FROM tracks AS t LEFT OUTER JOIN albums AS al ON t.AlbumId = al.AlbumId </pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000034.jpg" />

    </figure>

    <pre class="code-wrap">SELECT  
	t.TrackId,
	t.Composer,
	t.Name,
	al.AlbumId,  
	al.Title  
FROM  
	albums AS al
RIGHT OUTER JOIN 
	tracks AS t
ON 
	t.AlbumId = al.AlbumId</pre>

    <p class="h2_body">If you run the preceding query in DB Browser, you will get the following error: <span class="code">RIGHT and FULL OUTER JOINs are not currently supported.</span></p>

    <p class="h2_body">That isn’t a problem for us, however, as we know that by simply swapping the two table names in the join, we can achieve the same result. Consider the following query; the only thing that differs from the query above is the order in which the tables are listed:</p>

    <pre class="code-wrap">SELECT  
	t.TrackId,
	t.Composer,
	t.Name,
	al.AlbumId,  
	al.Title  
FROM  
	tracks AS t 
LEFT OUTER JOIN 
	albums AS al 
ON 
	t.AlbumId = al.AlbumId</pre>

    <p class="h2_body">Now this query can be run, and we can observe the results (Figure 84). With this query we can see the composer of a song, the song name, and the album title all in one result set. We can also observe that there are some null values in the composer field. From there, we could rewrite the query to investigate those null values. The key takeaway from left/right joins is that they allow you to “troubleshoot” your own databases and really discover inconsistencies in your data. If you are looking for corresponding data and are willing to risk omitting a few records due to database errors, it is better to just use an inner join. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000051.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Modify the above query to display only the records where the <span class="code">Composer</span> field is null. </p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-259"><a id="calibre_link-96" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">Using DB Browser and the Browse Data tab or the entity relationship diagram in Figure 65, view the <span class="italic">tracks</span> table. Identify which fields in that table are foreign keys in another table. Based on the foreign keys you have identified, which tables are related to the <span class="italic">tracks</span> table? </li>

      <li class="numbered">Create an inner join between the <span class="italic">albums</span> and <span class="italic">tracks</span> tables and display the album names and track names in a single result set.</li>

      <li class="numbered">Using the <span class="italic">genres</span> table identified from question 1, create a third inner join to join to this table and include the <span class="code">Name</span> field from that table in your result set.</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Joins harness the power of a relational database to bring data together from different tables.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Use of an entity relationship diagram is helpful when writing joins.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">When selecting fields from multiple tables at once, aliases are needed to specify the table of origin.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Inner joins do not include rows where there is no corresponding data.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Outer joins include all rows of one of the tables, even when there is no corresponding data between tables. Rows that do not match will show up as null.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The special keywords <span class="code">IS</span> and <span class="code">NOT</span> must be used to test for null values.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Right joins can be used in implementations of SQL other than SQLite. To do the equivalent of a right join in SQLite, simply switch the position of the two tables you are comparing in your query statement.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-30" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-260"><a id="calibre_link-97" class="calibre6"></a>| 7 | </h2>

    <p class="chapter-title" id="calibre_link-261"><a id="calibre_link-262" class="calibre6"></a>Using Functions</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Adding calculations to your queries </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Types of functions in SQL</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">String functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Date functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Aggregate functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Using the <span class="code">WHERE</span> and <span class="code">HAVING</span> clauses with functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Grouping by multiple columns</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">If you have been testing your knowledge using our end-of-chapter Data Analysis Checkpoints, you may have noticed that a few of the questions required an additional step to be performed after you wrote your query. For example, at the end of chapter 4, we asked you “How many of our customer’s last names start with <span class="italic">B</span>?” Other questions asked you to find totals of invoices within a certain price range. Using the tools you had available at the time, some of these questions required you to manually count or add up the query results in order to obtain the answer. To calculate all last names ending in <span class="italic">B</span> using only knowledge from chapter 4, you could select the <span class="code">LastName</span> field from the <span class="italic">customers</span> table, order by last name, scroll down to the <span class="italic">B</span> names, then count those names manually. If you augmented your query with chapter 5 knowledge, you could make the task a bit easier by restricting the dataset to return only last names starting with <span class="italic">B</span> (using <span class="code">WHERE</span> <span class="code">LastName</span> <span class="code">LIKE </span><span class="code">'B%'</span>). However, you would still have to do the count manually. This chapter will show you how to simplify your calculations by using functions.</p>

    <h3 class="h1" id="calibre_link-263"><a id="calibre_link-98" class="calibre6"></a>Adding Calculations to Your Queries</h3>

    <p class="h2_body">Calculations (like counting the number of records returned), can be performed by adding functions to our queries. With the use of a function called <span class="code">COUNT()</span>, we can ask the SQL browser to do a count of <span class="code">LastName</span> and use an alias to return the value as <span class="code">NameCount</span>. Adding a function to a basic <span class="code">SELECT</span> statement would look something like this:</p>

    <pre class="code-wrap">SELECT 
	COUNT(LastName) AS [NameCount]
FROM 
	customers
WHERE
	LastName LIKE 'B%'</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000127.jpg" />

    </figure>

    <p class="h2_body">Instead of listing all the entries starting with <span class="italic">B</span>, (which we would then have to count), we could use the <span class="code">COUNT()</span> function to add up all fields in the <span class="italic">customers</span> table that satisfy our <span class="code">WHERE</span> condition. The end result gives us an aliased field and the number of last names starting with <span class="italic">B</span>.</p>

    <p class="h2_body">This is just one example of how functions can save us time by doing some of the extra work for us. In this chapter, we will go over three different types of functions in SQL and give examples of the ones that are the most useful.</p>

    <h3 class="h1" id="calibre_link-264"><a id="calibre_link-99" class="calibre6"></a>Types of Functions in SQL</h3>

    <p class="h2_body"><span class="bold-italic">Functions</span> in SQL are special keywords that accept certain parameters, perform an operation (such as a calculation or modification of the data in the field), and return the result of that operation as a value. You have already had a sneak preview of functions in chapter 5, where we introduced the <span class="code">DATE()</span><span class="code"> </span>function. The <span class="code">DATE()</span> function took as its parameter data in the format <span class="code">DATETIME</span>, performed an operation (stripped the time stamp portion away), and then returned only the date portion of the data point. But as we mentioned in chapter 5, there are many more types of functions in SQL that do a variety of tasks. Figure 86 contains a list of some of the most common and useful ones. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">This list is by no means exhaustive. All of the functions mentioned in this book are ones specifically recognized by SQLite. Other database implementations have different functions. A full list of functions understood by SQLite is available on the SQLite webpage.<a href="#calibre_link-31" id="calibre_link-24" class="calibre6"><span class="underline2">10</span></a></p>
    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000023.jpg" />

    </figure>

    <p class="h2_body">As you can see in Figure 86, the functions we cover in this book come in three different types:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">String functions</span> modify character and text-based data.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">Date functions</span> modify time and date data.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item"><span class="bold">Aggregate functions</span> perform mathematical operations.</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">At first glance, it may appear that these three types of functions work only with their respective data types (character, date, and numerical). However, recall our first example with <span class="code">COUNT()</span>; we were able to use an aggregate function to perform a mathematical count of character data. There are some situations where we can use these functions on different data types. For a refresher on data types, see chapter 1. </p>

    </div>

    <p class="h2_body">Functions in SQL operate very similar to the way functions operate in spreadsheet software and other programming languages. If you have ever used the <span class="code">SUM()</span> feature in a Microsoft Excel spreadsheet, then you will already have some idea of how to use functions. Another similarity these functions share with Excel functions is the “pop-up” style definitions that appear once we type the function in the SQL browser. Consider this example. In the Execute SQL Pane, start to type the name of a function with one open bracket:</p>

    <pre class="code-wrap">UPPER(</pre>

    <p class="h2_body">After doing this, you should see the following text pop up under the function you just typed:</p>

    <pre class="code-wrap">The UPPER(X) function returns a copy of input string X in which all lowercase ASCII characters are converted to their uppercase equivalent.</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The portion of the function in parentheses (X) is called the argument of the function. Some functions may take more than one argument.</p>

    </div>

    <p class="h2_body">Most functions in DB Browser have pop-up information that is very helpful for determining what <span class="bold-italic">argument(s)</span> the function takes and what the function actually does. Try a few others for yourself.</p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">The <span class="code">UPPER(</span><span class="code">)</span> function takes only one argument (X). How many arguments does the <span class="code">REPLACE(</span><span class="code">)</span> function take?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">According to the tooltip (onscreen in DB Browser), what does the <span class="code">TRIM(</span><span class="code">)</span> function do?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">If you do not see the pop-up, make sure you are typing the function correctly. The function pop-up text will not appear if you just copy and paste the function and the open parenthesis into the Execute Pane. This is another reason you should always type queries by hand. No shortcuts!</p>

    </div>

    <h3 class="h1" id="calibre_link-265"><a id="calibre_link-100" class="calibre6"></a>Manipulating Text Data with String Functions</h3>

    <p class="h2_body">A <span class="bold-italic">string</span> is another word for text data stored in a text-based data type. String functions can format and modify text. To understand how string functions operate, we need to conduct a brief refresher on data types in SQLite. In chapter 3, while investigating the structure of our database, we observed that the text-based data was saved in a format called <span class="code">NVARCHAR(X)</span>. <span class="code">NVARCHAR</span> is a variable-length string where the X represents the maximum length of the string.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">For character data with a fixed length (like postal codes with letters in them), a different fixed-length data type can be used. However, in the sTunes database, the character data type <span class="code">NVARCHAR</span> is used for all text-based data.</p>

    </div>

    <p class="h2_body">Being able to manipulate text strings is important because the fields in a database are not always organized in a way that is most useful to us. Let’s say we were asked to create a mailing list of our US customers. To do this we would need their names and addresses. We can get that easily with a quick <span class="code">SELECT</span> statement.</p>

    <pre class="code-wrap">SELECT
	FirstName,
	LastName,
	Address
FROM
	customers
WHERE
	Country = 'USA'</pre>

    <p class="h2_body">Running this query returns the following&mdash;but there is a slight problem.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000039.jpg" />

    </figure>

    <p class="h2_body">The address data is split up into parts. Simply requesting the <span class="code">Address</span> field is not enough. We would also need to select the <span class="code">City</span>, <span class="code">State</span>, and <span class="code">PostalCode</span> fields. The other issue is that all this data is in separate fields. If you want to create a simple mailing list, where each line represents the customer’s full name and address, then the current layout is formatted very poorly for that. </p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Try copying the output from the last query into DB Browser in a text editor. What does it look like?</p>

      </li>

    </ul>

    <p class="h2_body-sa">Fortunately, there are some great tools for manipulating text strings so that we can get the output looking the way we want it. The first of these tools is called concatenation.</p>

    <h3 class="h1" id="calibre_link-266"><a id="calibre_link-101" class="calibre6"></a>Concatenating Strings of Text</h3>

    <p class="h2_body">Joining fields together is called concatenating them. To add two fields together we use a two-pipe <span class="code">||</span> operator. For example, if we wanted to concatenate the fields <span class="code">FirstName</span> and <span class="code">LastName</span>, we could write the following: </p>

    <pre class="code-wrap">SELECT 
	FirstName || LastName
FROM 
	customers
WHERE 
	CustomerId = 1</pre>

    <p class="h2_body">This would give us the following output:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000173.jpg" />

    </figure>

    <p class="h2_body">You can see from the output of our concatenation query that the || operator merely attached both fields together without spaces. To make this output a bit cleaner, we can use two concatenations in sequence and include a space in single quotation marks. After making this adjustment, our query looks like the following:</p>

    <pre class="code-wrap">SELECT
	FirstName,
	LastName,
	FirstName || ' ' || LastName
FROM 	
	customers
WHERE
	Country = "USA"</pre>

    <p class="h2_body">We should get output that looks like this:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000029.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">When you run this query for yourself, make things a little cleaner by creating an alias called “Full Name” for our concatenated field.</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The concatenation function <span class="code">||</span> doesn’t really look like the rest of the functions we will be exploring in this chapter. In other implementations of SQL, there is an actual <span class="code">CONCAT(</span><span class="code">)</span> function. Still other implementations use a + symbol. The syntax may be different depending on which RDBMS you use, but the effect is the same. </p>

    </div>

    <p class="h2_body">Now that we have seen an example, we can use multiple concatenations to create a one-line name and address list for all our customers.</p>

    <pre class="code-wrap">SELECT
	FirstName || ' ' || LastName || ' ' || Address 
	|| ', ' || City || ', ' || State || ' ' || 
	PostalCode AS [MailingAddress]
FROM 	
	customers
WHERE
	Country = "USA"</pre>

    <p class="h2_body">The result looks like this: </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000139.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">When you run this query, try pasting the output from DB Browser into a text editor to see how different it looks. The output should look much cleaner than before we concatenated it.</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">You do not have to use only spaces in between the double pipes. In the previous example, we used a comma and then a space ',   ' to get the desired format. You can add any text you wish as long as you put it inside the quotation marks.</p>

    </div>

    <h3 class="h1" id="calibre_link-267"><a id="calibre_link-102" class="calibre6"></a>Truncating Text</h3>

    <p class="h2_body">We can also separate or truncate text using functions. Looking at the example above, you can see that the US postal codes in our <span class="italic">customers</span> table are not uniform. Some of them include a hyphen and an additional four-digit number, referred to by the US Postal Service as a ZIP+4 code. And one of the postal codes seems to be missing the fourth digit of the ZIP+4 code. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000030.png" />

      </figure>

      <p class="note">This is a good time to mention that finding errors or inconsistencies in a database is inevitable. Being able to anticipate and handle errors and exceptions is part of the learning process and an invaluable skill. Fields often have misspellings, an incorrect number of characters, or other issues. Over time you will learn to anticipate and handle errors as you come across them.</p>

    </div>

    <p class="h2_body">We can use functions to remove the hyphen and extra numbers so that our postal code output is uniform. Thanks to the US Postal Service’s advanced routing system, the additional numbers in US postal codes (beyond the initial five) are not required. </p>

    <p class="h2_body">To use string editing functions, we need to know a bit more about how strings are saved in a database. The characters in every string are numbered starting with 1. This becomes important when we start manipulating strings because it allows us to specify what parts we want to manipulate based on the character number.</p>

    <p class="h2_body">If we use the <span class="code">LENGTH()</span> function on a field like <span class="code">PostalCode</span> from our <span class="italic">customers</span> table, we can see that the length of each code is calculated.</p>

    <pre class="code-wrap">SELECT
	PostalCode,
	LENGTH(PostalCode) AS [Postal Code Length]
FROM 	
	customers
WHERE
	Country = "USA"</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000013.jpg" />

    </figure>

    <p class="h2_body">Looking at the output (Figure 91), it is easy to see that our postal codes vary in string size. The minimum necessary length of a US postal code is five digits. Let’s remove all information after the fifth position in the string. We can do this with the <span class="code">SUBSTR()</span> function.</p>

    <p class="h2_body">The <span class="code">SUBSTR()</span> function exists in two forms: <span class="code">SUBSTR(X,Y)</span> and <span class="code">SUBSTR(X,Y,Z)</span>. As we have done before, we can type “<span class="code">SUBSTR(</span>” into our browser for a brief description of how it works.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">To get DB Browser to give you a pop-up preview of <span class="code">SUBSTR(X,Y,Z)</span>, you will need to type “<span class="code">SUBSTR(X,Y,</span>” to tell the browser you are interested in the three-argument version of this function.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000072.jpg" />

    </figure>

    <p class="h2_body">If we use the <span class="code">SUBSTR(X,Y,Z)</span> function to remove the extra data from the US postal codes, the X will be our <span class="code">PostalCode</span> field, and the Y argument specifies the starting position of the string. In this case, we want the first five numbers to remain, so we are going to choose 1. The Z argument specifies the number of characters the function will return from the starting position, which in our case is five.</p>

    <p class="h2_body">If we select only the United States addresses and then include the <span class="code">SUBSTR(X,Y,Z)</span> function with an alias, we get the following:</p>

    <pre class="code-wrap">SELECT
	PostalCode,
	SUBSTR(PostalCode,1,5) AS [Five Digit Postal 
	Code]
FROM 
	customers
WHERE
	Country = "USA"</pre>

    <p class="h2_body">Looking at the output (Figure 93), we can see that all our postal codes retain only the first five digits. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The postal codes that never had the additional numbers aren’t affected by this query.</p>

    </div>

    <p class="h2_body">Using the <span class="code">SUBSTR()</span> function, we can also split data apart. Note that the version of <span class="code">SUBSTR(</span><span class="code">)</span> that takes two arguments returns all characters through the end of the string beginning with the Y-th. If our Y value doesn’t start at character 1, we can direct the function to only return characters from the Y-th character and onward.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000108.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Repeat the preceding SQL statement but add an additional field to the <span class="code">SELECT</span> portion of the query using <span class="code">SUBSTR(X,Y)</span> that includes only the last four digits of the postal code (where available) with the alias “ZIP+4 Code.”</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-268"><a id="calibre_link-103" class="calibre6"></a>Additional String Functions</h3>

    <p class="h2_body">The functions listed in this text are by no means exhaustive. As mentioned in the beginning of this chapter, a full list of SQLite supported functions can be found on the SQLite website. An alternative way to learn new functions is to type them in, read the tooltip, and try to figure out how they work. Before we move on to date and aggregate functions, we will introduce two more string functions that are very useful.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000085.jpg" />

    </figure>

    <p class="h2_body">As we saw earlier looking at the tooltip, the <span class="code">UPPER(X</span><span class="code">)</span> function returns a copy of input string X in which all lowercase ASCII characters are converted to their uppercase equivalent. The <span class="code">LOWER(</span><span class="code">)</span> function enacts a similar process.</p>

    <p class="h2_body">The following SQL statement demonstrates both of these functions.</p>

    <pre class="code-wrap">SELECT 
	FirstName as [First Name Unmodified],
	UPPER(FirstName) as [First Name in UPPERCASE],
	LOWER(FirstName) as [First Name in lowercase],
	UPPER(FirstName) || ' ' || UPPER(LastName) AS 
	[Full Name in UPPERCASE]
FROM 
	customers</pre>

    <p class="h2_body">In this query, we passed the entire <span class="code">FirstName</span> field into the <span class="code">UPPER() </span>and <span class="code">LOWER()</span> functions as an argument, and then used an alias to label the result. We also created a “Full Name” alias to show that you can concatenate two fields after performing functions on them.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000128.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The upper and lower functions only work on ASCII characters. Any characters initially formatted in unicode are left unchanged.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item1">Use the <span class="code">SUBSTR()</span> function together with the case functions and create a list of customers with the last name listed first in capital letters and only the first initial of the first name.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-269"><a id="calibre_link-104" class="calibre6"></a>Date Functions</h3>

    <p class="h2_body">Date functions allow us to manipulate data stored in various date and time formats. In our sTunes database, the date information is stored in a <span class="code">DATETIME</span> format: <span class="code">YYYY-MM-DD</span> <span class="code">HH:MM:SS</span>. Although the format gives us space for a timecode, the timecode is not being used in our database and all of the timecodes are blank and show 00:00:00. Because of this, we have used the <span class="code">DATE(</span><span class="code">)</span> function (first introduced in chapter 5), to strip away the timecode and leave us with just the date information. Since date information can be stored in different ways in any given database, it is important to know how to convert one format to another. There is a lot more we can do with dates other than just changing their formats. For example, we can get the difference between any given date and the current date to calculate the ages of our employees, since we have a <span class="code">BirthDate</span> field in the <span class="italic">employees</span> table.</p>

    <p class="h2_body">In order to calculate employee ages, we will need to learn a bit more about the <span class="code">STRFTIME(</span><span class="code">)</span> function, also known as the string format time function. As the name implies, this function formats the time and date information as a text string. The <span class="code">STRFTIME()</span> function needs at least two pieces of information to operate correctly. You must provide your desired format (also known as a conversion specification) and a timestring to format. The timestring can be a <span class="code">DATETIME</span> field from your database or it can be typed manually. The timestring can also use the <span class="code">NOW</span> function as an argument. The third argument, a modifier, is optional and can be used to incrementally shift the date forward or back and perform a few other functions.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000146.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The <span class="code">NOW</span> function is sometimes called a nondeterministic function, which is a fancy way of saying that the resulting data returned from this function is different every time it is called, since the date and/or time will be different every time it is called. The <span class="code">STRFTIME()</span> function and most other functions covered in this book are deterministic; that is, they produce the same result every time they are used with the same arguments. The <span class="code">NOW</span> function needs to be constantly updated so it relies on your computer’s time to stay accurate.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000162.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000179.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000014.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">We can see from Figures 97, 98, and 99  that the <span class="code">STRFTIME()</span> function lends itself to extensive modification. If you do not understand the significance of all the arguments and modifications <span class="code">STRFTIME()</span> can take, don’t worry. At its core, <span class="code">STRFTIME()</span> takes time and date formatted data and uses keywords to return the user-specified portions of the date.</p>

    </div>

    <p class="h2_body">As we have seen in other text strings, we can use any characters we like inside the single quotation marks, provided we include quotation marks around the entire string. </p>

    <pre class="code-wrap">SELECT 
STRFTIME('The Year is: %Y The Day is: %d The Month is %m', '2011-05-22') AS [Text with Conversion Specifications]</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000052.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">The conversion specifications always start with the <span class="code">%</span> symbol followed by a case-sensitive letter. Using an uppercase <span class="code">%M</span> instead of <span class="code">%m</span> would give us minutes instead of months.</p>

    </div>

    <p class="h2_body">Let’s use <span class="code">STRFTIME(</span><span class="code">)</span> to calculate employee ages. The first thing to do is to specify the format we desire returned to us. Since <span class="code">BirthDate</span> is a <span class="code">DATETIME</span> data type and the timecodes are blank in our database, we have no interest in the timecodes so we will omit them for the sake of clarity. Since we want to figure out the age of our employees, we want to calculate the difference in time between a given employee’s birthdate and the present date. The present date is provided by the <span class="code">NOW</span> function.</p>

    <pre class="code-wrap">SELECT
	LastName,
	FirstName,
	STRFTIME('%Y-%m-%d',BirthDate) AS [Birthday No 
	Timecode],
	STRFTIME('%Y-%m-%d','now') - STRFTIME('%Y-%m-%d', 
	BirthDate) AS [Age]
FROM 	
	employees
ORDER BY
	Age</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000068.jpg" />

    </figure>

    <p class="h2_body">As you can see from the results, we can use <span class="code">STRFTIME(</span><span class="code">)</span> in the same way we used the <span class="code">DATE(</span><span class="code">)</span> function to strip off timecodes. We then get the difference between two strftime functions in order to get employee age. </p>

    <p class="h2">ON YOUR OWN: </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">sTunes celebrates employee birthdays on the first of the month. Create a table for HR that shows employee names, birthdays, and the celebration day.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">sTunes Human Resources has told us that employee age is a sensitive topic. Rewrite this exercise by listing employees by number of years with the company.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Which employee has been with the company the longest?</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-270"><a id="calibre_link-105" class="calibre6"></a>Aggregate Functions</h3>

    <p class="h2_body"><span class="bold-italic">Aggregate functions</span> can turn a range of numbers into a single data point based on a variety of mathematical operations. At the beginning of this chapter, we used the <span class="code">COUNT()</span> function to find the total number of all customers with last name starting with <span class="italic">B</span>. There are many more helpful ways to use aggregate functions. As an example, using our invoices table, we can use the <span class="code">SUM()</span> function to calculate a total of all invoices.</p>

    <pre class="code-wrap">SELECT 
	SUM(Total) AS [Total Sales]
FROM 
	invoices </pre>

    <p class="h2_body">Although there are many aggregate functions,<a href="#calibre_link-32" id="calibre_link-25" class="calibre6"><span class="super">11</span></a> let’s focus on five basic ones that we should be aware of in SQL: <span class="code">SUM()</span>, <span class="code">AVG()</span>, <span class="code">MIN()</span>, <span class="code">MAX()</span>, and <span class="code">COUNT()</span>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000086.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000154.png" />

      </figure>

      <p class="h3_body-sa">If we run the following statement: </p>

      <pre class="code-wrap">SELECT
	SUM(Total) AS TotalSales,
	AVG(Total) AS AverageSales,
	MAX(Total) AS MaximumSale,
	MIN(Total) AS MinSale,
	COUNT(*) AS SalesCount
FROM
	invoices</pre>

      <p class="h3_body">We get the following output:</p>

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img alt="" class="w" src="images/000103.jpg" />

      </figure>

    </div>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">By default, the <span class="code">COUNT()</span> function returns only values that are not null. However, if we want a count of all records, even records with errors or nulls, it is a best practice to use the asterisk * or primary key field. The asterisk symbolizes “return all records,” so when it is used with the <span class="code">COUNT()</span> aggregate function, we are asking for a count of all records in the <span class="italic1">invoices</span> table.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How many invoices are in our<span class="italic"> invoices</span> table?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the average invoice amount?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the amount of the largest invoice in our table?</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-271"><a id="calibre_link-106" class="calibre6"></a>Nesting Functions with the <span class="h3heading_code">ROUND(</span><span class="h3heading_code">)</span> Function</h3>

    <p class="h2_body">A nested function is a function contained within another function. One reason we would want to nest functions is to further modify the format of the inner function. If we look at the example above where we used the <span class="code">AVG()</span> function, we see that “Average Sales” contains too many decimal places to be used as a monetary value. The <span class="code">ROUND()</span> function, although not considered an aggregate function, is very useful when we perform any sort of mathematical operation and we want to tidy up our results. We can accomplish this by placing the <span class="code">AVG()</span> function inside the <span class="code">ROUND()</span> function (also known as nesting), and specifying the number of decimals we want the function to round to.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000121.jpg" />

    </figure>

    <pre class="code-wrap">SELECT
	AVG(Total) AS [Average Sales],
	ROUND(AVG(Total), 2) AS [Rounded Average Sales]
FROM
	invoices</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000140.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">When using the <span class="code">ROUND()</span> function with monetary values, you may want to be careful of rounding up prematurely and changing monetary values during intermediary calculations. Usually, rounding is only done at the last step, and you can annotate your query with comments to state that the results are rounded to two decimal places.</p>

    </div>

    <h3 class="h1" id="calibre_link-272"><a id="calibre_link-107" class="calibre6"></a>Using Aggregate Functions with the <span class="h3heading_code">GROUP BY</span> Clause</h3>

    <p class="h2_body">A useful feature of aggregate functions is their ability to calculate subtotals or aggregates for different groups of data. Looking at the <span class="italic">invoices</span> table of our sTunes database, we know that we can get the average amount of an invoice very easily with the <span class="code">AVG()</span> function. Let’s say that our sTunes company asks us to calculate the average invoice amount by billing city. To attempt to answer that question, we construct the following query.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">The following query has been written incorrectly to show what happens when you combine aggregate functions with non-aggregate fields in your <span class="code">SELECT</span> statement. This query produces no errors, but it does not correctly display the information we are requesting.</p>

    </div>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total)
FROM
	invoices
ORDER BY
	BillingCity</pre>

    <p class="h2_body">If you run this query, you will see that something is wrong.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000157.jpg" />

    </figure>

    <p class="h2_body">We wanted to view the average invoice amount of each individual city’s <span class="italic">invoices</span> table. Even though we included billing city in our <span class="code">SELECT </span>statement, the query is still only giving us a global average of all invoices. Why isn’t our query returning the average total for every city in our <span class="italic">invoices</span> table?</p>

    <p class="h2_body">To solve this puzzle, let’s look at what we are asking the SQL browser to do. The question we were asked was “What are the average invoice totals by city?” </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">When we first introduced queries in chapter 4, we explained that it is often helpful to break a query down into its components and ask “What table contains the information I need?” and “How do I want that information displayed?” Asking these two questions can help you troubleshoot a query that is not returning the information you expected.</p>

    </div>

    <p class="h2_body">In the preceding incorrect query, we asked the SQL browser for two items in the <span class="italic">invoices</span> table. First, we asked the browser to list every city in the <span class="code">BillingCity</span> field. Then, we asked the browser to give us an average of the <span class="code">Total</span> field. The former request yields a multi-line response, and the latter gives a one-line answer. In other words, we are asking the browser to display both aggregate and non-aggregate fields at the same time. We did not get the information we wanted because we did not phrase our question correctly. </p>

    <p class="h2_body">We can fix this issue by adding the <span class="code">GROUP</span> <span class="code">BY</span> clause to the query, as follows:</p>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total)
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000174.jpg" />

    </figure>

    <p class="h2_body">When we execute the query (Figure 107), we observe that all billing cities now occur once in our result set and display the corresponding <span class="italic">average</span> subtotals for each city.</p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">When you run this query, add the <span class="code">ROUND(</span><span class="code">)</span> function to clean up the averages to two decimal points.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-273"><a id="calibre_link-108" class="calibre6"></a>Using the <span class="h3heading_code">WHERE</span> and <span class="h3heading_code">HAVING</span> Clauses with Grouped Queries</h3>

    <p class="h2_body">Adding criteria to a grouped query works in the same way as with other queries we have seen. Using the <span class="code">WHERE</span> clause allows us to add new criteria. In our example below, criteria are added for the non-aggregated field <span class="code">BillingCity</span>.</p>

    <pre class="code-wrap">SELECT 
	BillingCity,
	AVG(Total) 
FROM
	invoices
WHERE 
	BillingCity LIKE 'L%'
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000008.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">A non-aggregate field is just a field in the <span class="code">SELECT</span> clause that is called out without an aggregate function.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">In the previous query, how many billing cities begin with <span class="italic">L</span>?</p>

      </li>

    </ul>

    <p class="h2_body-sa">In the last example, we added criteria to a non-aggregate field. At times we will want to use criteria on fields that have been aggregated, like <span class="code">AVG(Total)</span>. For instance, what if we were asked to find all average totals that are less than 20. We could attempt to answer this with a <span class="code">WHERE</span> clause, but there is a problem.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">The following SQL statement contains an error. But it is important to see that criteria created by the <span class="code">WHERE</span> clause do not work with aggregate data. </p>

    </div>

    <pre class="code-wrap">SELECT 
	BillingCity,
	AVG(Total) 
FROM
	invoices
WHERE
	AVG(Total) &gt; 5
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <p class="h2_body">If you run this query, you will get the following error message: </p>

    <pre class="code-wrap">Misuse of aggregate: AVG():</pre>

    <p class="h2_body">This error message tells us that&mdash;at least in this case&mdash;we cannot use the <span class="code">WHERE</span> clause to create a condition based on an aggregate function. In this case, the <span class="code">WHERE</span> clause can only direct the query about what information to pull from the fields in our <span class="code">SELECT</span> clause. If we want additional filtering based on aggregate functions, we will have to include a secondary filtering clause, known as the <span class="code">HAVING</span> clause. </p>

    <p class="h2_body">The <span class="code">HAVING</span> clause always comes after the <span class="code">GROUP BY</span> clause. Our query is modified to look as follows:</p>

    <pre class="code-wrap">SELECT 
	BillingCity,
	AVG(Total) 
FROM
	invoices
GROUP BY
	BillingCity
HAVING 
	AVG(Total) &gt; 5	
ORDER BY 
	BillingCity</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000024.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">You can think of <span class="code">HAVING</span> as a special keyword only to be used when you already have a <span class="code">GROUP</span> <span class="code">BY</span> clause. Just as the <span class="code">WHERE</span> clause filters field data, the <span class="code">HAVING</span> clause filters aggregate data. If you try to use <span class="code">HAVING</span> without a <span class="code">GROUP</span> <span class="code">BY</span> clause, you will get an error.</p>

    </div>

    <h3 class="h1" id="calibre_link-274"><a id="calibre_link-109" class="calibre6"></a>The <span class="h3heading_code">WHERE</span> Clause Versus the <span class="h3heading_code">HAVING</span> Clause</h3>

    <p class="h2_body">A very simplified explanation of the difference between the <span class="code">WHERE</span> clause and the <span class="code">HAVING</span> clause is that <span class="code">WHERE</span> is for filtering non-aggregate data and <span class="code">HAVING</span> is for filtering results containing aggregates. A more detailed way to describe this difference is that two types of filtering occur when both a <span class="code">WHERE</span> clause and a <span class="code">HAVING</span> clause are included in a query. The <span class="code">WHERE</span> clause tells the query what information to include from the table, then, once the information is filtered and aggregate functions are applied to the fields, the <span class="code">HAVING</span> clause acts as a further filter for the aggregated data. To demonstrate this, let’s repeat the query above, but this time let’s select only cities beginning with the letter <span class="italic">B</span>, then, from that list, show invoices with totals averaging more than five (Figure 110).</p>

    <pre class="code-wrap">SELECT 
	BillingCity,
	AVG(Total) 
FROM
	invoices
WHERE 
	BillingCity LIKE 'B%'
GROUP BY
	BillingCity
HAVING 
	AVG(Total) &gt; 5	
ORDER BY 
	BillingCity</pre>

    <p class="h2_body">In this query we performed the same task, but this time we added a <span class="code">WHERE</span> clause to filter results to only cities starting with <span class="italic">B</span>. This filtering step is performed before the <span class="code">HAVING</span> and <span class="code">ORDER</span> <span class="code">BY</span> clauses are processed. Since we must filter before we can group, the order of these filtering clauses is important, and <span class="code">WHERE</span> most always comes before <span class="code">HAVING</span>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000058.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-275"><a id="calibre_link-110" class="calibre6"></a>Using <span class="h3heading_code">GROUP BY</span> with Multiple Fields</h3>

    <p class="h2_body">It is possible to group by more than one aggregate field at a time. Let’s say we want a more detailed breakdown of average invoices. We can write our query so that our aggregate data is grouped first by country and then by city. In the example below, we add another field, <span class="code">BillingCountry</span>, to our <span class="code">GROUP</span> <span class="code">BY</span> clause. Let’s see how our query functions.</p>

    <pre class="code-wrap">SELECT 
	BillingCountry,
	BillingCity,
	AVG(Total) 
FROM
	invoices
GROUP BY
	BillingCountry, BillingCity
ORDER BY 
	BillingCountry</pre>

    <p class="h2_body">As we can see in our result set (Figure 111), we have multiple entries for the same billing country, with the individual cities listed in the adjacent column. Grouping by multiple fields can be very useful when we desire a more detailed breakdown of information.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">Database files are likely to contain spelling and/or capitalization errors.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000074.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-276"><a id="calibre_link-111" class="calibre6"></a>A Final Word on Functions</h3>

    <p class="h2_body">This section is by no means exhaustive, but hopefully it showed you the power of functions and their ability to turn data into information and answer real-world questions. If we were to go over all the functions in SQLite and give an example of each, we would have to provide a carrying device for this book with some sturdy wheels. Fortunately, there is a wealth of information online about SQL functions and their use. I often encourage students, in addition to using the SQLite documentation website referred to in this chapter, to perform a web search for functions to see what other people have done with them. Hopefully this chapter has sparked your interest and you can continue your learning journey on your own and discover even more ways to use these powerful tools.</p>

    <h3 class="h1" id="calibre_link-277"><a id="calibre_link-112" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">Create a single-line mailing list for all US customers, including capitalized full names and full addresses with five-digit zip codes, in the following format: <p class="numbered-cont">FRANK HARRIS 1600 Amphitheatre Parkway, Mountain View, CA 94043 </p></li>

      <li class="numbered">What are the average annual sales generated by customers from the USA from all years of data available?</li>

      <li class="numbered">What are the company’s all-time total sales?</li>

      <li class="numbered-3-sa">Who are the top ten best customers from a revenue standpoint? <span class="italic">Hint: </span>you will need to use a join (chapter 6) to answer this question. </li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Functions allow you to alter, reformat, and perform calculations on the data in your tables.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Queries containing numerical data can be manipulated with a variety of arithmetic operations and aggregate functions. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Queries containing text can be split, concatenated, capitalized, etc.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Once data is aggregated with functions, it can be further sorted by the <span class="code">GROUP</span> <span class="code">BY</span> and <span class="code">HAVING</span> clauses.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">HAVING</span> clause does for aggregate fields what the <span class="code">WHERE</span> clause does for non-aggregate fields. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">HAVING</span> clause can be used in a query only if a <span class="code">GROUP</span> <span class="code">BY</span> clause is also present. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">You can use <span class="code">GROUP</span> <span class="code">BY</span> with multiple fields to further narrow down your aggregated data.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div class="calibre1" id="calibre_link-27">

  <section type="part" id="calibre_link-278" class="calibre2">

    <figure class="vertical-image-wrap" type="z3998:figure">

      <img alt="PART III - MORE ADVANCED SQL TOPICS" class="portrait" src="images/000098.jpg" />

    </figure>

  </section>

</div>



<div id="calibre_link-29" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-279"><a id="calibre_link-113" class="calibre6"></a>| 8 | </h2>

    <p class="chapter-title" id="calibre_link-280"><a id="calibre_link-281" class="calibre6"></a>Subqueries</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Subqueries and aggregate functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item"><span class="code">SELECT</span> statement subqueries</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item"><span class="code">WHERE</span> clause subqueries</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Subqueries without aggregate functions</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Returning multiple values</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Subqueries and the <span class="code">DISTINCT</span> keyword</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">A subquery is simply one query nested inside of another query, usually in the <span class="code">SELECT</span>, <span class="code">FROM</span> or <span class="code">WHERE</span> clause. Subqueries are useful when the query we want to create requires a few additional steps or calculations to produce the dataset we desire. For example, subqueries are very helpful for scenarios where we want to view or compare a query by a condition that requires its own query to calculate. Instead of writing one query, then copying the results into the next query, we can use a subquery that performs both operations at once. Subqueries also provide us with another method of simultaneously accessing data from more than one table. Although a subquery is not as powerful as a join, it can help us perform a calculation in one table and then use that calculation in conjunction with another table. Let’s begin our exploration of subqueries by looking at their use with aggregate functions.</p>

    <h3 class="h1" id="calibre_link-282"><a id="calibre_link-114" class="calibre6"></a>Introduction to Subqueries Using Aggregate Functions</h3>

    <p class="h2_body">To illustrate the use of subqueries, we will begin with a simple <span class="code">SELECT</span> statement that we used in the last chapter to return the average invoice total from the invoices table:</p>

    <pre class="code-wrap">SELECT 
	ROUND(AVG(Total), 2) AS [Average Total]
FROM
	invoices</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000093.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We add the <span class="code">ROUND(</span><span class="code">)</span> function to round the <span class="code">AVG(</span><span class="code">)</span> function to two significant figures.</p>

    </div>

    <p class="h2_body">We can see that our sample query gives us an average invoice value of $5.65 from the <span class="italic">invoices</span> table. Let’s say we were asked by our sTunes company to gather data about all invoices that were lower than this average. First, we need a <span class="code">SELECT</span> statement that displays some of the invoice fields (such as <span class="code">InvoiceDate</span>, <span class="code">BillingAddress</span>, <span class="code">BillingCity</span>, and, of course, <span class="code">Total</span>). We would then want to filter our results by comparing them to an aggregate function. We want a <span class="code">WHERE</span> clause that compares <span class="code">Total</span> to <span class="code">AVG(Total)</span>. We learned in the last chapter that attempting a direct comparison within the <span class="code">WHERE</span> clause using a statement such as <span class="code">WHERE Total &lt; AVG(Total)</span> would be incorrect and cause a “misuse of aggregate function” error. So we need a way to take the entire query listed above and insert all of it inside another query that sorts invoices by total. Fortunately, there is an easy way to accomplish this.</p>

    <p class="h2_body">We start by writing a basic <span class="code">SELECT</span> statement and then inserting the entire query above into our <span class="code">WHERE</span> clause using parentheses <span class="code">()</span>, making it function as a subquery.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total	
FROM
	invoices
WHERE Total &lt;
(select  
	AVG(Total)	
from 
	invoices)
ORDER BY
	Total DESC</pre>

    <p class="h2_body">The query that we surround with parentheses is called the <span class="italic">inner query,</span> which will become part of the <span class="code">WHERE</span> clause of our <span class="italic">outer query</span>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000111.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000030.png" />

      </figure>

      <p class="note">In Figure 113, we capitalized our <span class="code">SELECT</span> statement and other operators in our outer query, but our statements and functions inside of our inner query are all in lowercase. There is no universal rule about whether your operators or functions should be capitalized or not. The RDBMS doesn’t mind either way. I personally find that using capital letters for outer query operators and functions and lowercase letters for subqueries increases readability. It helps to visually differentiate between the outer and inner query statements.  </p>

    </div>

    <h3 class="h1" id="calibre_link-283"><a id="calibre_link-115" class="calibre6"></a>Using a Subquery in the <span class="h3heading_code">SELECT</span> Statement</h3>

    <p class="h2_body">If the items in our select statement require an additional step (such as an aggregate calculation), then we will need a subquery to perform that calculation. In the last chapter on functions, we used the <span class="code">GROUP</span> <span class="code">BY</span> statement to show average subtotals of invoices by city. What if we were asked by our sTunes company how each individual city was performing against global average sales? One way to answer that question would be to write a query that was able to display the average sales of each city right next to the global average. </p>

    <p class="h2_body">The query we write to display the average sales by <span class="code">BillingCity</span> is identical to the one we wrote in the previous chapter, with one exception. We also include a subquery in the <span class="code">SELECT</span> clause to calculate the global average. This way we can compare the two values.</p>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total) AS [City Average],
	(select 
		avg(total) 
	from 
		invoices) AS [Global Average]
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <p class="h2_body">Running this query shows how each city performs against the global average.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000130.jpg" />

    </figure>

    <p class="h2_body">You can see from this output that the numerical value for “Global Average” remains the same in each record returned, making it easy for us to compare the average invoice totals by city against the global average.</p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Modify this query with the <span class="code">ROUND(</span><span class="code">)</span> function to display only two decimal points.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-284"><a id="calibre_link-116" class="calibre6"></a>Using a <span class="h3heading_code">WHERE</span> Clause in a Subquery</h3>

    <p class="h2_body">There will be times when we want to have a more detailed query function as our subquery. Our outer query can have a <span class="code">WHERE</span> clause which, in turn, contains a subquery with its own <span class="code">WHERE</span> clause. A good example of when we would want a <span class="code">WHERE</span> clause in a subquery is when we want to compare all fields to a specific instance. Let’s say that we were asked to find the all-time largest sale from our dataset (2009&ndash;2012) and to see if there are any invoice totals in the latest year of records (2013) that are higher than that value. To answer this question, we would first have to get the largest sale prior to 2013. We can do that with the <span class="code">MAX(</span><span class="code">)</span> function.</p>

    <pre class="code-wrap">SELECT  
	MAX(Total)	
FROM  
	invoices
WHERE 
	InvoiceDate &lt; '2013-01-01'</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000148.jpg" />

    </figure>

    <p class="h2_body">Now that we know this value, we wrap this query in parentheses <span class="code">()</span> and then write our outer query and include the additional fields that we need. </p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingCity,
	Total
FROM
	invoices
WHERE  
	InvoiceDate &gt;= '2013-01-01' AND total &gt;
	(select 
		max(Total)	
	from 
		invoices
 	where  
		InvoiceDate &lt; '2013-01-01')</pre>

    <p class="h2_body">We can see from this query that we broke our record for highest invoice total on November 13, 2013. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000164.jpg" />

    </figure>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How many invoices were recorded on or before January 1, 2010, that were above the average invoice amount?</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-285"><a id="calibre_link-117" class="calibre6"></a>Subqueries without Aggregate Functions</h3>

    <p class="h2_body">A subquery does not always contain an aggregate function. The following query shows the transaction date for a specific transaction.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate
FROM 
	invoices
WHERE 
	InvoiceId = 251</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000001.jpg" />

    </figure>

    <p class="h2_body">If we wanted to see if there were any other invoices that were received after the invoice referenced above, we would build a subquery wrapped in a pair of parentheses and then build an outer query around it.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity
FROM
	invoices
WHERE  
	InvoiceDate &gt;
(select 
	InvoiceDate
from
	invoices
where
	InvoiceId = 251)</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000016.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-286"><a id="calibre_link-118" class="calibre6"></a>Returning Multiple Values from a Subquery</h3>

    <p class="h2_body">Up to this point we have only used subqueries to calculate a singular value, which is then passed to the outer query. It is possible to use subqueries that return multiple records. Let’s say our sTunes management is interested in three particular invoices. To select those three invoices, consider the following query. </p>

    <pre class="code-wrap">SELECT 
	InvoiceDate
FROM 
	invoices
WHERE 
	InvoiceId IN (251, 252, 255)</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000032.jpg" />

    </figure>

    <p class="h2_body">The preceding query uses the <span class="code">IN</span> clause to return three dates from the <span class="italic">invoices</span> table: 2012-01-09, 2012-01-22, and 2012-01-24. Now let’s say we are asked if any other purchases were made on those three days. If we want to select all invoices for those three days, we can start a new query, or just use our previous query as a subquery, like this:</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity
FROM
 	invoices
WHERE  
	InvoiceDate IN
(select 
	InvoiceDate
from
	invoices
where
	InvoiceId in (251, 252, 255))</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000065.jpg" />

    </figure>

    <p class="h2_body">The technique of turning an existing query into a subquery is useful when you are “dialing in” on your data. This method allows you to reuse an existing query and modify it to further narrow down your search.</p>

    <h3 class="h1" id="calibre_link-287"><a id="calibre_link-119" class="calibre6"></a>Subqueries and the <span class="h3heading_code">DISTINCT</span> Clause</h3>

    <p class="h2_body">As we have seen from the other examples in this chapter, subqueries are very helpful for scenarios where you want to view or compare a query by a condition that requires its own query to calculate. As we learned in chapter 1, there is usually one unique field in every table known as the primary key that contains a unique number for every record, but other fields can have redundant information. To work better with redundant information, it is often convenient to filter this data so that it only displays unique, or distinct, values. This is where the <span class="code">DISTINCT</span> keyword comes in. To demonstrate subqueries and the <span class="code">DISTINCT</span> keyword, let’s look at the <span class="italic">tracks</span> and <span class="italic">invoice_items</span> tables. </p>

    <p class="h2_body">The <span class="italic">invoice_items</span> table shows us which individual sTunes tracks were purchased on each invoice. If we create a query that shows us the <span class="code">InvoiceId</span> and <span class="code">TrackId</span> fields ordered by <span class="code">TrackId</span>, we can see that certain track numbers were ordered multiple times across different invoices. </p>

    <pre class="code-wrap">SELECT  
	InvoiceId,
	TrackId 
FROM 
	invoice_items
ORDER BY
	TrackId</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000081.jpg" />

    </figure>

    <p class="h2_body">For example, we can see that tracks #2 and #8 appear on multiple invoices, meaning they were ordered multiple times (Figure 121). However, track #7 does not appear to have an invoice available, so we can infer that no one in our record set has purchased it. Our sTunes management is interested in discovering which tracks are not selling. We would need to find a table that links <span class="code">TrackId</span> with <span class="code">InvoiceId</span>. We could use subqueries to list all tracks (by composer and name) that don’t appear in the<span class="italic"> invoice_items</span> table. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000100.jpg" />

    </figure>

    <p class="h2_body">If we run the same query again, this time with the keyword <span class="code">DISTINCT</span>, we will get a list of only those tracks that appear on invoices without any of the duplicates. </p>

    <pre class="code-wrap">SELECT  
	DISTINCT TrackId 
FROM 
	invoice_items
ORDER BY
	TrackId</pre>

    <p class="h2_body">We can see again that some <span class="code">TrackId</span> numbers (such as #7) do not appear in any invoices, but all the listings of tracks that appear on multiple invoices are reduced to just one instance. Now we need a query that lists all tracks from our <span class="italic">tracks</span> table that are <span class="code">NOT</span> <span class="code">IN</span> the list created by our first query. </p>

    <pre class="code-wrap">SELECT 
	TrackId,
	Composer,
	Name
FROM 
	tracks
WHERE 
	TrackId NOT IN 
		(select distinct 
			TrackId 
		from
			invoice_items)</pre>

    <p class="h2_body">We now have a list of songs that didn’t appear on any invoice (Figure&nbsp;123). Looking at our results, we can see that the track we identified previously, track #7, is at the very top of the list of tracks that did not sell. Now our sTunes sales team has a clear picture of what songs have not been purchased. </p>

    <p class="h2_body">The examples of subqueries given in this chapter are obviously not exhaustive. There are many more ways to use subqueries, but all the examples given share a common theme. Subqueries can make complex multistep calculations achievable with just one query. They allow you to calculate a specific condition and then compare a new set of data against that same condition.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000118.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Subqueries give us another quick way of interacting between tables that have key fields in common. If we were doing extensive work with both tables, it would be better to create a join between the <span class="code">TrackId</span> and the <span class="italic1">tracks</span> table (instead of using subqueries) so we could display all the information side by side. </p>

    </div>

    <h3 class="h1" id="calibre_link-288"><a id="calibre_link-120" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">How many invoices exceed the average invoice amount generated in 2010?</li>

      <li class="numbered">Who are the customers responsible for these invoices?</li>

      <li class="numbered-3-sa">How many of these customers are from the USA?</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Subqueries allow you to execute multiple SQL statements within a single query.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Subqueries are comprised of two or more separate SQL statements identified as inner and outer queries.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Subqueries are usually used to compare existing data with data you derive with aggregates or other functions.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">DISTINCT</span> keyword allows you to ignore redundant data in records and search for unique instances only.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-3" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-289"><a id="calibre_link-121" class="calibre6"></a>| 9 | </h2>

    <p class="chapter-title" id="calibre_link-290"><a id="calibre_link-291" class="calibre6"></a>Views</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Creating views</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Modifying existing views</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Views and joins</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Removing views</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">A view is referred to as a virtual table. It is simply an SQL query that is saved and can be executed repeatedly or referenced (as a subquery) by other queries. Views are helpful when you find yourself repeatedly constructing the same query, especially if the query is complex or difficult to write. In our operation scenario, if sTunes company management asks us for the same sales data every week or quarter, we might want to prepare a view with that information precalculated. Let's examine the many ways we can incorporate views into our existing SQL knowledge.</p>

    <h3 class="h1" id="calibre_link-292"><a id="calibre_link-122" class="calibre6"></a>Turning Previous Queries into Views</h3>

    <p class="h2_body">The SQL statements we have introduced in previous chapters can all be saved and reused when we create a view out of them. Let’s take a look at the query featured in the beginning of chapter 8.</p>

    <pre class="code-wrap">SELECT
	ROUND(AVG(Total), 2) AS [Average Total]
FROM
	invoices</pre>

    <p class="h2_body">We can turn this statement into a view by adding <span class="code">CREATE VIEW </span><span class="code">V</span><span class="code">_AvgTotal AS</span> above the top line of the query: </p>

    <pre class="code-wrap">CREATE VIEW V_AvgTotal AS
SELECT
	ROUND(AVG(Total), 2) AS [Average Total]
FROM
	invoices</pre>

    <p class="h2_body">We have now created a view called <span class="code">V</span><span class="code">_</span><span class="code">AvgTotal.</span></p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Naming views beginning with <span class="code">V</span><span class="code">_</span> is a useful naming convention because it lets anyone reading our code know that they are dealing with a view. After the underscore symbol, we include a brief description of how the view functions, using further underscores if needed. We could also name this view <span class="code">V</span><span class="code">_</span><span class="code">AvgTota</span><span class="code">l</span><span class="code">_</span><span class="code">Rounded</span>. Choose whatever makes the most sense to you.</p>

    </div>

    <p class="h2_body">When we execute this statement, we get a message that says “<span class="code">Query executed</span> <span class="code">successfully:</span> <span class="code">CREATE</span> <span class="code">VIEW</span> <span class="code">V_</span><span class="code">AvgTotal</span> <span class="code">AS.</span>” If we then look in our Database Structure tab in DB Browser, the view <span class="code">V</span><span class="code">_AvgTotal</span> can be observed under a section called Views.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000137.jpg" />

    </figure>

    <p class="h2_body">Now that this view is created, there are some simple tasks we can perform just by right-clicking on it. When we right-click on the view, we get the following menu box (Figure 125):</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000155.jpg" />

    </figure>

    <p class="h2_body">Selecting the “Browse Table” option will move us to the adjacent Browse Data tab where we can investigate the contents of our view, as we would with any table in the database. From this menu, we can also delete the view or generate a copy of the code (which we typed earlier) that created it.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Figure 125 shows a “Modify View” option that (at the time of publication) is grayed out and inaccessible. Modifying existing views is not a feature supported by the version of DB Browser we are currently using. However, in other implementations of SQL, such as SQL Server, it is possible to modify existing views. We will explain how to modify a view in SQLite later in this chapter.</p>

    </div>

    <h3 class="h1" id="calibre_link-293"><a id="calibre_link-123" class="calibre6"></a>Why We Use Views</h3>

    <p class="h2_body">Views are helpful for a number of reasons, but convenience is definitely the main one. If you find yourself repeatedly writing the same query, or continually referring to a particular join that shows how two tables interact together, it may be convenient to save that query as a view so that it can be referenced when you need it. Also, when a query is saved as a view, it can be called up as a subquery by selecting the view name. </p>

    <p class="h2_body">Let’s refer back to the view <span class="code">V</span><span class="code">_</span><span class="code">AvgTotal</span> that we created at the beginning of this chapter. You may remember from chapter 8 that we used the average function as a subquery so that we could compare the totals of invoices against the average total of all invoices. Instead of writing out the full average subquery in our statement, we could write our query this way instead:</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	Total	
FROM
	invoices
WHERE Total &lt; 
	(select 
		* 
	from 
		V_AvgTotal)
ORDER BY
	Total DESC</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Even though our view is a complete SQL statement, we still need to reference it in a <span class="code">SELECT</span> statement when using it with subqueries. We use the * symbol in <span class="code">SELECT</span> statements to get views to return all rows from the view being referenced. In this case, there is only one row, which is our aggregate sum. This allows us to select only parts of a view.</p>

    </div>

    <p class="h2_body">If any query is one we frequently use as a subquery, then establishing it as a view allows us to simplify our code and make what we are doing more transparent. If anyone (a coworker, for example) wants to look under the hood, they can simply navigate to the Database Structure tab and investigate how our views function. Using views cuts down on creation time, especially as our queries get longer and more advanced.</p>

    <h3 class="h1" id="calibre_link-294"><a id="calibre_link-124" class="calibre6"></a>How to Modify a View</h3>

    <p class="h2_body">As we mentioned earlier, the current iteration of DB Browser (at the time of this writing) does not support modifying existing views. As a workaround in SQLite, we would need to create a new view and give it a new name, or delete the existing view. To modify a view in SQLite, we would navigate to the Database Structure tab, right-click on the view, and copy the <span class="code">CREATE</span> <span class="code">VIEW</span> statement. We could then paste the results into our Execute SQL tab, make our modifications, and run the statement again.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">When re-running your view, if you still have the original view saved in the Views section, you will have to rename your new view (or remove the existing view) or else you will get an error telling you that your view already exists. All views need unique names.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Modify the <span class="code">V</span><span class="code">_</span><span class="code">AvgTotal</span> view to remove the <span class="code">ROUND()</span> function.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Pick a different subquery example from chapter 8, turn the subquery portion into a view, and run it again.</p>

      </li>

    </ul>

    <h3 class="h1" id="calibre_link-295"><a id="calibre_link-125" class="calibre6"></a>Creating a View from Joins</h3>

    <p class="h2_body">Views are very good for storing longer or more involved queries. In chapter 6, we learned about joins. Joins are excellent candidates to add as views because they help us visualize the relationships between tables and they also can be very extensive queries that we might want to save instead of typing again. In the last chapter on subqueries, we used the <span class="italic">invoice_items</span> table and the <span class="italic">tracks</span> table together to find out which songs from our <span class="italic">tracks</span> table had never been ordered. It would have been helpful to have a view linking those two tables together that we could have either referenced in our subquery or just saved as a view to refer to when needed.</p>

    <p class="h2_body">To create a view for these two tables, we first need to decide what kind of join we want to use. Since we are looking for correlating fields, we will use an <span class="code">INNER</span> <span class="code">JOIN</span> on <span class="italic">tracks</span> and <span class="italic">invoice_items</span>. </p>

    <pre class="code-wrap">SELECT 
	ii.InvoiceId,
	ii.UnitPrice,
	ii.Quantity,
	t.Name,
	t.Composer,
	t.Milliseconds
FROM 
	invoice_items ii
INNER JOIN 
	tracks t
ON ii.TrackId = t.TrackId</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">When we create joins, we use short aliases for each table involved and then relate the tables to each other using a common field. We use t for <span class="italic1">tracks</span> and ii for <span class="italic1">invoice_items</span> since we are already using i for the <span class="italic1">invoices</span> table.</p>

    </div>

    <p class="h2_body">Now that we have our join, we can add one more line at the beginning of the query to save it as a view. </p>

    <pre class="code-wrap">CREATE VIEW V_Tracks_InvoiceItems AS
SELECT 
	ii.InvoiceId,
	ii.UnitPrice,
	ii.Quantity,
	t.Name,
	t.Composer,
	t.Milliseconds	
FROM 
	invoice_items ii
INNER JOIN 
	tracks t
ON ii.TrackId = t.TrackId</pre>

    <p class="h2_body">Next, we are going to take an existing join from chapter 6, one that merges the <span class="italic">invoices</span>, <span class="italic">customers</span>, and <span class="italic">employees</span> tables, and save that as a view as well. </p>

    <pre class="code-wrap">CREATE VIEW V_inv_cus_emp AS
SELECT 
	i.InvoiceId,
	i.InvoiceDate,
	i.Total,
	i.CustomerId,
	c.FirstName,
	c.LastName,
	c.SupportRepId,
	e.EmployeeId,
	e.LastName,
	e.FirstName,
	e.Title
FROM 
	invoices AS i
INNER JOIN
	customers AS c 
ON
	i.CustomerId = c.CustomerId
INNER JOIN 
	employees AS e
ON
	e.EmployeeId = c.SupportRepId
ORDER BY 
	InvoiceDate</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">We have made a slight modification from the way this join was presented in chapter 6. We have removed the * symbol from the <span class="code">SELECT</span> statement. The point of views is to show just what you need. So we have included only the relevant fields from <span class="italic1">invoices</span>, <span class="italic1">customers</span>, and <span class="italic1">employees</span>. </p>

    </div>

    <p class="h2_body">We can see that we have both of these joins saved as views in our Database Structure tab (Figure 126).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000171.jpg" />

    </figure>

    <p class="h2_body">Now that we have these two joins saved as views, we use both of them in an inner join:</p>

    <pre class="code-wrap">SELECT *
FROM 
	V_Tracks_InvoiceItems ii
INNER JOIN 
	V_inv_cus_emp ice
ON
	ii.InvoiceId = ice.InvoiceId</pre>

    <p class="h2_body">With the above query joining five tables together, we can now know what tracks were sold by each employee and which customer they were sold to. By aggregating the data, we can also determine which track was sold the most, how much total revenue was generated by the track, and the employee responsible for each sale. We can now go even further and save our aggregation as a view if we want to. 	</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Joins between multiple views will only work if the key fields held in common from all of these tables were included in the initial join.</p>

    </div>

    <h3 class="h1" id="calibre_link-296"><a id="calibre_link-126" class="calibre6"></a>Removing a View Using the DROP Statement</h3>

    <p class="h2_body">Although we have shown that you can remove a view by right-clicking on the view name in the Database Structure tab, a view can also be removed by using a statement called the <span class="code">DROP</span> clause. To use this command, we type the following:</p>

    <pre class="code-wrap">DROP VIEW
	V_AvgTotal</pre>

    <p class="h2_body">The previous statement will delete the <span class="code">V</span><span class="code">_</span><span class="code">AvgTotal</span> view. Only the view is removed from the database&mdash;no data is affected by using the <span class="code">DROP</span> <span class="code">VIEW</span> syntax.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If you remove a view that is referenced by other views, those views will not function anymore.</p>

    </div>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">The <span class="code">DROP</span> command is a command to remove elements. It can also remove your tables. See the next chapter for best practices concerning tools that edit or remove data permanently. As mentioned earlier, a view can also be removed from your database by right-clicking on it and selecting “Remove View.”</p>

    </div>

    <h3 class="h1" id="calibre_link-297"><a id="calibre_link-127" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <p class="h2_body">For this checkpoint, we will be using a query from chapter 8: Using a Subquery in the <span class="code">SELECT</span> Statement. We have reproduced it here:</p>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total) AS [City Average],
	(select 
		avg(total) 
	from 
		invoices) AS [Global Average]
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <ol class="calibre10">

      <li class="numbered">Take the inner query (by itself) from this <span class="code">SELECT</span> statement and create a view from it. Save the view as <span class="code">V</span><span class="code">_</span><span class="code">GlobalAverage</span>.</li>

      <li class="numbered">Remove the subquery from the above code entirely and substitute it for your newly created view <span class="code">V</span><span class="code">_</span><span class="code">GlobalAverage</span>.</li>

      <li class="numbered">Save this new query as a view called <span class="code">V</span><span class="code">_</span><span class="code">CityAvgVsGlobalAvg</span>.</li>

      <li class="numbered-3-sa">Delete the view <span class="code">V</span><span class="code">_</span><span class="code">GlobalAverage</span>. What happens to <span class="code">V</span><span class="code">_CityAvgVsGlobalAvg</span>?</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Views are virtual queries created with SQL that can be selected by other queries.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Views are created by adding <span class="code">CREATE VIEW </span><span class="code">V</span><span class="code">_</span><span class="code">viewname</span><span class="code"> AS</span> at the beginning of a query.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">View are particularly useful for long queries that may be used or referred to frequently.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">Views can be modified and deleted by using features from your RDBMS implementation or by using SQL commands.</p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-37" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-298"><a id="calibre_link-128" class="calibre6"></a>| 10 | </h2>

    <p class="chapter-title" id="calibre_link-299"><a id="calibre_link-300" class="calibre6"></a>Data Manipulation Language (DML)</p>

    <div class="chapteroverview-wrap">

      <h3 class="chapteroverview-title"><b class="calibre8">Chapter Overview</b></h3>

      <ul class="marked">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Caution</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">The role of DML</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Inserting data</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Updating data</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Deleting data</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item">Data Analysis Checkpoint</p>

        </li>

      </ul>

    </div>

    <p class="p">All SQL statements we have presented so far have been used in a way that either retrieves data from the database or creates derived data based on existing database values. This chapter introduces <span class="bold-italic">data manipulation language (DML) </span>and examines SQL statements that are used to change or alter the data that is stored in the tables of a database. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">It is best to practice these commands in a sandbox space, such as the sample database provided. Using DML on a live database with active customer data could have permanent deleterious effects. </p>

    </div>

    <h3 class="h1" id="calibre_link-301"><a id="calibre_link-129" class="calibre6"></a>Data Analysis Versus Database Management</h3>

    <p class="h2_body">Throughout this book so far, the primary purpose of our SQL queries was to take existing data in our database and turn it into actionable information that would be useful to the fictional stakeholders at our sTunes company. But as we mentioned in the introduction, the functions of SQL far exceed the task of turning data into meaningful information. There are roles such as database developer and database administrator that oversee the growth, improvement, and management of the company database. The extent and scope of these roles differ from company to company and from one database implementation to another. Even among experienced SQL users, there are differing opinions about whether DML is a separate field of study or if it should be learned in tandem with SQL statements designed to extract information only. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000030.png" />

      </figure>

      <p class="note">The different database roles can be a point of confusion for beginners. DML fits neatly into the category of database administration and development, but in a smaller company employing just one database, the roles of data analyst, developer, and administrator may all be assigned to one person, and that person might be you! So even if your main goal is just to learn how to write useful select queries, it is valuable at the very least to understand how DML works. </p>

    </div>

    <p class="h2_body">For the purpose of this chapter, statements that are referred to as data manipulation language (DML) are <span class="code">INSERT</span>, <span class="code">UPDATE</span>, and <span class="code">DELETE</span>. As the names imply, these statements can be used to add, modify, and remove data from the tables in your database. For our sTunes operational scenario, we will demonstrate how we would handle a request from sTunes management to add additional artists to our existing music offerings, add new records, and then delete those records. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">In DB Browser, making any changes to the sTunes database using DML will prompt the program to ask if you want to save your changes when you exit the program or close the database file. You can make a copy of the original database file so that you can practice these modifications, save them, and still retain the original. </p>

    </div>

    <h3 class="h1" id="calibre_link-302"><a id="calibre_link-130" class="calibre6"></a>Inserting Data into a Database</h3>

    <p class="h2_body">The <span class="code">INSERT</span> statement is used to insert data into a table one row at a time. There are a couple of ways to compose an <span class="code">INSERT</span> statement. One way is using <span class="code">INSERT</span> <span class="code">INTO</span> and specifying the desired field. Let’s say our sTunes company is expanding their music selection and wants us to add some additional artists to the <span class="italic">artists</span> table. </p>

    <p class="h2_body">The following <span class="code">INSERT</span> statement will insert a new record into the <span class="italic">artists </span>table.</p>

    <pre class="code-wrap">INSERT INTO
artists (Name)
VALUES ('Bob Marley')	</pre>

    <p class="h2_body">There are three elements to this insertion: a table, a field, and a value. The table <span class="italic">artists</span> is specified after the keywords <span class="code">INSERT</span> <span class="code">INTO</span>. This identifies which table we want to modify. This is followed by the field name surrounded by parentheses <span class="code">()</span>. In this case, we want to add a new artist by adding the artist’s name to the <span class="code">Name</span> field. This is then followed by the keyword <span class="code">VALUES</span>, where opening and closing parentheses surround the actual value that is being inserted into the <span class="italic">artists</span> table. In this example, the value is Bob Marley. “Bob Marley” is a text value, so it is also surrounded by single quotes.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We can check on the data type of the <span class="code">Name</span> field in the <span class="italic1">artists </span>table by looking at our Database Structure tab. We notice that the data type is <span class="code">NVARCHAR(120)</span>, which is a character data type with an expected limit of 120 characters.</p>

    </div>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the result of running the <span class="code">INSERT</span> statement above?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Write a <span class="code">SELECT</span> statement to find the newly inserted value.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Insert the value “Peter Tosh” into the <span class="italic">artists</span> table. </p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the <span class="code">ArtistId</span> value for the newly added Bob Marley record?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">There is a second column in the <span class="italic1">artists</span> table called <span class="code">ArtistId</span>. This column did not need to be specified in the <span class="code">INSERT</span> statement because it is an Auto Increment column. This means that a new number is automatically created in the column for new records that are added.</p>

    </div>

    <p class="h2_body">Another way to insert values into a table is to list the values sequentially by field name. If you insert data in this way, you do not have to specify the columns in which data is to be stored. However, when composing an <span class="code">INSERT</span> statement in this manner, special care must be taken to ensure that the order in which data is specified in the <span class="code">INSERT</span> statement is the same order in which the target fields exist in the table.</p>

    <p class="h2_body">The following <span class="code">INSERT</span> statement will also insert a new record into the <span class="italic">employees</span> table:</p>

    <pre class="code-wrap">INSERT INTO 
employees
VALUES ('9', 'Martin', 'Ricky', 'Sales Support Agent', '2', '1975-02-07', '2018-01-05', '123 Houston St', 'New York', 'NY', 'United States', '11201', '(347) 525-8588', '', 'rmartin@gmail.com')</pre>

    <p class="h2_body">As mentioned earlier, special care must be taken to ensure the order in which data is specified in the <span class="code">INSERT</span> statement matches the order of the fields in the target table. So as a precaution it is a good practice to examine the target table and take note of the order in which the fields appear.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000006.jpg" />

    </figure>

    <p class="h2_body">By checking the Database Structure tab, we can observe the structure of the <span class="italic">employees</span> table. The layout of the fields from <span class="code">EmployeeId</span> thru <span class="code">Email </span>must be specified in this exact order when using the <span class="code">INSERT</span> statement that was last introduced.</p>

    <p class="h3">ON YOUR OWN: </p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the result of the <span class="code">INSERT</span> statement when executed?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">The newly entered employee, Ricky Martin, does not have a fax number; how is this expressed in the <span class="code">INSERT</span> statement?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Insert another employee record into the <span class="italic">employees</span> table.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Run the query again, but use an existing primary key. What error message do you get?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">When inserting records where no value exists for a field, you still need to include a pair of empty quote marks ' ' for the value that does not exist. In the example above, we omitted the fax number by placing a pair of empty quotes in the same position that the fax number field appears in the <span class="italic1">employees</span> table.</p>

    </div>

    <h3 class="h1" id="calibre_link-303"><a id="calibre_link-131" class="calibre6"></a>Updating Data and the <span class="h3heading_code">SET</span> Keyword</h3>

    <p class="h2_body">The <span class="code">UPDATE</span> statement is used to modify existing data in a table. It is generally used with the <span class="code">WHERE</span> clause. The <span class="code">WHERE</span> clause is used with the <span class="code">UPDATE</span> statement to specify the particular rows of data you intend to update. Without the <span class="code">WHERE</span> clause, an <span class="code">UPDATE</span> statement will update all rows contained in a table.</p>

    <p class="h2_body">The following statement updates the employee record we inserted in the previous section.</p>

    <pre class="code-wrap">UPDATE 
employees
SET PostalCode = '11202'
WHERE
	EmployeeId = 9</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">If you haven’t added any employees yet, running this code will give you a “No Such Column” error. </p>

    </div>

    <p class="h2_body">In the previous syntax, the <span class="italic">employees</span> table is specified after the keyword <span class="code">UPDATE</span>. Next comes the keyword <span class="code">SET</span>, and this is where you specify the column within the<span class="italic"> employees</span> table that you intend to update; in our example it is the <span class="code">PostalCode</span> field. This is followed by an equals sign (<span class="code">=</span>) and the new value we intend to update the old value to. In our example this value is '11202' (surrounded with single quotes because zip code is a string value). Following the <span class="code">SET</span> keyword is the <span class="code">WHERE</span> clause, which allows us to specify exactly which employee record we intend to update. By specifying <span class="code">EmployeeId = 9</span> we ensure that only this employee record is updated and no other.</p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the result of the <span class="code">UPDATE</span> statement in our example above?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Compose another <span class="code">UPDATE</span> statement and change the phone number for Ricky Martin.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How many rows would be affected by our <span class="code">UPDATE</span> statement if it didn’t include a <span class="code">WHERE</span> clause?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">Particular importance must be paid to the inclusion of the <span class="code">WHERE</span> clause in <span class="code">UPDATE</span> statements. Without ensuring that a <span class="code">WHERE</span> clause is included and is specifying the intended record modification, you can update records you didn’t intend to, which can have significant adverse effects.</p>

    </div>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">Instead of executing an <span class="code">UPDATE</span> statement right away, first compose a <span class="code">SELECT</span> statement using the same table and <span class="code">WHERE</span> clause; this way you can preview what you are about to update. Once the <span class="code">SELECT</span> statement returns the expected records, you can then execute your <span class="code">UPDATE</span> statement.</p>

    </div>

    <h3 class="h1" id="calibre_link-304"><a id="calibre_link-132" class="calibre6"></a>Deleting Data</h3>

    <p class="h2_body">The <span class="code">DELETE</span> statement is used to remove existing records from a table. This statement, like <span class="code">UPDATE</span>, is generally used with the <span class="code">WHERE</span> clause. Without the <span class="code">WHERE</span> clause, a <span class="code">DELETE</span> statement will delete all rows contained in a table.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">As we did with <span class="code">UPDATE</span>, instead of executing a <span class="code">DELETE</span> statement right away, first compose a <span class="code">SELECT</span> statement using the same table(s) and a <span class="code">WHERE</span> clause; this way you can preview what you are about to delete. Once the select statement returns the expected records, you can then execute your <span class="code">DELETE</span> statement.</p>

    </div>

    <p class="h2_body">First, we create a <span class="code">SELECT</span> statement to verify the data we are about to remove. </p>

    <pre class="code-wrap">SELECT * FROM 
	employees
WHERE
	EmployeeId = 9</pre>

    <p class="h2_body">Once we are sure we want to remove this data, the following statement deletes the employee record we updated in the previous section.</p>

    <pre class="code-wrap">DELETE FROM 
	employees
WHERE
	EmployeeId = 9</pre>

    <p class="h2_body">The above <span class="code">DELETE</span> statement begins with two keywords, <span class="code">DELETE</span> <span class="code">FROM</span>, which is followed by the name of the table we intend to delete a record from. In our example, we are deleting a record from our <span class="italic">employees</span> table. Following the table name is the <span class="code">WHERE</span> clause, which allows us to specify exactly which employee record we intend to delete. By specifying <span class="code">EmployeeId = 9</span> we ensure that only this employee record is deleted and no other.</p>

    <p class="h3">ON YOUR OWN:</p>

    <ul class="marked">

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">What is the result of the <span class="code">DELETE</span> statement above, when executed?</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">Compose another <span class="code">DELETE</span> statement and remove all employees who are sales support agents.</p>

      </li>

      <li class="calibre7 pcalibre">

        <p class="marked-list-item">How many records were affected by the <span class="code">DELETE</span> statement you composed in the previous question?</p>

      </li>

    </ul>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">Particular importance must be paid to the inclusion of the <span class="code">WHERE</span> clause in <span class="code">DELETE</span> statements. Without ensuring that a <span class="code">WHERE</span> clause is included and is specifying the record(s) intended for deletion, you can delete records you didn’t intend to, which can have significant adverse effects.</p>

    </div>

    <h3 class="h1" id="calibre_link-305"><a id="calibre_link-133" class="calibre6"></a>Data Analysis Checkpoint</h3>

    <ol class="calibre10">

      <li class="numbered">Add a new customer to the database.</li>

      <li class="numbered">Create an invoice record for this customer.</li>

      <li class="numbered-3-sa">Remove this customer from the database.</li>

    </ol>

    <div class="break-before"></div>

    <div class="chapterrecap-wrap">

      <div class="calibre9"></div><h2 class="chapterrecap-title"><b class="calibre8">Chapter Recap</b></h2>

      <ul class="marked1">

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The statements in this chapter can permanently alter database data. Check carefully that this is your intention before using these statements. </p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">DML refers to the collection of clauses (<span class="code">INSERT</span>, <span class="code">UPDATE</span>, and <span class="code">DELETE</span>) capable of creating and manipulating existing data in a database.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">INSERT</span> statement is used to add new records to a database.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">UPDATE</span> statement can modify existing records and change the values.</p>

        </li>

        <li class="calibre7 pcalibre">

          <p class="marked-list-item1">The <span class="code">DELETE</span> statement removes records entirely. </p>

        </li>

      </ul>

    </div>

  </div>

</div>



<div id="calibre_link-35" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-306"><a id="calibre_link-134" class="calibre6"></a>Conclusion</h2>

    <h3 class="h1" id="calibre_link-307"><a id="calibre_link-135" class="calibre6"></a>It Is All About Asking Good Questions</h3>

    <p class="h2_body">If you have made it this far, you have seen how we can use Structured Query Language to turn lifeless entries in a database into meaningful information that you or your company can use to make the tough decisions that define every business venture. Throughout this book, I have tried to demonstrate how to write efficient but intelligent queries using real-world scenarios that showcase the methods that I myself have found useful and still use today. I have tried my best to avoid the philosophical debates, technicalities, and academic jargon that plague every body of technical knowledge in order to bring you by the purest and most expedient path to your own unique mastery of SQL. To the beginner: I hope you have enjoyed this journey we have taken together and that I have built a bridge for you to continue on your path to data mastery. To those with previous experience: I hope this book has highlighted a few insights and given you a sandbox to test your ever-growing SQL toolbox. In closing, I would like to share a few more practical insights and lessons I have learned over my eighteen years of working in the industry of information. It is my hope that the principles I’ve distilled from both the successes and mistakes I’ve made over the years will help steer you in the right direction when it comes to pursuing your next step of SQL mastery. In this section I will address some of the questions my students frequently ask me and talk briefly about further SQL education and certifications.</p>

    <h3 class="h1" id="calibre_link-308"><a id="calibre_link-136" class="calibre6"></a>Finding Your Niche</h3>

    <p class="h2_body">It is my hope that, throughout the course of this book, you have seen a wide variety of different applications of SQL. Some may interest you and others may not. Computer science was a very wide field when I started my own journey into the world of data eighteen years ago. At the time, I was working with Visual Basic and building applications; in other words, the front end, or visual interface, of software systems. Eventually I had to incorporate databases into these applications. Once I started working with Microsoft Access and experienced the way it helped me visualize data and how the tables were connected, it really opened my eyes to how data works and deepened my understanding of databases. As I gained more experience, I realized that data was the backbone of my work. Understanding the world of big data became an obsession for me. This might happen to you&mdash;in fact, I hope it does. I encourage my students to branch out to as many related programming disciplines as they may run into in their careers. The specialty that fits you the best may be one good question away! Your path is never a straight line. All the struggles, errors, and blunders along the way will help clarify what you find worthwhile.</p>

    <h3 class="h1" id="calibre_link-309"><a id="calibre_link-137" class="calibre6"></a>Choosing the Right Database Occupation</h3>

    <p class="h2_body">Although we have focused mainly on the role of the database analyst (using your skills in query composition, composing statements, and answering everyday questions), there is plenty of demand for database designers as well. If you have ever wondered who decides what fields will be contained in any given table, or how the tables will relate to each other, that is the job of a database designer/modeler. For example, in chapter 6 we introduced the concept of normalization, which is the prevention of data redundancy in multiple tables. Database management also deals with access restrictions, backups, and disaster recovery. These topics are beyond the scope of this book. If you find yourself curious to know more about how databases are made and maintained, then you may want to look more into database design as a career.</p>

    <h3 class="h1" id="calibre_link-310"><a id="calibre_link-138" class="calibre6"></a>Is It All about the Money?</h3>

    <p class="h2_body">Often when I am having discussions with students about careers in data, they ask me some form of this question: “Which particular database occupation or niche field is going to make me the most money?” Since I began teaching people in coffee shops, I’ve encountered a lot of people who are motivated by money. This is not a bad thing. It is a reasonable starting point, but not the big picture. Any occupation that pays well is going to take a lot of time and sacrifice. There are plenty of opportunities for people chasing the highest dollar. </p>

    <p class="h2_body">However, as my own personal experience has taught me, there are going to be several moments, perhaps late at night when you’re surrounded by empty coffee cups, when you are going to ask yourself, “Is this what I really wanted to do? Is this even worth it?” There will be moments, many of them, when you are pushed to your limits and you are going to question your decision about taking that job or career path, if your only motivation was money. Through trial and plenty of error, I’ve discovered that what pushes me through those rough moments has been ensuring that I can always link my current task with the passion for learning that brought me to this industry in the first place. In my own career path, I’ve found that helping others&mdash;more specifically, seeing my students’ faces light up as they reach that learning epiphany&mdash;gives me more satisfaction than the oftentimes repetitive nature of the corporate environment. Starting my own business and helping people directly, helping them feed that natural desire to learn, was much more fulfilling for me. But that was my experience. Your own path will be unique to you. </p>

    <p class="h2_body">Instead of just chasing the highest payout, I suggest you remind yourself, daily if necessary, of what drew your interest to this occupation in the first place. In other words, the more important question is what particular database occupation or niche field excites you or gives you the opportunity to create? There is a way to monetize your passions. The scope of this industry is comprehensive, so whether your interest is in medicine, sports, travel, or governmental policy, there will be a data analysis occupation waiting for you in any of those fields. </p>

    <h3 class="h1" id="calibre_link-311"><a id="calibre_link-139" class="calibre6"></a>Is SQL Knowledge Universal?</h3>

    <p class="h2_body">“What do I need to know before using my skills with a different SQL implementation?” I encounter this question frequently from students looking for a specific job opportunity. Perhaps the job application states that experience in a specific SQL implementation, such as SQL Server, is required. Although there are key differences in every database implementation, I encourage my students not to be discouraged or in any way deterred by requests for specific implementation knowledge. The core principles you have learned in this book will assist you no matter what database system you eventually find yourself working on. The beauty of SQL is that it is the universal language of data. If you find yourself working on a database implementation that isn’t SQLite, do not worry. Every implementation will have the same basic attributes you have learned in this book. Whatever the vendor, there will be an SQL pane to enter queries, a button to run statements, a place that gives you feedback on your query and how long it took to process. The result you receive will always be presented in columns and rows. The relational database structure you learned about in chapter 1 is an industry standard, and the database will be organized and normalized very similarly whether you are working with Oracle, IBM, Microsoft SQL Server, or any other vendor. Think of the different vendors and implementations (RDBMSs) as makes and models of different cars. The buttons and switches and cup holders might be in a slightly different place, but the fundamental mechanics, the brake and the gas pedal, will be in the same place and will operate as expected. The goal of SQL is to ask good questions. If you set your sights on this goal, the rest will fall into place. If you would like some further information on the subject of SQL implementations, there is a website called <a href="https://db-engines.com/en/ranking" class="calibre6"><span class="underline1">https://db-engines.com/en/ranking</span></a> that features a helpful tool to see which database implementations are currently the most utilized.</p>

    <h3 class="h1" id="calibre_link-312"><a id="calibre_link-140" class="calibre6"></a>Switching Careers</h3>

    <p class="h2_body">“If the bulk of my professional experience comes from a field far removed from SQL or programming, how do I convince my employer to give me a chance as a data analyst?” This is a concern I hear from many of my students that come from a completely different professional background and are just starting with data analysis. Data is far less removed from your previous profession than you think! Let’s say you were a bus driver. At first you may think a profession like this is far removed from that of a data analyst, but what we’ve seen is that the language of data has permeated everything. On every bus route, you have seen which stops have more people, which routes are the most efficient, etc. In any profession, the data is all around you. Even if your current line of work doesn’t have a database, you could start collecting information on every bus ride and present that information to your employer. Even if you come from a nontechnical field, you can use the skills you learned in this book to capture data from any walk of life and turn it into information. If a database doesn’t exist, you can create one!</p>

    <h3 class="h1" id="calibre_link-313"><a id="calibre_link-141" class="calibre6"></a>Selling Your New Skills to Your Company</h3>

    <p class="h2_body">I sometimes get questions from my students about how to convince their company to give them a chance with database access, particularly if they joined the company with a completely different job description. “I have explained that my queries will not change the database in any way, yet they are still reluctant to give me even read access. How do I change their minds?” As for the practical method of how to get the stakeholders of your business venture to buy into your new profession, this is usually not a problem, since databases are designed to be queried and accessed without changing the data. However, a company may choose to restrict database access to only a few key individuals. There are a variety of reasons database restrictions might occur, but in these cases, it is important to sell yourself and emphasize the value of turning data into information, as we have done in this book. Explain how what you are doing is going to save the company money in the long run. In most scenarios, databases have three environments: development, testing, and production. You can request access to the development environment or, if the database is quite small, ask for a copy. But there is a greater point here. Don’t let a small roadblock deter you from your goal; data is everywhere. As Bob Marley said, “When one door is closed, don’t you know another is open?” You might even be able to find a similar database in the same field as that of your company. There are public repositories of data (such as <a href="http://data.gov" class="calibre6"><span class="underline1">data.gov</span></a> for the United States) that will help you practice your skills.</p>

    <h3 class="h1" id="calibre_link-314"><a id="calibre_link-142" class="calibre6"></a>Beyond SQL: Data Visualization Software </h3>

    <p class="h2_body">There is much more developing in the world of data science other than just SQL. For the student eager to expand their skills beyond writing queries in a text-based SQL browser, data visualization is a good pathway. Presenting information is a pain point for many people. As you have seen from our use of DB Browser and the SQLite implementation, the backbone of SQL still very much exists in the highly functional but visually unappealing world of script-like programming languages.</p>

    <p class="h2_body">Data visualization software (also known as business intelligence software) is a hot field that is growing right now. Visualization can give new life to plain SQL statements. We have seen in this book that things like views can help you save frequently used queries and present information in a consistent and more organized way. Visualization software takes views one step further and gives you the ability to add bar charts, pivot tables, and other ways of displaying data. Visualization software also allows data to be displayed in real time so your fields and derivative visuals, such as charts or graphs, automatically update as the data changes. This beats the old way of copying data to a spreadsheet program like Excel and developing visuals from there. Figure 128 shows the names of a few popular data visualization software packages. This list is not exhaustive, but it will give you a good place to start. </p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000020.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-315"><a id="calibre_link-143" class="calibre6"></a>Interview Advice</h3>

    <p class="h2_body">I see a lot of online articles offering lists of technical things you “must know” before interviewing for any SQL-related job. Sometimes those “top ten technical skills you must know” are about as helpful as the “top ten animals that can kill you” lists found on any clickbait website. I do not consider myself someone who excels at highly technical interviews, such as the ones that ask you to memorize syntax and apply it to a very specific scenario. I consider myself much better at seeing the big picture, taking a technical challenge or business question presented and walking the interviewer through the steps required to get to the desired result. If the bar of acceptance or rejection to a career opportunity relies on memorization or a dramatic display of technical aptitude, this may be a red flag about how the company views its tech solutions. It is much better if the organization is more interested in the way that I solve problems in my own unique creative style than if I can commit syntax to memory. Some interviewers may focus on a specific tool, such as the syntax of a view, or may ask you to solve a problem using a certain type of SQL statement. This interviewing technique is shortsighted, in my opinion, focusing on muscle memory. It is much more valuable to see how creative a potential employee’s thought process is when applying a view or other SQL solution toward solving the problem. </p>

    <h3 class="h1" id="calibre_link-316"><a id="calibre_link-144" class="calibre6"></a>SQL Certifications </h3>

    <p class="h2_body">There are many different certification programs available for SQL and database administration. Examples of the most common certifications are the Microsoft Certified Solutions Associate (MCSA) and the Microsoft Certified Solutions Expert (MCSE). However, the Microsoft pathways are not the only options. There are other database platforms such as Oracle and IBM, which are also major players in the database sphere that offer certifications. Are certifications really necessary? Certification is not the only route to take in your SQL career. I firmly believe that you can get as much, if not more, value with a more practical approach. To me, the ability to actually use the language is more important than the certification. If your company uses IBM, go ahead and get the certification. But if you are not sure, then just focus on practicing solving real-world questions with whatever implementation you see yourself using.</p>

    <h3 class="h1" id="calibre_link-317"><a id="calibre_link-145" class="calibre6"></a>Final Thoughts and Parting Words</h3>

    <p class="h2_body">It is my sincere hope that you have enjoyed this book and that I have instilled in you some of the passion I have for this subject. If you would like to learn more about what we do at my data visualization company, and the training courses I offer, you can find me at <a href="http://datadecided.com" class="calibre6"><span class="underline1">http://datadecided.com</span></a> and <a href="https://sqltrainingwheels.com" class="calibre6"><span class="underline1">https://sqltrainingwheels.com</span></a>. It has been my pleasure to accompany you on this journey so far.</p>

  </div>

</div>



<div class="calibre1" id="calibre_link-10">

  <section type="part" id="calibre_link-318" class="calibre2">

    <figure class="wrap" type="z3998:figure">

      <img class="w" src="images/000092.png" />

    </figure>

    <h2 class="stop-section-title">REMEMBER TO DOWNLOAD<br class="calibre5" />YOUR FREE DIGITAL ASSETS!</h2>

    <figure class="wrap" type="z3998:figure">

      <img class="w" src="images/000163.jpg" />

    </figure>

    <div class="digitalassetsreference-wrap">

      <h3 class="stop-section-title1">DOWNLOAD DIGITAL ASSETS NOW:</h3>

      <p class="stop-section-link"><a class="underline" href="https://www.clydebankmedia.com/sql-assets">www.clydebankmedia.com/sql-assets</a></p>

      <p class="stop-section-note">* Must be a first time Audible user in the United States, United Kingdom, France or Germany. Audible membership is $14.95/month after the first 30 days. Easily cancel&nbsp;anytime.</p>

    </div>

  </section>

</div>



<div id="calibre_link-28" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-319"><a id="calibre_link-146" class="calibre6"></a>Appendix I </h2>

    <p class="subtitle">Data Analysis Checkpoint Questions and Solutions</p>

    <h3 class="h1" id="calibre_link-320"><a id="calibre_link-147" class="calibre6"></a>Chapter 3 Data Analysis Checkpoint</h3>

    <p class="body">Using the Database Structure tab and the Browse Data tab, try to answer the following questions:</p>

    <p class="body-sa"><span class="bold">Question 1:</span> How many tables are in our database?</p>

    <p class="body-sa"><span class="bold">Solution:</span> Looking at the Database Structure tab in DB Browser, the number of tables is calculated for us and presented in parentheses <span class="code">()</span>. There are thirteen tables in this database.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000036.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 2:</span> How many fields does the table named <span class="italic">tracks</span> have?</p>

    <p class="body-sa"><span class="bold">Solution:</span> For any of the tables listed, we can click on the small right-facing triangle to see the columns for that table.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000069.jpg" />

    </figure>

    <p class="body-sa">In this example, we observe that the table called <span class="italic">tracks</span> has nine columns.</p>

    <p class="body-sa"><span class="bold">Question 3:</span> What are some of the data types in this table?</p>

    <p class="body-sa"><span class="bold">Solution:</span> If we look at the image from the previous question, we can see that the <span class="code">TrackId</span> column accepts data of the type <span class="code">INTEGER</span> and the <span class="code">Name</span> column accepts data of the type <span class="code">NVARCHAR</span>. The rest of the columns are also <span class="code">INTEGER</span> and <span class="code">NVARCHAR</span> except for <span class="code">UnitPrice</span>, which is a <span class="code">NUMERIC</span> data type. </p>

    <p class="body-sa"><span class="bold">Question 4:</span> What does the actual data look like in the table?</p>

    <p class="body-sa"><span class="bold">Solution:</span> Now we can swap to the Browse Data tab and actually look at the table. We need to make sure to select the <span class="italic">tracks</span> table in the drop-down menu. Looking at the data in the table shows us why an <span class="code">INTEGER</span> data type is used for columns like <span class="code">TrackId</span> and <span class="code">AlbumId</span>, while a character data type makes more sense for the <span class="code">Name</span> and <span class="code">Composer</span> columns. Finally, for <span class="code">UnitPrice</span>, we needed something with decimals, so the integer data type wouldn’t have been sufficient for this column.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000087.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-321"><a id="calibre_link-148" class="calibre6"></a>Chapter 4 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> How many customers’ last names begin with <span class="italic">B</span>?</p>

    <p class="body-sa"><span class="bold">Solution:</span> In order to answer this question, we can first write a query to display the specific information we are looking for. In this case, we are interested in last names. Last names are contained in the <span class="italic">customers</span> table under the field name <span class="code">LastName</span>.</p>

    <p class="body-sa">If we simply want a query to display all the last names, we can do this:</p>

    <pre class="code-wrap">SELECT
	LastName
FROM
	customers</pre>

    <p class="body">That will give us a field of all the last names, but they aren’t in any particular order. To alphabetize them we can use the <span class="code">ORDER</span> <span class="code">BY</span> statement. Note that we don’t have to specify A-Z because ascending order is returned by default. If we were looking for names starting with Z, we might have included the <span class="code">DESC</span> statement.</p>

    <pre class="code-wrap">SELECT 
	LastName
FROM 
	customers
ORDER BY 
LastName ASC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000104.jpg" />

    </figure>

    <p class="body-sa">Now our results are alphabetized and we can easily see that four of the entries start with <span class="italic">B</span>. Note that we are still using observation to determine how many entries start with <span class="italic">B</span>. Other ways to do this will be explored further on. </p>

    <p class="body-sa"><span class="bold">Question 2:</span> When sorted in descending order, which company appears at the top, in the<span class="italic"> customers</span> table?</p>

    <p class="body-sa"><span class="bold">Solution:</span> This time we are looking for the <span class="code">Company</span> field instead of the <span class="code">LastName</span> field. As mentioned in the last question, all we have to do is change the last part of our query to specify descending order.</p>

    <pre class="code-wrap">SELECT
	Company
FROM 
	customers
ORDER BY 
	Company DESC</pre>

    <p class="body">Doing this yields the following result:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000122.jpg" />

    </figure>

    <p class="body-sa">We can observe that Woodstock Discos is the first company listed in descending order.</p>

    <p class="body-sa"><span class="bold">Question 3: </span>How many customers do not have a postal code listed?</p>

    <p class="body-sa"><span class="bold">Solution:</span> We could answer this question by scrolling through the data on Browse Data, but there is a better way. Using a <span class="code">SELECT</span> statement, we can list all the data in ascending order as we have done previously. But this time, we want to list more than just one column, so we can see what customer names have no postal code data. So we can choose <span class="code">FirstName</span>, <span class="code">LastName</span>, and <span class="code">PostalCode</span>, then order the results by <span class="code">PostalCode</span>.</p>

    <pre class="code-wrap">SELECT 
	FirstName,
	LastName,
	PostalCode
FROM 
    customers
ORDER BY
	PostalCode</pre>

    <p class="body-sa">This shows us four entries that do not have postal data, as designated by the null value in the <span class="code">PostalCode</span> column (Figure 134).</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000141.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If we were to list these in descending order, we would have to scroll to the bottom to see the null values.</p>

    </div>

    <h3 class="h1" id="calibre_link-322"><a id="calibre_link-149" class="calibre6"></a>Chapter 5 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> Create a query for th<span class="italic">e invoices</span> table that includes a <span class="code">CASE </span>statement that labels all sales from billing country USA as “Domestic Sales” and all other sales as “Foreign Sales.” Label your new field as <span class="code">SalesType</span> after your <span class="code">END</span> <span class="code">AS</span> statement.</p>

    <p class="body-sa"><span class="bold">Solution:</span> To display this information, we combine what we learned about filtering records by text with our <span class="code">CASE</span> statement. Since we are categorizing our <span class="code">CASE</span> statement by billing country, we will have to include that field in our <span class="code">SELECT</span> statement.</p>

    <pre class="code-wrap">SELECT
	InvoiceDate,
	BillingAddress,
	BillingCity,
	BillingCountry,
	Total,
	CASE 
	WHEN BillingCountry = 'USA' THEN 'Domestic Sales'
	ELSE 'Foreign Sales'
	END AS SalesType
FROM
	invoices</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000158.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 2:</span> Order this data by the new field <span class="code">SalesType</span>.</p>

    <p class="body-sa"><span class="bold">Solution:</span> To show all domestic sales in one group and all foreign sales in another group, we simply add an <span class="code">ORDER</span> <span class="code">BY</span> (using our new field) to our existing query:</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	BillingCountry,
	Total,
	CASE 
	WHEN BillingCountry = 'USA' THEN 'Domestic Sales'
	ELSE 'Foreign Sales'
	END AS SalesType
FROM 
	invoices
ORDER BY
	SalesType</pre>

    <p class="body-sa">Figure 136 shows the results for this query displaying "Domestic Sales" first, if you run this query and scroll down, you will see all countries other than USA labeled as "Foreign Sales.".</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000175.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 3:</span> How many invoices from Domestic Sales were over $15?</p>

    <p class="body-sa"><span class="bold">Solution:</span> We can use the same query again, but this time add a <span class="code">WHERE</span> clause and <span class="code">AND</span> to include both the numeric and text parameters.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	BillingAddress,
	BillingCity,
	BillingCountry,
	Total,
	CASE 
	WHEN BillingCountry = 'USA' THEN 'Domestic Sales'
	ELSE 'ForeignSales'
	END AS SalesType
FROM 
	invoices
Where 
	SalesType = "Domestic Sales" AND Total &gt; 15</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000009.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-323"><a id="calibre_link-150" class="calibre6"></a>Chapter 6 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> Using DB Browser and the Browse Data tab or the entity relationship diagram on page 95, view the <span class="italic">tracks</span> table. Identify which fields in that table are foreign keys in another table. Based on the foreign keys you have identified, which tables are related to the <span class="italic">tracks</span> table?</p>

    <p class="body-sa"><span class="bold">Solution:</span> Looking at the <span class="italic">tracks</span> table, we see three fields with integer values that appear to be foreign keys.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000025.jpg" />

    </figure>

    <p class="body-sa">The fields <span class="code">AlbumId</span>, <span class="code">MediaTypeId</span>, and <span class="code">GenreId</span> correspond to the <span class="italic">albums</span>, <span class="italic">media_types</span>, and <span class="italic">genres </span>tables, respectively.</p>

    <p class="body-sa"><span class="bold">Question 2</span>: Create an inner join between the <span class="italic">albums</span> and <span class="italic">tracks</span> tables to display corresponding artist names, album titles, and track names in a single result set.</p>

    <p class="body-sa"><span class="bold">Solution:</span></p>

    <pre class="code-wrap">SELECT 
	t.composer AS "Artist Name",
	a.title AS "Album Title",
	t.Name AS "Track Name"	
FROM
	albums a
INNER JOIN 
	tracks t
ON	
	a.AlbumId = t.AlbumId</pre>

    <p class="body-sa"><span class="bold">Question 3:</span> Using the <span class="italic">genres</span> table identified in question 1, create a third inner join to join to this table and include the <span class="code">Name</span> field from that table in your result set.</p>

    <p class="body-sa"><span class="bold">Solution:</span> </p>

    <pre class="code-wrap">SELECT
  	g.name AS Genre,
	t.composer AS "Artist Name",
	a.title AS "Album Title",
	t.Name AS "Track Name"
FROM
	albums a
INNER JOIN 
	tracks t
ON	
	a.AlbumId = t.AlbumId
INNER JOIN 
	genres g
ON 
	g.GenreId = t.GenreId</pre>

    <h3 class="h1" id="calibre_link-324"><a id="calibre_link-151" class="calibre6"></a>Chapter 7 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> Create a single-line mailing list for all US customers, including capitalized full names and full addresses with five-digit zip codes, in the following format:</p>

    <p class="body-sa">FRANK HARRIS 1600 Amphitheatre Parkway, Mountain View, CA 94043</p>

    <p class="body-sa"><span class="bold">Solution:</span> The format above is calling for the first and last names to be in all caps, so we will need the <span class="code">UPPER()</span> function for those two fields. We use the double pipes to concatenate the rest of the fields, adding spaces and commas where needed.</p>

    <pre class="code-wrap">SELECT
	UPPER(FirstName) || ' ' || UPPER(LastName) || ' ' 
	|| Address || ', ' || City || ', ' || State || ' ' 
	|| SUBSTR(PostalCode,1,5) AS [MailingAddress]	
FROM 	
	customers
WHERE
	Country = 'USA'</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000042.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 2: </span>What are the average annual sales generated by customers from the USA from all years of data available?</p>

    <p class="body-sa"><span class="bold">Solution:</span> If we are just looking for an aggregate function for one country, we can simply select billing country and the average of the total using the <span class="code">WHERE</span> clause to limit our results to the USA.</p>

    <pre class="code-wrap">SELECT 
	BillingCountry,
	AVG(Total) 
FROM
	invoices
WHERE 
	BillingCountry = 'USA'</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000075.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000135.png" />

      </figure>

      <p class="note">We can use the <span class="code">ROUND(</span><span class="code">)</span> function outside of the <span class="code">AVG(</span><span class="code">)</span> function to reduce the number of decimal places returned. </p>

    </div>

    <p class="body-sa"><span class="bold">Question 3:</span> What are the company’s all-time total sales?</p>

    <p class="body-sa"><span class="bold">Solution:</span> Since this question is asking us for the sum total of invoices, our <span class="code">SELECT</span> statement is fairly simple.</p>

    <pre class="code-wrap">SELECT 
	SUM(Total) 
FROM
	invoices</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000094.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 4:</span> Who are the top ten best customers from a revenue standpoint? <span class="italic">Hint:</span> you will need to use a join (chapter 6) to answer this question. </p>

    <p class="body-sa"><span class="bold">Solution:</span> We have already found the total revenue. Now we are looking for the top ten customers responsible for the highest revenue. Since we are looking for data from one table that corresponds to data from another table in a one-to-one relationship, we use an inner join.</p>

    <pre class="code-wrap">SELECT 
	SUM(Total)AS [Revenue Total],
	c.FirstName,
	c.LastName
FROM
	invoices i 
INNER JOIN
	customers c
ON 
	i.CustomerId = c.CustomerId
GROUP BY c.CustomerId
ORDER BY SUM(Total) DESC</pre>

    <h3 class="h1" id="calibre_link-325"><a id="calibre_link-152" class="calibre6"></a>Chapter 8 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> How many invoices exceed the average invoice amount generated in 2010?</p>

    <p class="body-sa"><span class="bold">Solution:</span> To answer this question we need to accomplish two tasks. First we need to find the average invoice amount generated in 2010. Second, we need to compare that value with every invoice in our table to see how many exceeded the average 2010 invoice value. </p>

    <p class="body-sa">First let’s write our subquery:</p>

    <pre class="code-wrap">select
	avg(total) 
from
	invoices
where
	InvoiceDate between '2010-01-01' and '2010-12-31'</pre>

    <p class="body-sa">Running this query gives us an average of $5.80; now we need to write the outer query to select invoices that are greater than the 2010 average.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	Total 
FROM 
	invoices
WHERE 
Total &gt;</pre>

    <pre class="code-wrap">(select 
	avg(total) 
from
	invoices
where 
	InvoiceDate between '2010-01-01' and '2010-12-31')
ORDER BY
	Total DESC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000112.jpg" />

    </figure>

    <p class="body-sa">Our Results Pane tells us that 179 results were returned.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If we only wanted the actual number of invoices returned, we could modify our <span class="code">Total</span> field in our outer query to say <span class="code">COUNT(Total)</span>.</p>

    </div>

    <p class="body-sa"><span class="bold">Question 2:</span> Who are the customers responsible for these invoices?</p>

    <p class="body-sa"><span class="bold">Solution:</span> This problem requires joins again, to connect customer data from the <span class="italic">customers</span> table to the <span class="italic">invoices</span> table. The question itself implies a one-to-one relationship between the <span class="italic">customers</span> table and the <span class="italic">invoices</span> table. We have already selected the invoices we are interested in, so now we need to find the customers attached to those invoices. This is exactly what an inner join does.  This solution is very similar to the solution to Question 1. All we have added is the inner join section so we have access to customer names as well. </p>

    <pre class="code-wrap">SELECT 
	i.InvoiceDate,
	i.Total,
	c.FirstName,
	c.LastName
FROM 
	invoices i
INNER JOIN 
	customers c
ON
	i.CustomerId = c.CustomerId	
WHERE 
Total &gt;</pre>

    <pre class="code-wrap">(select 
	avg(total) 
from
	invoices
where 
	InvoiceDate between '2010-01-01' and '2010-12-31')
ORDER BY
	Total DESC</pre>

    <p class="body-sa"><span class="bold">Question 3:</span> How many of these customers are from the USA?</p>

    <p class="body-sa"><span class="bold">Solution:</span> We can modify the solution to Question 2 above to include an <span class="code">AND</span> statement at the end of the <span class="code">WHERE</span> clause of the outer query.</p>

    <pre class="code-wrap">SELECT 
	InvoiceDate,
	Total,
	BillingCountry
FROM 
	invoices
WHERE 
Total &gt;</pre>

    <pre class="code-wrap">(select 
	avg(total) 
from
	invoices
where 
	InvoiceDate between '2010-01-01' and '2010-12-31')
AND BillingCountry = 'USA'
ORDER BY
	Total DESC</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000131.jpg" />

    </figure>

    <p class="body-sa">Our Results Pane shows us that the query returned forty records. </p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">We could use a <span class="code">SUM()</span> function around the total if we wanted this query to return the exact number of results. </p>

    </div>

    <h3 class="h1" id="calibre_link-326"><a id="calibre_link-153" class="calibre6"></a>Chapter 9 Data Analysis Checkpoint</h3>

    <p class="body">In this checkpoint we asked you to turn the following query, which compares average invoice per city against the global average, into a series of views: </p>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total) AS [City Average],
	(select 
		avg(total)
	from 
		invoices) AS [Global Average]
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <p class="body-sa"><span class="bold">Question 1:</span> Take the inner query (by itself) from this <span class="code">SELECT</span> statement and create a view from it. Save the view as <span class="code">V_GlobalAverage</span>.</p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If you have been following along with the in-chapter examples, you might have already saved an average function as a view. For this exercise, make sure this new view has a new name. </p>

    </div>

    <p class="body-sa"><span class="bold">Solution:</span> We take the inner query by itself and add the view syntax on the first line. </p>

    <pre class="code-wrap">CREATE VIEW V_GlobalAverage AS
select 
	avg(total) 
from 
	invoices AS [Global Average]</pre>

    <p class="body-sa"><span class="bold">Question 2: </span>Remove the subquery from the code above entirely and substitute it with your newly created view <span class="code">V_GlobalAverage</span>.</p>

    <p class="body-sa"><span class="bold">Solution:</span> When we use a view in the <span class="code">SELECT</span> clause, we use the asterisk symbol.</p>

    <pre class="code-wrap">SELECT
	BillingCity,
	AVG(Total) AS [City Average],
(select
	*
from
V_GlobalAverage) AS [Global Average]
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <p class="body-sa"><span class="bold">Question 3:</span> Save this new query as a view called <span class="code">V_CityAvgVsGlobalAvg</span>.</p>

    <p class="body-sa"><span class="bold">Solution:</span> We copy our code from question 2 and add the <span class="code">CREATE VIEW</span> statement at the very top.</p>

    <pre class="code-wrap">CREATE VIEW V_CityAvgVsGlobalAvg AS
SELECT
	BillingCity,
	AVG(Total) AS [City Average],
(select
	*
from
V_GlobalAverage) AS [Global Average]
FROM
	invoices
GROUP BY
	BillingCity
ORDER BY 
	BillingCity</pre>

    <p class="body-sa"><span class="bold">Question 4:</span> Delete the view <span class="code">V_GlobalAverage</span>. What happens to <span class="code">V_CityAvgVsGlobalAvg</span>?</p>

    <p class="body-sa"><span class="bold">Solution:</span> We use <span class="code">DROP</span> <span class="code">VIEW</span> to delete our view. Alternatively, we can right-click on the view from our Database Structure tab in DB Browser and delete the view that way.</p>

    <pre class="code-wrap">DROP VIEW V_GlobalAverage</pre>

    <p class="body-sa">Now to see how this impacts our previous statements, we need to write a <span class="code">SELECT</span> statement to select our virtual table.</p>

    <pre class="code-wrap">V_CityAvgVsGlobalAvg
SELECT 
	*
FROM
	V_CityAvgVsGlobalAvg</pre>

    <p class="body-sa">You should get the following error message:</p>

    <pre class="code-wrap">no such table: main.V_GlobalAverage: </pre>

    <h3 class="h1" id="calibre_link-327"><a id="calibre_link-154" class="calibre6"></a>Chapter 10 Data Analysis Checkpoint</h3>

    <p class="body-sa"><span class="bold">Question 1:</span> Add a new customer to the database.</p>

    <p class="body-sa"><span class="bold">Solution:</span> We first need to add our new customer to the <span class="italic">customers</span> table. A customer can exist alone without being referenced on any other table (if they didn’t make a purchase yet). To start, insert a record into the <span class="italic">customers</span> table.</p>

    <pre class="code-wrap">INSERT INTO 
customers
VALUES ('60', 'New', 'Customer', '', '123 Day Street', 'New York', 'NY', 'USA', '11201', '(347) 525-8688', '', 'nc@gmail.com', '1');</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">We left some of the fields as null by including two single quotes next to each other. We can check our work by running a <span class="code">SELECT </span>statement that looks for the name of the customer we just added.</p>

    </div>

    <pre class="code-wrap">SELECT 
*
FROM
customers
WHERE
FirstName = 'New'</pre>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">If you used a different name for your new customer, modify that value in the query accordingly.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000149.jpg" />

    </figure>

    <p class="body-sa"><span class="bold">Question 2:</span> Create an invoice record for this customer.</p>

    <p class="body-sa"><span class="bold">Solution:</span> In order to create an invoice entry for our new customer, we must pay special attention to the fields in the <span class="italic">invoices</span> table that correspond to our <span class="italic">customers</span> table. For example, our invoices use the same address that appears in the <span class="italic">customers</span> table.</p>

    <pre class="code-wrap">INSERT INTO 
invoices
VALUES ('413', '60', '2019-10-04 00:00:00', '123 Day Street', 'New York', 'NY', 'USA', '10201', '50.00')</pre>

    <p class="body-sa"><span class="bold">Question 3:</span> Remove this customer from the database.</p>

    <p class="body-sa"><span class="bold">Solution: </span>As we mentioned in chapter 10, it is a best practice to view the data we are going to delete so that we can see what we will be deleting. In this case, the data we are deleting stretches across two tables, so we write an <span class="code">INNER JOIN</span> statement to view all the data we have included.</p>

    <pre class="code-wrap">SELECT
	c.FirstName,
	c.LastName,
	i.Total,
	i.InvoiceId
FROM 
	invoices i
INNER JOIN 
	customers c
ON 	i.CustomerId = c.CustomerId
WHERE c.CustomerId = 60</pre>

    <p class="body-sa">Now that we have confirmed the data, we can compose the <span class="code">DELETE </span>statement. </p>

    <pre class="code-wrap">DELETE FROM 
	invoices 
WHERE CustomerId = 60</pre>

    <pre class="code-wrap">DELETE FROM 
	customers 
WHERE CustomerId = 60</pre>

  </div>

</div>



<div id="calibre_link-33" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <h2 class="chapter" id="calibre_link-328"><a id="calibre_link-155" class="calibre6"></a>Appendix II </h2>

    <p class="chapter-sub-title">List of SQL Keywords by Chapter</p>

    <h3 class="h1" id="calibre_link-329"><a id="calibre_link-156" class="calibre6"></a>Chapter 4 Keywords</h3>

    <table class="one-cell-table" id="calibre_link-330">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="code-solo-text">SELECT, AS, FROM, ORDER BY, ASC, DESC, LIMIT</p>
          </td>
        </tr>

      </tbody>

    </table>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000015.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000031.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-331"><a id="calibre_link-157" class="calibre6"></a>Chapter 5 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-332">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="code-solo-text"><span class="code">WHERE, CASE, WHEN, THEN, ELSE, END AS, DATE()</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note-sa">Operators in SQL are used within SQL clauses.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000165.jpg" />

    </figure>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000047.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The single-line comments are abbreviated in the previous example for the sake of print. Single-line comments must always be on one line in the SQL browser or they will be mistaken for code and will result in errors.</p>

    </div>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000088.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note"><span class="code">DATE(</span><span class="code">)</span> is the first function introduced in the book. It is introduced early so it can be used with the other keywords in chapter 5. More functions are introduced in chapter 7.</p>

    </div>

    <pre class="code-wrap">/*  
The DATE() function removes any timecode information from data stored as DATETIME. 
*/
SELECT 
	InvoiceDate,
	DATE(InvoiceDate) AS [Results of DATE Function]
FROM 
	invoices
ORDER BY
	InvoiceDate</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000142.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-333"><a id="calibre_link-158" class="calibre6"></a>Chapter 6 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-334">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="code-solo-text"><span class="code">INNER JOIN, ON, LEFT OUTER JOIN, RIGHT OUTER JOIN, IS, NOT</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">The <span class="code">RIGHT</span> <span class="code">JOIN</span> is not supported in SQLite but is supported in other RDBMS implementations.</p>

    </div>

    <p class="h3-ref">INNER JOIN</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000064.jpg" />

    </figure>

    <p class="h3-ref">LEFT OUTER JOIN</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000080.jpg" />

    </figure>

    <p class="h3-ref">Right Outer Join (Not Supported in SQLite)</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000099.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-335"><a id="calibre_link-159" class="calibre6"></a>Chapter 7 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-336">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="code-solo-text"><span class="code">GROUP BY, HAVING</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000105.jpg" />

    </figure>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000046.png" />

      </figure>

      <p class="note">As stated in the chapter, there are many more functions recognized by SQLite than are included in this chapter. For a full list and further documentation on SQLite, visit <a href="https://www.sqlite.org/lang_corefunc.html" class="calibre6"><span class="underline1">https://www.sqlite.org/lang_corefunc.html</span></a></p>

    </div>

    <h3 class="h1" id="calibre_link-337"><a id="calibre_link-160" class="calibre6"></a>Chapter 8 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-338">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="code-solo-text"><span class="code">DISTINCT</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <p class="body-sa">The basic subquery:</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000066.jpg" />

    </figure>

    <p class="body-sa">The <span class="code">DISTINCT</span> clause: </p>

    <pre class="code-wrap">SELECT  
	DISTINCT TrackId 
FROM 
	invoice_items
ORDER BY
	TrackId</pre>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000082.jpg" />

    </figure>

    <h3 class="h1" id="calibre_link-339"><a id="calibre_link-161" class="calibre6"></a>Chapter 9 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-340">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="basic-paragraph"><span class="code">CREATE VIEW, DROP VIEW</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <pre class="code-wrap">CREATE VIEW V_ViewName AS [Alias Name]</pre>

    <pre class="code-wrap">DROP VIEW V_ViewName</pre>

    <h3 class="h1" id="calibre_link-341"><a id="calibre_link-162" class="calibre6"></a>Chapter 10 Keywords </h3>

    <table class="one-cell-table" id="calibre_link-342">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table2">
            <p class="basic-paragraph"><span class="code">INSERT INTO, UPDATE, SET, DELETE</span></p>
          </td>
        </tr>

      </tbody>

    </table>

    <p class="code-solo-text"><span class="code"> </span></p>

    <div class="standard-box">

      <figure class="horizontal-image-wrap" type="z3998:figure">

        <img class="w" src="images/000129.png" />

      </figure>

      <p class="note">Data manipulation language (DML) can permanently alter a database. It is best to practice these commands in a sandbox space such as the sample database provided. Using DML on a live database with active customer data can have permanent deleterious effects.</p>

    </div>

    <pre class="code-wrap">INSERT INTO 
artists (Name)
VALUES (‘Bob Marley’)</pre>

    <pre class="code-wrap">UPDATE 
employees
SET PostalCode = ‘11202’
WHERE
	EmployeeId = 9</pre>

    <pre class="code-wrap">DELETE FROM 
	employees
WHERE
	EmployeeId = 9</pre>

  </div>

</div>



<div id="calibre_link-2" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000153.jpg" />

    </figure>

    <p class="chapter-title1" id="calibre_link-343"><a id="calibre_link-163" class="calibre6"></a>What Did You Think?</p>

    <p class="body-avenir-sa">Thank you for choosing a bestselling ClydeBank Media <span class="italic2">QuickStart Guide™</span>.</p>

    <p class="body-avenir-sa">This book represents the hard work and dedication of not only the author but numerous members of our expert team. We hope this book presented a simplified and valuable look at the subject matter at hand. Our goal is to be your partner on this learning path and to provide relevant and practical information that can be put to use in your life right away.</p>

    <p class="body-avenir-sa">So, how did we do?</p>

    <p class="body-avenir-sa">Our independent publishing company relies on honest and objective feedback from readers like you. Your feedback helps us improve our books to better serve our customers and helps them to stand out on online retailers so new readers who are searching for simplified and beginner-friendly learning material can discover our library of titles more easily.</p>

    <p class="body-avenir-sa">We would greatly appreciate it if you could take a few seconds to let us know what you thought of this book by visiting the URL below. All feedback is welcome, both positive and critical. What did you like? What did you learn? What surprised you, or what did you put into action right away? Share your thoughts with us and with others who have yet to discover us!</p>

    <table class="one-cell-table" id="calibre_link-344">

      <colgroup class="calibre11">

        <col class="calibre12"></col>

      </colgroup>

      <tbody class="calibre13">

        <tr class="one-cell-table1">
          <td class="one-cell-table3">
            <p class="feedback">To leave your feedback please visit: <a href="http://www.clydebankmedia.com/sql-review" class="calibre6"><span class="underline1">www.clydebankmedia.com/sql-review</span></a></p>
          </td>
        </tr>

      </tbody>

    </table>

    <p class="body-avenir">If you need assistance with an order, have questions or comments, or want to reach out to our team directly, please send us an email at <a href="mailto:support@clydebankmedia.com" class="calibre6"><span class="underline1">support@clydebankmedia.com</span></a>.</p>

    <figure class="horizontal-image-wrap" type="z3998:figure">

      <img alt="" class="w" src="images/000005.jpg" />

    </figure>

  </div>

</div>



<div id="calibre_link-8" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <p class="chapter-title2" id="calibre_link-345"><a id="calibre_link-164" class="calibre6"></a>About the Author </p>

    <div class="idgenclearfloat">
			</div>

    <div class="w1">

      <figure class="w2" type="z3998:figure">

        <img alt="" src="images/000110.jpg" class="calibre14" />

      </figure>

      <p class="author">WALTER SHIELDS</p>

      <p class="body-sa">Walter Shields has worked with SQL and databases for over eighteen years, helping organizations such as Target Corporation, NYC Transit Authority, and NYC Administration for Children’s Services successfully leverage and understand their data using SQL. </p>

      <p class="body-sa">While Walter’s self-described path through the emerging industry of data science in the late 1990s was anything but straightforward, he firmly believed that SQL did not have to be so daunting for everyone else. Walter’s desire to simplify the learning process eventually led him to start teaching students in a coffee shop in Tribeca, New York, equipped with nothing but a laptop full of SQL learning materials. Since then, his mentorship has turned into its own business: SQL Training Wheels. When not teaching students, Walter can be found working on his latest project, Datadecided, a Tableau-based data visualization company that helps medium and large businesses leverage their data with actionable data visualizations. You can reach Walter at <a href="http://www.sqltrainingwheels.com" class="calibre6"><span class="underline1">www.sqltrainingwheels.com</span></a> and learn more about Tableau and data visualization at <a href="http://www.Datadecided.com" class="calibre6"><span class="underline1">www.Datadecided.com</span></a>.</p>

    </div>

  </div>

</div>



<div id="calibre_link-12" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <p class="chapter-title2" id="calibre_link-346"><a id="calibre_link-165" class="calibre6"></a>About ClydeBank Media </p>

    <p class="body-sa">We create simplified educational tools that allow our customers to successfully learn new skills in order to navigate this constantly changing world.</p>

    <p class="body-sa">The success of ClydeBank Media’s value-driven approach starts with beginner-friendly high-quality information. We work with subject matter experts who are leaders in their fields. These experts are supported by our team of professional researchers, writers, and educators.</p>

    <p class="body-sa">Our team at ClydeBank Media works with these industry leaders to break down their wealth of knowledge, their wisdom, and their years of experience into small and concise building blocks. We piece together these building blocks to create a clearly defined learning path that a beginner can follow for successful mastery.</p>

    <p class="body-sa">At ClydeBank Media, we see a new world of possibility. Simplified learning doesn’t have to be bound by four walls; instead, it’s driven by you.</p>

    <figure class="w3" type="z3998:figure">

      <img alt="Your World SimplifiedTM" class="w" src="images/000040.png" />

    </figure>

  </div>

</div>



<div id="calibre_link-13" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <p class="chapter-title2" id="calibre_link-347"><a id="calibre_link-166" class="calibre6"></a>Glossary</p>

    <p class="termname">Aggregate Function</p>

    <p class="definition">A function designed to produce a single result based on the contents of an entire field. Aggregate functions can return a sum, a minimum, a maximum, a count, or other mathematical functions. </p>

    <p class="termname">Alias</p>

    <p class="definition">A substitute name for a database column defined by the user in an <span class="code">AS</span> statement. An alias is used for clarity or presentation when displaying a query.</p>

    <p class="termname">Argument</p>

    <p class="definition">A parameter of a function, usually encased in parentheses () and separated by a comma.</p>

    <p class="termname">Arithmetic Operator</p>

    <p class="definition">An SQL keyword used to perform basic arithmetic operations (add, subtract, multiply, divide, modulo) usually within a <span class="code">WHERE</span> clause. </p>

    <p class="termname">Attribute</p>

    <p class="definition">Another representation of a field.</p>

    <p class="termname">Boolean</p>

    <p class="definition">A data type expressed as either true or false. </p>

    <p class="termname">Clause</p>

    <p class="definition">A subsection of an SQL statement that starts with a reserved keyword and may include additional parameters and operators.</p>

    <p class="termname">Coding Convention</p>

    <p class="definition">A set of guidelines, standards, and best practices used in most programming languages to ensure that code is readable by other company stakeholders.</p>

    <p class="termname">Column</p>

    <p class="definition">Another representation of a field.</p>

    <p class="termname">Comparison Operator</p>

    <p class="definition">An SQL keyword used to compare values, usually used within a <span class="code">WHERE</span> clause. Examples include “=” (equal to), “&gt;” (greater than), “&lt;” (less than), “&gt;=” (greater than or equal to), “&lt;=” (less than or equal to), &lt;&gt; (not equal to).</p>

    <p class="termname">Composite Key</p>

    <p class="definition">A primary key consisting of two or more fields combined in such a way as to make a unique identifier.  </p>

    <p class="termname">Data Manipulation Language (DML)</p>

    <p class="definition">A subset of SQL keywords that are used to add, remove, and modify data in a database. Examples include <span class="code">INSERT</span>, <span class="code">UPDATE</span>, and <span class="code">DELETE</span>.</p>

    <p class="termname">Data</p>

    <p class="definition">Information that can be recorded and stored in a database.</p>

    <p class="termname">Data Type</p>

    <p class="definition">An attribute of a field that specifies what type of data that field can hold. Examples include numerical and text.</p>

    <p class="termname">Database</p>

    <p class="definition">A collection of data arranged for ease and speed of search and retrieval by a computer.</p>

    <p class="termname">Database Administrator</p>

    <p class="definition">A database professional responsible for the maintenance, security, and integrity of a database. Duties may include deciding who has access to what parts of the database and determining who can edit the database. </p>

    <p class="termname">DB Browser</p>

    <p class="definition">An SQL browser that uses the SQLite RDBMS.</p>

    <p class="termname">Entity Relationship Diagram (ERD)</p>

    <p class="definition">The graphical “blueprint” of a database that explains relationships between tables, such as a relationship between a primary key in one table and its corresponding foreign key(s) in other tables. An ERD can also be called a schema.</p>

    <p class="termname">Field</p>

    <p class="definition">A space allocated for a particular type of data. Field could refer to one specific item in a record or the entire column. Sometimes referred to as a column or attribute. </p>

    <p class="termname">Foreign Key</p>

    <p class="definition">A column in a table that is a primary key in another table. </p>

    <p class="termname">Function</p>

    <p class="definition">A special SQL keyword that accepts certain parameters called arguments, performs an operation (such as a calculation or modification of the data in the field), and returns the result of that operation as a value.</p>

    <p class="termname">Integer</p>

    <p class="definition">A data type that represents a whole (non-decimal) number.</p>

    <p class="termname">Keyword</p>

    <p class="definition">A special reserved word in SQL that performs a specific function in a statement or query. <span class="code">SELECT</span> is the most common SQL keyword.</p>

    <p class="termname">Logical Operator</p>

    <p class="definition">An SQL keyword used to perform conditional selection of data meeting certain criteria, usually within a <span class="code">WHERE</span> clause. Examples include <span class="code">BETWEEN</span>, <span class="code">IN</span>, <span class="code">LIKE</span>, <span class="code">AND</span>, and <span class="code">OR</span>.</p>

    <p class="termname">Messages Pane</p>

    <p class="definition">A part of the SQL browser that gives the user feedback on the results of executed queries. </p>

    <p class="termname">Metadata</p>

    <p class="definition">Data about the structure of the data in a database.</p>

    <p class="termname">Normalization</p>

    <p class="definition">A technique used in the creation of databases to reduce redundant columns and thus decrease both the size of the database and the time required to run queries. </p>

    <p class="termname">Operator</p>

    <p class="definition">A special SQL keyword, usually used in conjunction with an existing SQL clause such as the <span class="code">WHERE</span> clause. Common operators include comparison operators, logical operators, and arithmetic operators. </p>

    <p class="termname">Primary Key</p>

    <p class="definition">The column that acts as a unique identifier for a particular record in a table. </p>

    <p class="termname">Query</p>

    <p class="definition">A request made in Structured Query Language, entered into an SQL browser, requesting a specific set of information.</p>

    <p class="termname">Query Pane</p>

    <p class="definition">A part of the SQL browser that allows the user to enter SQL queries.</p>

    <p class="termname">RDBMS</p>

    <p class="definition">An abbreviation for relational database management system.</p>

    <p class="termname">Record</p>

    <p class="definition">One complete set of information, usually consisting of one row and at least one column.</p>

    <p class="termname">Relational Database</p>

    <p class="definition">A database design that employs multiple tables linked to each other by the use of primary and foreign key fields.</p>

    <p class="termname">Relational Database Management System</p>

    <p class="definition">A software package that allows the user to create, edit, and run SQL queries on relational databases.</p>

    <p class="termname">Results Pane</p>

    <p class="definition">The part of the SQL browser that shows the result set, or data returned from a query. </p>

    <p class="termname">Result Set</p>

    <p class="definition">The output or resulting data of a successfully executed query, usually in the form of records from the database.</p>

    <p class="termname">Row</p>

    <p class="definition">Another representation of a record.</p>

    <p class="termname">Sandbox</p>

    <p class="definition">A database environment that is isolated from any live servers or sensitive data so that code can be tested or practiced.</p>

    <p class="termname">Schema</p>

    <p class="definition">A description of the relationship between database tables and their primary and foreign keys that can be shown visually by an entity relationship diagram (ERD).</p>

    <p class="termname">SQL</p>

    <p class="definition">Structured Query Language. A standardized set of keywords specifically designed to create, manipulate, and control relational databases.</p>

    <p class="termname">SQLite</p>

    <p class="definition">A particular implementation of SQL, also called a relational database management system.</p>

    <p class="termname">SQL Browser</p>

    <p class="definition">The software interface of a relational database management system that allows an end user to browse databases and execute queries using Structured Query Language.</p>

    <p class="termname">Statement</p>

    <p class="definition">Any valid piece of code that can be executed by the RDBMS.</p>

    <p class="termname">String</p>

    <p class="definition">Text data stored in a text-based data type such as NVARCHAR.</p>

    <p class="termname">Syntax</p>

    <p class="definition">The correct keyword usage, order, and structure of SQL statements so that the SQL browser correctly interprets the resulting query.</p>

    <p class="termname">Syntax Error</p>

    <p class="definition">An error message created by the SQL browser due to an improperly structured query.</p>

    <p class="termname">Table</p>

    <p class="definition">A unique set of records, consisting of both rows and columns.</p>

  </div>

</div>



<div id="calibre_link-14" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <p class="chapter-title2" id="calibre_link-348"><a id="calibre_link-167" class="calibre6"></a>References</p>

    <p class="ref-header">INTRODUCTION:</p>

    <p class="references" id="calibre_link-172">1.	“1 Second,” Internet Live Stats, accessed January 24, 2019, <a href="http://www.internetlivestats.com/one-second/" class="calibre6"><span class="underline1">http://www.internetlivestats.com/one-second/</span></a>. <a href="#calibre_link-15" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-173">2.	<a href="https://www.forbes.com/sites/bernardmarr/2015/09/30/big-data-20-mind-boggling-facts-everyone-must-read/#36eb197c17b1" class="calibre6"><span class="underline1">https://www.forbes.com/sites/bernardmarr/2015/09/30/big-data-20-mind-boggling-facts-everyone-must-read/#36eb197c17b1</span></a>. <a href="#calibre_link-16" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-174">3.	<a href="http://wikibon.org/blog/big-data-infographics/" class="calibre6"><span class="underline1">http://wikibon.org/blog/big-data-infographics/</span></a>. <a href="#calibre_link-17" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-175">4.	<a href="https://www.dezyre.com/article/big-data-timeline-series-of-big-data-evolution/160" class="calibre6"><span class="underline1">https://www.dezyre.com/article/big-data-timeline-series-of-big-data-evolution/160</span></a>. <a href="#calibre_link-18" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-176">5.	<a href="https://www.technologyreview.com/s/514346/the-data-made-me-do-it/" class="calibre6"><span class="underline1">https://www.technologyreview.com/s/514346/the-data-made-me-do-it/</span></a>. <a href="#calibre_link-19" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-177">6.	<a href="https://www.glassdoor.com/Salaries/sql-developer-salary-SRCH_KO0,13.htm" class="calibre6"><span class="underline1">https://www.glassdoor.com/Salaries/sql-developer-salary-SRCH_KO0,13.htm</span></a>. <a href="#calibre_link-20" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="ref-header">CHAPTER 1:</p>

    <p class="references" id="calibre_link-179">7.	<a href="http://www.dictionary.com/browse/datum" class="calibre6"><span class="underline1">http://www.dictionary.com/browse/datum</span></a>. <a href="#calibre_link-21" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-180">8.	<a href="https://www.seas.upenn.edu/~zives/03f/cis550/codd.pdf" class="calibre6"><span class="underline1">https://www.seas.upenn.edu/~zives/03f/cis550/codd.pdf</span></a>. <a href="#calibre_link-22" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-181">9.	“Most Widely Deployed SQL Database Engine - SQLite,” accessed February 19, 2019, <a href="https://www.sqlite.org/mostdeployed.html" class="calibre6"><span class="underline1">https://www.sqlite.org/mostdeployed.html</span></a>. <a href="#calibre_link-23" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="ref-header">CHAPTER 7:</p>

    <p class="references" id="calibre_link-31">10.	“SQLite Query Language: Core Functions,” accessed February 25, 2019, <a href="https://www.sqlite.org/lang_corefunc.html" class="calibre6"><span class="underline1">https://www.sqlite.org/lang_corefunc.html</span></a> <a href="#calibre_link-24" class="calibre6"><span class="underline1">Go back.</span></a></p>

    <p class="references" id="calibre_link-32">11.	“SQLite Query Language: Aggregate Functions,” accessed March 10, 2019, <a href="https://www.sqlite.org/lang_aggfunc.html" class="calibre6"><span class="underline1">https://www.sqlite.org/lang_aggfunc.html</span></a>. <a href="#calibre_link-25" class="calibre6"><span class="underline1">Go back.</span></a></p>

  </div>

</div>



<div class="calibre1" id="calibre_link-9">

  <section type="part" id="calibre_link-349" class="calibre2">

    <figure class="horizontal-image-wrap1" type="z3998:figure">

      <img alt="EXPLORE MORE BEST SELLING" class="w" src="images/000170.jpg" />

    </figure>

    <div class="digitalassetsreference-wrap">

      <h3 class="stop-section-title1">TO EXPLORE ALL TITLES, VISIT:</h3>

      <p class="stop-section-link"><b class="calibre8"><a class="underline" href="https://www.clydebankmedia.com/shop">www.clydebankmedia.com/shop</a></b></p>

    </div>

  </section>

</div>



<div class="calibre1" id="calibre_link-182">

  <section type="part" id="calibre_link-350" class="calibre2">

    <figure class="horizontal-image-wrap1" type="z3998:figure">

      <img alt="" class="w" src="images/000000.jpg" />

    </figure>

    <h2 class="subchapter-title"><b class="calibre8">ClydeBank Media is a Proud Sponsor of</b></h2>

    <figure class="wrap-80nm" type="z3998:figure">

      <img alt="EXPLORE MORE BEST SELLING" class="w" src="images/000073.png" />

    </figure>

    <p class="std-paragraph"><a class="underline" href="https://www.adoptaclassroom.org/">AdoptAClassroom.org</a> empowers teachers by providing the 
classroom supplies and materials needed to help their students learn and 
succeed. As an award-winning 501(c)(3), AdoptAClassroom.org makes it easy for 
individual donors and corporate sponsors to donate funds to K-12 classrooms in 
public, private and charter schools throughout the U.S.</p>

    <p class="std-paragraph">On average, teachers spend $600 of their own money each 
year to equip their classrooms &ndash; 20% of teachers spend more than $1000 annually. 
Since 1998 AdoptAClassroom.org has raised more than $30 million and benefited 
more than 4.25 million students. AdoptAClassroom.org holds a 4-star rating from 
Charity Navigator.</p>

    <p class="align-center"><b class="calibre8">TO LEARN MORE, VISIT <a class="underline" href="https://www.adoptaclassroom.org/">ADOPTACLASSROOM.ORG</a></b></p>

  </section>

</div>



<div id="calibre_link-169" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <p class="chapter-title2" id="calibre_link-351"><a id="calibre_link-352" class="calibre6"></a></p>

    <p class="copyright">Copyright © 2019 by ClydeBank Media LLC</p>

    <p class="copyright">All rights reserved. No part of this publication may be reproduced, distributed, or transmitted in any form or by any means, including photocopying, recording, or other electronic or mechanical methods, without the prior written permission of the publisher, except in the case of brief quotations embodied in critical reviews and certain other noncommercial uses permitted by copyright law. For permission requests, write to the publisher, addressed “Attention: Permissions Coordinator,” at the address below.</p>

    <p class="copyright">ClydeBank Media LLC is not associated with any organization, product or service discussed in this book. Although the author and publisher have made every effort to ensure that the information in this book was correct at press time, the author and publisher do not assume and hereby disclaim any liability to any party for any loss, damage, or disruption caused by errors or omissions, whether such errors or omissions result from negligence, accident, or any other cause.</p>

    <p class="copyright">All trademarks, service marks, trade names, trade dress, product names and logos appearing in this publication are the property of their respective owners, including in some instances ClydeBank Media LLC. Any rights not expressly granted herein are reserved.</p>

    <p class="copyright"><span class="semibold">Disclaimer:</span> The purpose of this book is to provide the public with accurate, simplified information. This information should not constitute “financial advice,” “legal advice,” “retirement planning advice,” or “investment advice.” Please consult your attorney, financial adviser, or another licensed professional for advice tailored to your financial needs and objectives. When it comes to funds and other investments, past performance in no way guarantees future performance. ClydeBank Media LLC does not in any way guarantee or promise any specific threshold of financial return or immunity from loss resulting from investments made in the funds featured in investment information articles. </p>

    <p class="copyright"><span class="semibold">Trademarks:</span> All trademarks are the property of their respective owners. The trademarks that are used are without any consent, and the publication of the trademark is without permission or backing by the trademark owner. All trademarks and brands within this book are for clarifying purposes only and are owned by the owners themselves, not affiliated with this document.</p>

    <p class="copyright">Editor: Marilyn Burkley Cover Illustration and Design: Katie Poorman, Copyright © 2019 by ClydeBank Media LLC Interior Design: Katie Poorman, Copyright © 2019 by ClydeBank Media LLC</p>

    <p class="copyright">First Edition (edited) | Last Updated: 3/2/2020 </p>

    <p class="copyright">ISBN-13: 9781945051753 (paperback) | 9781945051234 (hardcover) | 9781945051838 (eBook)</p>

    <p class="copyright">Library of Congress Control Number:  2019950712</p>

    <p class="copyright">Author ISNI: 0000 0004 6515 9557</p>

    <p class="copyright">Ordering Information: Please visit <a href="http://www.clydebankmedia.com/orders" class="calibre6"><span class="underline1">www.clydebankmedia.com/orders</span></a> or call (888) 386-2624. Special discounts are available on quantity purchases by corporations, associations, and others. </p>

    <p class="copyright-sa">Publisher’s Cataloging-In-Publication Data (Prepared by The Donohue Group, Inc.)</p>

    <p class="copyright-sa">Names: Shields, Walter, 1975- author.Title: SQL quickstart guide : the simplified beginner’s guide to managing, analyzing, and manipulating data With SQL / Walter Shields.Other Titles: SQL quick start guide Description: First Edition (edited). | [Albany, New York] : ClydeBank Technology, [2019] | Includes bibliographical references and index.Identifiers: ISBN 9781945051234 (hardcover) | ISBN 9781945051753 (paperback) | ISBN 9781945051838 (ebook)Subjects: LCSH: SQL (Computer program language)--Handbooks, manuals, etc. | Database management--Computer programs--Handbooks, manuals, etc. 		| Computer programming--Vocational guidance. | Querying (Computer science)--Vocational guidance. | LCGFT: Handbooks and manuals.Classification: LCC QA76.73.S67 S55 2019 (print) | LCC QA76.73.S67 (ebook) | DDC 005.756--dc23</p>

  </div>

</div>



<div id="calibre_link-170" lang="en-US" class="calibre1">

  <div class="basic-text-frame">

    <section type="copyright-page" id="calibre_link-353" class="calibre2">

      <figure class="copyrightlogo-wrap" type="z3998:figure">

        <img alt="ClydeBank MEDIA" class="w" src="images/000147.png" />

      </figure>

      <p class="copyright1">Copyright © 2019</p>

      <p class="copyright1">ClydeBank Media LLC</p>

      <p class="copyright1"><a class="underline" href="https://www.clydebankmedia.com/">www.clydebankmedia.com</a></p>

      <p class="copyright1">All Rights Reserved</p>

      <p class="copyright1">ISBN-13: 978-1-945051-75-3</p>

    </section>

  </div>

</div>



</body></html>